var pb=Object.defineProperty,gb=Object.defineProperties;var mb=Object.getOwnPropertyDescriptors;var ga=Object.getOwnPropertySymbols;var Xy=Object.prototype.hasOwnProperty,e_=Object.prototype.propertyIsEnumerable;var Jy=(n,e,t)=>e in n?pb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,H=(n,e)=>{for(var t in e||={})Xy.call(e,t)&&Jy(n,t,e[t]);if(ga)for(var t of ga(e))e_.call(e,t)&&Jy(n,t,e[t]);return n},ge=(n,e)=>gb(n,mb(e));var ma=(n,e)=>{var t={};for(var r in n)Xy.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ga)for(var r of ga(n))e.indexOf(r)<0&&e_.call(n,r)&&(t[r]=n[r]);return t};var $e=null,ya=!1,Hl=1,yb=null,Lt=Symbol("SIGNAL");function Q(n){let e=$e;return $e=n,e}function _a(){return $e}var So={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function t_(n){if(ya)throw new Error("");if($e===null)return;$e.consumerOnSignalRead(n);let e=$e.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=$e.recomputing;if(r&&(t=e!==void 0?e.nextProducer:$e.producers,t!==void 0&&t.producer===n)){$e.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===$e&&(!r||vb(i,$e)))return;let o=ii($e),s={producer:n,consumer:$e,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};$e.producersTail=s,e!==void 0?e.nextProducer=s:$e.producers=s,o&&s_(n,s)}function n_(){Hl++}function r_(n){if(!(ii(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Hl)){if(!n.producerMustRecompute(n)&&!Ea(n)){jl(n);return}n.producerRecomputeValue(n),jl(n)}}function $l(n){if(n.consumers===void 0)return;let e=ya;ya=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||_b(r)}}finally{ya=e}}function zl(){return $e?.consumerAllowSignalWrites!==!1}function _b(n){n.dirty=!0,$l(n),n.consumerMarkedDirty?.(n)}function jl(n){n.dirty=!1,n.lastCleanEpoch=Hl}function va(n){return n&&i_(n),Q(n)}function i_(n){n.producersTail=void 0,n.recomputing=!0}function ql(n,e){Q(e),n&&o_(n)}function o_(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(ii(n))do t=Gl(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Ea(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(r_(t),r!==t.version))return!0}return!1}function ri(n){if(ii(n)){let e=n.producers;for(;e!==void 0;)e=Gl(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function s_(n,e){let t=n.consumersTail,r=ii(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)s_(i.producer,i)}function Gl(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!ii(e)){let o=e.producers;for(;o!==void 0;)o=Gl(o)}return t}function ii(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function a_(n){yb?.(n)}function vb(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function c_(n,e){return Object.is(n,e)}function Eb(){throw new Error}var u_=Eb;function l_(n){u_(n)}function Wl(n){u_=n}var Ib=null;function Kl(n,e){let t=Object.create(h_);t.value=n,e!==void 0&&(t.equal=e);let r=()=>d_(t);return r[Lt]=t,a_(t),[r,s=>Ql(t,s),s=>f_(t,s)]}function d_(n){return t_(n),n.value}function Ql(n,e){zl()||l_(n),n.equal(n.value,e)||(n.value=e,wb(n))}function f_(n,e){zl()||l_(n),Ql(n,e(n.value))}var h_=ge(H({},So),{equal:c_,value:void 0,kind:"signal"});function wb(n){n.version++,n_(),$l(n),Ib?.(n)}function Yl(n){let e=Q(null);try{return n()}finally{Q(e)}}var Zl=ge(H({},So),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function Jl(n){if(n.dirty=!1,n.version>0&&!Ea(n))return;n.version++;let e=va(n);try{n.cleanup(),n.fn()}finally{ql(n,e)}}function ot(n){return typeof n=="function"}function Ia(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var wa=Ia(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ao(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var tt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ot(r))try{r()}catch(o){e=o instanceof wa?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{p_(o)}catch(s){e=e??[],s instanceof wa?e=[...e,...s.errors]:e.push(s)}}if(e)throw new wa(e)}}add(e){var t;if(e&&e!==this)if(this.closed)p_(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ao(t,e)}remove(e){let{_finalizers:t}=this;t&&Ao(t,e),e instanceof n&&e._removeParent(this)}};tt.EMPTY=(()=>{let n=new tt;return n.closed=!0,n})();var Xl=tt.EMPTY;function Ta(n){return n instanceof tt||n&&"closed"in n&&ot(n.remove)&&ot(n.add)&&ot(n.unsubscribe)}function p_(n){ot(n)?n():n.unsubscribe()}var wt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var oi={setTimeout(n,e,...t){let{delegate:r}=oi;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=oi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function g_(n){oi.setTimeout(()=>{let{onUnhandledError:e}=wt;if(e)e(n);else throw n})}function ed(){}var m_=td("C",void 0,void 0);function y_(n){return td("E",void 0,n)}function __(n){return td("N",n,void 0)}function td(n,e,t){return{kind:n,value:e,error:t}}var fr=null;function si(n){if(wt.useDeprecatedSynchronousErrorHandling){let e=!fr;if(e&&(fr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=fr;if(fr=null,t)throw r}}else n()}function v_(n){wt.useDeprecatedSynchronousErrorHandling&&fr&&(fr.errorThrown=!0,fr.error=n)}var hr=class extends tt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ta(e)&&e.add(this)):this.destination=Cb}static create(e,t,r){return new ai(e,t,r)}next(e){this.isStopped?rd(__(e),this):this._next(e)}error(e){this.isStopped?rd(y_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?rd(m_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Tb=Function.prototype.bind;function nd(n,e){return Tb.call(n,e)}var id=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Da(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Da(r)}else Da(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Da(t)}}},ai=class extends hr{constructor(e,t,r){super();let i;if(ot(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&wt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&nd(e.next,o),error:e.error&&nd(e.error,o),complete:e.complete&&nd(e.complete,o)}):i=e}this.destination=new id(i)}};function Da(n){wt.useDeprecatedSynchronousErrorHandling?v_(n):g_(n)}function Db(n){throw n}function rd(n,e){let{onStoppedNotification:t}=wt;t&&oi.setTimeout(()=>t(n,e))}var Cb={closed:!0,next:ed,error:Db,complete:ed};var E_=typeof Symbol=="function"&&Symbol.observable||"@@observable";function I_(n){return n}function w_(n){return n.length===0?I_:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ci=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=Sb(t)?t:new ai(t,r,i);return si(()=>{let{operator:s,source:c}=this;o.add(s?s.call(o,c):c?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=T_(r),new r((i,o)=>{let s=new ai({next:c=>{try{t(c)}catch(u){o(u),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[E_](){return this}pipe(...t){return w_(t)(this)}toPromise(t){return t=T_(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function T_(n){var e;return(e=n??wt.Promise)!==null&&e!==void 0?e:Promise}function bb(n){return n&&ot(n.next)&&ot(n.error)&&ot(n.complete)}function Sb(n){return n&&n instanceof hr||bb(n)&&Ta(n)}function Ab(n){return ot(n?.lift)}function D_(n){return e=>{if(Ab(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function C_(n,e,t,r,i){return new od(n,e,t,r,i)}var od=class extends hr{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(c){try{t(c)}catch(u){e.error(u)}}:super._next,this._error=i?function(c){try{i(c)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var b_=Ia(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var an=(()=>{class n extends ci{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Ca(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new b_}next(t){si(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){si(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){si(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Xl:(this.currentObservers=null,o.push(t),new tt(()=>{this.currentObservers=null,Ao(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new ci;return t.source=this,t}}return n.create=(e,t)=>new Ca(e,t),n})(),Ca=class extends an{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Xl}};var No=class extends an{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};function sd(n,e){return D_((t,r)=>{let i=0;t.subscribe(C_(r,o=>{r.next(n.call(e,o,i++))}))})}var ad;function ba(){return ad}function Ft(n){let e=ad;return ad=n,e}var S_=Symbol("NotFound");function ui(n){return n===S_||n?.name==="\u0275NotFound"}var ka="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ee=class extends Error{code;constructor(e,t){super(Oa(e,t)),this.code=e}};function Rb(n){return`NG0${Math.abs(n)}`}function Oa(n,e){return`${Rb(n)}${e?": "+e:""}`}function de(n){for(let e in n)if(n[e]===de)return e;throw Error("")}function Pn(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Pn).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Id(n,e){return n?e?`${n} ${e}`:n:e||""}var Mb=de({__forward_ref__:de});function La(n){return n.__forward_ref__=La,n.toString=function(){return Pn(this())},n}function ut(n){return P_(n)?n():n}function P_(n){return typeof n=="function"&&n.hasOwnProperty(Mb)&&n.__forward_ref__===La}function se(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Oo(n){return{providers:n.providers||[],imports:n.imports||[]}}function Fa(n){return Pb(n,Va)}function Pb(n,e){return n.hasOwnProperty(e)&&n[e]||null}function xb(n){let e=n?.[Va]??null;return e||null}function ud(n){return n&&n.hasOwnProperty(Aa)?n[Aa]:null}var Va=de({\u0275prov:de}),Aa=de({\u0275inj:de}),ae=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=se({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function wd(n){return n&&!!n.\u0275providers}var Td=de({\u0275cmp:de}),Dd=de({\u0275dir:de}),Cd=de({\u0275pipe:de});var ld=de({\u0275fac:de}),_r=de({__NG_ELEMENT_ID__:de}),A_=de({__NG_ENV_ID__:de});function vr(n){return Sd(n,"@Component"),n[Td]||null}function bd(n){return Sd(n,"@Directive"),n[Dd]||null}function x_(n){return Sd(n,"@Pipe"),n[Cd]||null}function Sd(n,e){if(n==null)throw new ee(-919,!1)}function Ba(n){return typeof n=="string"?n:n==null?"":String(n)}function k_(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ba(n)}var O_=de({ngErrorCode:de}),kb=de({ngErrorMessage:de}),Ob=de({ngTokenPath:de});function Ad(n,e){return L_("",-200,e)}function Ua(n,e){throw new ee(-201,!1)}function L_(n,e,t){let r=new ee(e,n);return r[O_]=e,r[kb]=n,t&&(r[Ob]=t),r}function Lb(n){return n[O_]}var dd;function F_(){return dd}function ct(n){let e=dd;return dd=n,e}function Nd(n,e,t){let r=Fa(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;Ua(n,"")}var Fb={},pr=Fb,Vb="__NG_DI_FLAG__",fd=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=gr(t)||0;try{return this.injector.get(e,r&8?null:pr,r)}catch(i){if(ui(i))return i;throw i}}};function Bb(n,e=0){let t=ba();if(t===void 0)throw new ee(-203,!1);if(t===null)return Nd(n,void 0,e);{let r=Ub(e),i=t.retrieve(n,r);if(ui(i)){if(r.optional)return null;throw i}return i}}function oe(n,e=0){return(F_()||Bb)(ut(n),e)}function W(n,e){return oe(n,gr(e))}function gr(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Ub(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function hd(n){let e=[];for(let t=0;t<n.length;t++){let r=ut(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ee(900,!1);let i,o=0;for(let s=0;s<r.length;s++){let c=r[s],u=jb(c);typeof u=="number"?u===-1?i=c.token:o|=u:i=c}e.push(oe(i,o))}else e.push(oe(r))}return e}function jb(n){return n[Vb]}function di(n,e){let t=n.hasOwnProperty(ld);return t?n[ld]:null}function V_(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],o=e[r];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}function B_(n){return n.flat(Number.POSITIVE_INFINITY)}function ja(n,e){n.forEach(t=>Array.isArray(t)?ja(t,e):e(t))}function Rd(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Lo(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function U_(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function j_(n,e,t){let r=fi(n,e);return r>=0?n[r|1]=t:(r=~r,U_(n,r,e,t)),r}function Ha(n,e){let t=fi(n,e);if(t>=0)return n[t|1]}function fi(n,e){return Hb(n,e,1)}function Hb(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Er={},ht=[],Fo=new ae(""),Md=new ae("",-1),Pd=new ae(""),Mo=class{get(e,t=pr){if(t===pr){let i=L_("",-201);throw i.name="\u0275NotFound",i}return t}};function xd(n){return{\u0275providers:n}}function H_(...n){return{\u0275providers:kd(!0,n),\u0275fromNgModule:!0}}function kd(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return ja(e,s=>{let c=s;Na(c,o,[],r)&&(i||=[],i.push(c))}),i!==void 0&&$_(i,o),t}function $_(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Od(i,o=>{e(o,r)})}}function Na(n,e,t,r){if(n=ut(n),!n)return!1;let i=null,o=ud(n),s=!o&&vr(n);if(!o&&!s){let u=n.ngModule;if(o=ud(u),o)i=u;else return!1}else{if(s&&!s.standalone)return!1;i=n}let c=r.has(i);if(s){if(c)return!1;if(r.add(i),s.dependencies){let u=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of u)Na(l,e,t,r)}}else if(o){if(o.imports!=null&&!c){r.add(i);let l;try{ja(o.imports,h=>{Na(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&$_(l,e)}if(!c){let l=di(i)||(()=>new i);e({provide:i,useFactory:l,deps:ht},i),e({provide:Pd,useValue:i,multi:!0},i),e({provide:Fo,useValue:()=>oe(i),multi:!0},i)}let u=o.providers;if(u!=null&&!c){let l=n;Od(u,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Od(n,e){for(let t of n)wd(t)&&(t=t.\u0275providers),Array.isArray(t)?Od(t,e):e(t)}var $b=de({provide:String,useValue:de});function z_(n){return n!==null&&typeof n=="object"&&$b in n}function zb(n){return!!(n&&n.useExisting)}function qb(n){return!!(n&&n.useFactory)}function Ra(n){return typeof n=="function"}var Vo=new ae(""),Sa={},N_={},cd;function Bo(){return cd===void 0&&(cd=new Mo),cd}var pt=class{},mr=class extends pt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,gd(e,s=>this.processProvider(s)),this.records.set(Md,li(void 0,this)),i.has("environment")&&this.records.set(pt,li(void 0,this));let o=this.records.get(Vo);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Pd,ht,{self:!0}))}retrieve(e,t){let r=gr(t)||0;try{return this.get(e,pr,r)}catch(i){if(ui(i))return i;throw i}}destroy(){Ro(this),this._destroyed=!0;let e=Q(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Q(e)}}onDestroy(e){return Ro(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Ro(this);let t=Ft(this),r=ct(void 0),i;try{return e()}finally{Ft(t),ct(r)}}get(e,t=pr,r){if(Ro(this),e.hasOwnProperty(A_))return e[A_](this);let i=gr(r),o,s=Ft(this),c=ct(void 0);try{if(!(i&4)){let l=this.records.get(e);if(l===void 0){let h=Yb(e)&&Fa(e);h&&this.injectableDefInScope(h)?l=li(pd(e),Sa):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,i)}let u=i&2?Bo():this.parent;return t=i&8&&t===pr?null:t,u.get(e,t)}catch(u){let l=Lb(u);throw l===-200||l===-201?new ee(l,null):u}finally{ct(c),Ft(s)}}resolveInjectorInitializers(){let e=Q(null),t=Ft(this),r=ct(void 0),i;try{let o=this.get(Fo,ht,{self:!0});for(let s of o)s()}finally{Ft(t),ct(r),Q(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Pn(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=ut(e);let t=Ra(e)?e:ut(e&&e.provide),r=Wb(e);if(!Ra(e)&&e.multi===!0){let i=this.records.get(t);i||(i=li(void 0,Sa,!0),i.factory=()=>hd(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=Q(null);try{if(t.value===N_)throw Ad(Pn(e));return t.value===Sa&&(t.value=N_,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&Qb(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Q(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=ut(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function pd(n){let e=Fa(n),t=e!==null?e.factory:di(n);if(t!==null)return t;if(n instanceof ae)throw new ee(204,!1);if(n instanceof Function)return Gb(n);throw new ee(204,!1)}function Gb(n){if(n.length>0)throw new ee(204,!1);let t=xb(n);return t!==null?()=>t.factory(n):()=>new n}function Wb(n){if(z_(n))return li(void 0,n.useValue);{let e=q_(n);return li(e,Sa)}}function q_(n,e,t){let r;if(Ra(n)){let i=ut(n);return di(i)||pd(i)}else if(z_(n))r=()=>ut(n.useValue);else if(qb(n))r=()=>n.useFactory(...hd(n.deps||[]));else if(zb(n))r=(i,o)=>oe(ut(n.useExisting),o!==void 0&&o&8?8:void 0);else{let i=ut(n&&(n.useClass||n.provide));if(Kb(n))r=()=>new i(...hd(n.deps));else return di(i)||pd(i)}return r}function Ro(n){if(n.destroyed)throw new ee(205,!1)}function li(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Kb(n){return!!n.deps}function Qb(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Yb(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function gd(n,e){for(let t of n)Array.isArray(t)?gd(t,e):t&&wd(t)?gd(t.\u0275providers,e):e(t)}function $a(n,e){let t;n instanceof mr?(Ro(n),t=n):t=new fd(n);let r,i=Ft(t),o=ct(void 0);try{return e()}finally{Ft(i),ct(o)}}function G_(){return F_()!==void 0||ba()!=null}var Tt=0,z=1,$=2,Fe=3,gt=4,mt=5,Uo=6,hi=7,Ge=8,Ln=9,Vt=10,Ve=11,pi=12,Ld=13,Ir=14,Dt=15,Fn=16,wr=17,Bt=18,jo=19,Fd=20,cn=21,za=22,xn=23,lt=24,qa=25,Ho=26,st=27,W_=1;var Vn=7,$o=8,Tr=9,nt=10;function ln(n){return Array.isArray(n)&&typeof n[W_]=="object"}function Ct(n){return Array.isArray(n)&&n[W_]===!0}function Vd(n){return(n.flags&4)!==0}function Dr(n){return n.componentOffset>-1}function zo(n){return(n.flags&1)===1}function Cr(n){return!!n.template}function gi(n){return(n[$]&512)!==0}function br(n){return(n[$]&256)===256}var Bd="svg",K_="math";function yt(n){for(;Array.isArray(n);)n=n[Tt];return n}function Ud(n,e){return yt(e[n])}function Ut(n,e){return yt(e[n.index])}function Ga(n,e){return n.data[e]}function Q_(n,e){return n[e]}function jt(n,e){let t=e[n];return ln(t)?t:t[Tt]}function Y_(n){return(n[$]&4)===4}function Wa(n){return(n[$]&128)===128}function Z_(n){return Ct(n[Fe])}function qo(n,e){return e==null?null:n[e]}function jd(n){n[wr]=0}function Hd(n){n[$]&1024||(n[$]|=1024,Wa(n)&&mi(n))}function J_(n,e){for(;n>0;)e=e[Ir],n--;return e}function Go(n){return!!(n[$]&9216||n[lt]?.dirty)}function Ka(n){n[Vt].changeDetectionScheduler?.notify(8),n[$]&64&&(n[$]|=1024),Go(n)&&mi(n)}function mi(n){n[Vt].changeDetectionScheduler?.notify(0);let e=kn(n);for(;e!==null&&!(e[$]&8192||(e[$]|=8192,!Wa(e)));)e=kn(e)}function $d(n,e){if(br(n))throw new ee(911,!1);n[cn]===null&&(n[cn]=[]),n[cn].push(e)}function X_(n,e){if(n[cn]===null)return;let t=n[cn].indexOf(e);t!==-1&&n[cn].splice(t,1)}function kn(n){let e=n[Fe];return Ct(e)?e[Fe]:e}function zd(n){return n[hi]??=[]}function qd(n){return n.cleanup??=[]}function ev(n,e,t,r){let i=zd(e);i.push(t),n.firstCreatePass&&qd(n).push(r,i.length-1)}var Z={lFrame:yv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var md=!1;function tv(){return Z.lFrame.elementDepthCount}function nv(){Z.lFrame.elementDepthCount++}function rv(){Z.lFrame.elementDepthCount--}function Gd(){return Z.bindingsEnabled}function iv(){return Z.skipHydrationRootTNode!==null}function ov(n){return Z.skipHydrationRootTNode===n}function sv(){Z.skipHydrationRootTNode=null}function _e(){return Z.lFrame.lView}function Ht(){return Z.lFrame.tView}function J(n){return Z.lFrame.contextLView=n,n[Ge]}function X(n){return Z.lFrame.contextLView=null,n}function $t(){let n=Wd();for(;n!==null&&n.type===64;)n=n.parent;return n}function Wd(){return Z.lFrame.currentTNode}function av(){let n=Z.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function yi(n,e){let t=Z.lFrame;t.currentTNode=n,t.isParent=e}function Kd(){return Z.lFrame.isParent}function cv(){Z.lFrame.isParent=!1}function uv(){return Z.lFrame.contextLView}function Qd(){return md}function Po(n){let e=md;return md=n,e}function lv(n){return Z.lFrame.bindingIndex=n}function Yd(){return Z.lFrame.bindingIndex++}function dv(n){let e=Z.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function fv(){return Z.lFrame.inI18n}function hv(n,e){let t=Z.lFrame;t.bindingIndex=t.bindingRootIndex=n,Qa(e)}function pv(){return Z.lFrame.currentDirectiveIndex}function Qa(n){Z.lFrame.currentDirectiveIndex=n}function gv(n){let e=Z.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Zd(){return Z.lFrame.currentQueryIndex}function Ya(n){Z.lFrame.currentQueryIndex=n}function Zb(n){let e=n[z];return e.type===2?e.declTNode:e.type===1?n[mt]:null}function Jd(n,e,t){if(t&4){let i=e,o=n;for(;i=i.parent,i===null&&!(t&1);)if(i=Zb(o),i===null||(o=o[Ir],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Z.lFrame=mv();return r.currentTNode=e,r.lView=n,!0}function Za(n){let e=mv(),t=n[z];Z.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function mv(){let n=Z.lFrame,e=n===null?null:n.child;return e===null?yv(n):e}function yv(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function _v(){let n=Z.lFrame;return Z.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Xd=_v;function Ja(){let n=_v();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function vv(n){return(Z.lFrame.contextLView=J_(n,Z.lFrame.contextLView))[Ge]}function Sr(){return Z.lFrame.selectedIndex}function Bn(n){Z.lFrame.selectedIndex=n}function Ev(){let n=Z.lFrame;return Ga(n.tView,n.selectedIndex)}function We(){Z.lFrame.currentNamespace=Bd}function zt(){Jb()}function Jb(){Z.lFrame.currentNamespace=null}function Iv(){return Z.lFrame.currentNamespace}var wv=!0;function Xa(){return wv}function ec(n){wv=n}function yd(n,e=null,t=null,r){let i=Tv(n,e,t,r);return i.resolveInjectorInitializers(),i}function Tv(n,e=null,t=null,r,i=new Set){let o=[t||ht,H_(n)];return r=r||(typeof n=="object"?void 0:Pn(n)),new mr(o,e||Bo(),r||null,i)}var On=class n{static THROW_IF_NOT_FOUND=pr;static NULL=new Mo;static create(e,t){if(Array.isArray(e))return yd({name:""},t,e,"");{let r=e.name??"";return yd({name:r},e.parent,e.providers,r)}}static \u0275prov=se({token:n,providedIn:"any",factory:()=>oe(Md)});static __NG_ELEMENT_ID__=-1},bt=new ae(""),Wo=(()=>{class n{static __NG_ELEMENT_ID__=Xb;static __NG_ENV_ID__=t=>t}return n})(),Ma=class extends Wo{_lView;constructor(e){super(),this._lView=e}get destroyed(){return br(this._lView)}onDestroy(e){let t=this._lView;return $d(t,e),()=>X_(t,e)}};function Xb(){return new Ma(_e())}var Dv=!1,_i=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new No(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new ci(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=se({token:n,providedIn:"root",factory:()=>new n})}return n})(),_d=class extends an{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,G_()&&(this.destroyRef=W(Wo,{optional:!0})??void 0,this.pendingTasks=W(_i,{optional:!0})??void 0)}emit(e){let t=Q(null);try{super.next(e)}finally{Q(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),o=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let c=super.subscribe({next:i,error:o,complete:s});return e instanceof tt&&e.add(c),c}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},ze=_d;function Pa(...n){}function ef(n){let e,t;function r(){n=Pa;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function tf(n){return queueMicrotask(()=>n()),()=>{n=Pa}}var nf="isAngularZone",xo=nf+"_ID",e0=0,qe=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ze(!1);onMicrotaskEmpty=new ze(!1);onStable=new ze(!1);onError=new ze(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=Dv}=e;if(typeof Zone>"u")throw new ee(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,r0(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(nf)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ee(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ee(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,t0,Pa,Pa);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},t0={};function rf(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function n0(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){ef(()=>{n.callbackScheduled=!1,vd(n),n.isCheckStableRunning=!0,rf(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),vd(n)}function r0(n){let e=()=>{n0(n)},t=e0++;n._inner=n._inner.fork({name:"angular",properties:{[nf]:!0,[xo]:t,[xo+t]:!0},onInvokeTask:(r,i,o,s,c,u)=>{if(i0(u))return r.invokeTask(o,s,c,u);try{return R_(n),r.invokeTask(o,s,c,u)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),M_(n)}},onInvoke:(r,i,o,s,c,u,l)=>{try{return R_(n),r.invoke(o,s,c,u,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!o0(u)&&e(),M_(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,vd(n),rf(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function vd(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function R_(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function M_(n){n._nesting--,rf(n)}var ko=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ze;onMicrotaskEmpty=new ze;onStable=new ze;onError=new ze;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function i0(n){return Cv(n,"__ignore_ng_zone__")}function o0(n){return Cv(n,"__scheduler_tick__")}function Cv(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var un=class{_console=console;handleError(e){this._console.error("ERROR",e)}},Ar=new ae("",{factory:()=>{let n=W(qe),e=W(pt),t;return r=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw r}):(t??=e.get(un),t.handleError(r))})}}}),bv={provide:Fo,useValue:()=>{let n=W(un,{optional:!0})},multi:!0};function me(n,e){let[t,r,i]=Kl(n,e?.equal),o=t,s=o[Lt];return o.set=r,o.update=i,o.asReadonly=Sv.bind(o),o}function Sv(){let n=this[Lt];if(n.readonlyFn===void 0){let e=()=>this();e[Lt]=n,n.readonlyFn=e}return n.readonlyFn}var tc=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=s0}return n})();function s0(){return new tc(_e(),$t())}var yr=class{},Ko=new ae("",{factory:()=>!0});var of=new ae("");var nc=(()=>{class n{static \u0275prov=se({token:n,providedIn:"root",factory:()=>new Ed})}return n})(),Ed=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},xa=class{[Lt];constructor(e){this[Lt]=e}destroy(){this[Lt].destroy()}};function qt(n,e){let t=e?.injector??W(On),r=e?.manualCleanup!==!0?t.get(Wo):null,i,o=t.get(tc,null,{optional:!0}),s=t.get(yr);return o!==null?(i=u0(o.view,s,n),r instanceof Ma&&r._lView===o.view&&(r=null)):i=l0(n,t.get(nc),s),i.injector=t,r!==null&&(i.onDestroyFns=[r.onDestroy(()=>i.destroy())]),new xa(i)}var Av=ge(H({},Zl),{cleanupFns:void 0,zone:null,onDestroyFns:null,run(){let n=Po(!1);try{Jl(this)}finally{Po(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=Q(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],Q(n)}}}),a0=ge(H({},Av),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){if(ri(this),this.onDestroyFns!==null)for(let n of this.onDestroyFns)n();this.cleanup(),this.scheduler.remove(this)}}),c0=ge(H({},Av),{consumerMarkedDirty(){this.view[$]|=8192,mi(this.view),this.notifier.notify(13)},destroy(){if(ri(this),this.onDestroyFns!==null)for(let n of this.onDestroyFns)n();this.cleanup(),this.view[xn]?.delete(this)}});function u0(n,e,t){let r=Object.create(c0);return r.view=n,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=Nv(r,t),n[xn]??=new Set,n[xn].add(r),r.consumerMarkedDirty(r),r}function l0(n,e,t){let r=Object.create(a0);return r.fn=Nv(r,n),r.scheduler=e,r.notifier=t,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}function Nv(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}function Qo(n){return Yl(n)}function yc(n){return{toString:n}.toString()}function E0(n){return typeof n=="function"}function iE(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var cc=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function I0(n){return n.type.prototype.ngOnChanges&&(n.setInput=T0),w0}function w0(){let n=sE(this),e=n?.current;if(e){let t=n.previous;if(t===Er)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function T0(n,e,t,r,i){let o=this.declaredInputs[r],s=sE(n)||D0(n,{previous:Er,current:null}),c=s.current||(s.current={}),u=s.previous,l=u[o];c[o]=new cc(l&&l.currentValue,t,u===Er),iE(n,e,i,t)}var oE="__ngSimpleChanges__";function sE(n){return n[oE]||null}function D0(n,e){return n[oE]=e}var Rv=[];var fe=function(n,e=null,t){for(let r=0;r<Rv.length;r++){let i=Rv[r];i(n,e,t)}},ce=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(ce||{});function C0(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=I0(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function aE(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),c&&((n.contentHooks??=[]).push(t,c),(n.contentCheckHooks??=[]).push(t,c)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function ic(n,e,t){cE(n,e,3,t)}function oc(n,e,t,r){(n[$]&3)===t&&cE(n,e,t,r)}function sf(n,e){let t=n[$];(t&3)===e&&(t&=16383,t+=1,n[$]=t)}function cE(n,e,t,r){let i=r!==void 0?n[wr]&65535:0,o=r??-1,s=e.length-1,c=0;for(let u=i;u<s;u++)if(typeof e[u+1]=="number"){if(c=e[u],r!=null&&c>=r)break}else e[u]<0&&(n[wr]+=65536),(c<o||o==-1)&&(b0(n,t,e,u),n[wr]=(n[wr]&4294901760)+u+2),u++}function Mv(n,e){fe(ce.LifecycleHookStart,n,e);let t=Q(null);try{e.call(n)}finally{Q(t),fe(ce.LifecycleHookEnd,n,e)}}function b0(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],c=n[s];i?n[$]>>14<n[wr]>>16&&(n[$]&3)===e&&(n[$]+=16384,Mv(c,o)):Mv(c,o)}var Ei=-1,Jo=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function S0(n){return(n.flags&8)!==0}function A0(n){return(n.flags&16)!==0}function N0(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],c=t[r++];n.setAttribute(e,s,c,o)}else{let o=i,s=t[++r];M0(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function R0(n){return n===3||n===4||n===6}function M0(n){return n.charCodeAt(0)===64}function Pf(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Pv(n,t,i,null,e[++r]):Pv(n,t,i,null,null))}}return n}function Pv(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let c=n[o++];if(typeof c=="number"){if(c===e){s=-1;break}else if(c>e){s=o-1;break}}}for(;o<n.length;){let c=n[o];if(typeof c=="number")break;if(c===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function uE(n){return n!==Ei}function uc(n){return n&32767}function P0(n){return n>>16}function lc(n,e){let t=P0(n),r=e;for(;t>0;)r=r[Ir],t--;return r}var hf=!0;function xv(n){let e=hf;return hf=n,e}var x0=256,lE=x0-1,dE=5,k0=0,Gt={};function O0(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(_r)&&(r=t[_r]),r==null&&(r=t[_r]=k0++);let i=r&lE,o=1<<i;e.data[n+(i>>dE)]|=o}function fE(n,e){let t=hE(n,e);if(t!==-1)return t;let r=e[z];r.firstCreatePass&&(n.injectorIndex=e.length,af(r.data,n),af(e,null),af(r.blueprint,null));let i=xf(n,e),o=n.injectorIndex;if(uE(i)){let s=uc(i),c=lc(i,e),u=c[z].data;for(let l=0;l<8;l++)e[o+l]=c[s+l]|u[s+l]}return e[o+8]=i,o}function af(n,e){n.push(0,0,0,0,0,0,0,0,e)}function hE(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function xf(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=_E(i),r===null)return Ei;if(t++,i=i[Ir],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ei}function L0(n,e,t){O0(n,e,t)}function pE(n,e,t){if(t&8||n!==void 0)return n;Ua(e,"NodeInjector")}function gE(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[Ln],o=ct(void 0);try{return i?i.get(e,r,t&8):Nd(e,r,t&8)}finally{ct(o)}}return pE(r,e,t)}function mE(n,e,t,r=0,i){if(n!==null){if(e[$]&2048&&!(r&2)){let s=U0(n,e,t,r,Gt);if(s!==Gt)return s}let o=yE(n,e,t,r,Gt);if(o!==Gt)return o}return gE(e,t,r,i)}function yE(n,e,t,r,i){let o=V0(t);if(typeof o=="function"){if(!Jd(e,n,r))return r&1?pE(i,t,r):gE(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&8))Ua(t);else return s}finally{Xd()}}else if(typeof o=="number"){let s=null,c=hE(n,e),u=Ei,l=r&1?e[Dt][mt]:null;for((c===-1||r&4)&&(u=c===-1?xf(n,e):e[c+8],u===Ei||!Ov(r,!1)?c=-1:(s=e[z],c=uc(u),e=lc(u,e)));c!==-1;){let h=e[z];if(kv(o,c,h.data)){let p=F0(c,e,t,s,r,l);if(p!==Gt)return p}u=e[c+8],u!==Ei&&Ov(r,e[z].data[c+8]===l)&&kv(o,c,e)?(s=h,c=uc(u),e=lc(u,e)):c=-1}}return i}function F0(n,e,t,r,i,o){let s=e[z],c=s.data[n+8],u=r==null?Dr(c)&&hf:r!=s&&(c.type&3)!==0,l=i&1&&o===c,h=sc(c,s,t,u,l);return h!==null?dc(e,s,h,c,i):Gt}function sc(n,e,t,r,i){let o=n.providerIndexes,s=e.data,c=o&1048575,u=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?c:c+h,m=i?c+h:l;for(let E=p;E<m;E++){let A=s[E];if(E<u&&t===A||E>=u&&A.type===t)return E}if(i){let E=s[u];if(E&&Cr(E)&&E.type===t)return u}return null}function dc(n,e,t,r,i){let o=n[t],s=e.data;if(o instanceof Jo){let c=o;if(c.resolving){let E=k_(s[t]);throw Ad(E)}let u=xv(c.canSeeViewProviders);c.resolving=!0;let l=s[t].type||s[t],h,p=c.injectImpl?ct(c.injectImpl):null,m=Jd(n,r,0);try{o=n[t]=c.factory(void 0,i,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&C0(t,s[t],e)}finally{p!==null&&ct(p),xv(u),c.resolving=!1,Xd()}}return o}function V0(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(_r)?n[_r]:void 0;return typeof e=="number"?e>=0?e&lE:B0:e}function kv(n,e,t){let r=1<<n;return!!(t[e+(n>>dE)]&r)}function Ov(n,e){return!(n&2)&&!(n&1&&e)}var Nr=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return mE(this._tNode,this._lView,e,gr(r),t)}};function B0(){return new Nr($t(),_e())}function U0(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[$]&2048&&!gi(s);){let c=yE(o,s,t,r|2,Gt);if(c!==Gt)return c;let u=o.parent;if(!u){let l=s[Fd];if(l){let h=l.get(t,Gt,r);if(h!==Gt)return h}u=_E(s),s=s[Ir]}o=u}return i}function _E(n){let e=n[z],t=e.type;return t===2?e.declTNode:t===1?n[mt]:null}function j0(){return Ci($t(),_e())}function Ci(n,e){return new bi(Ut(n,e))}var bi=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=j0}return n})();function H0(n){return n instanceof bi?n.nativeElement:n}function $0(){return this._results[Symbol.iterator]()}var fc=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new an}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let r=B_(e);(this._changesDetected=!V_(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=$0};function vE(n){return(n.flags&128)===128}var kf=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(kf||{}),EE=new Map,z0=0;function q0(){return z0++}function G0(n){EE.set(n[jo],n)}function pf(n){EE.delete(n[jo])}var Lv="__ngContext__";function Ii(n,e){ln(e)?(n[Lv]=e[jo],G0(e)):n[Lv]=e}function IE(n){return TE(n[pi])}function wE(n){return TE(n[gt])}function TE(n){for(;n!==null&&!Ct(n);)n=n[gt];return n}var W0;function Of(n){W0=n}var _c=new ae("",{factory:()=>K0}),K0="ng";var vc=new ae(""),is=new ae("",{providedIn:"platform",factory:()=>"unknown"});var Ec=new ae("",{factory:()=>W(bt).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var DE=!1,CE=new ae("",{factory:()=>DE});var Q0=(n,e,t,r)=>{};function Y0(n,e,t,r){Q0(n,e,t,r)}function Lf(n){return(n.flags&32)===32}var Z0=()=>null;function bE(n,e,t=!1){return Z0(n,e,t)}function SE(n,e){let t=n.contentQueries;if(t!==null){let r=Q(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let c=n.data[s];Ya(o),c.contentQueries(2,e[s],s)}}}finally{Q(r)}}}function gf(n,e,t){Ya(0);let r=Q(null);try{e(n,t)}finally{Q(r)}}function AE(n,e,t){if(Vd(e)){let r=Q(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let c=n.data[s];if(c.contentQueries){let u=t[s];c.contentQueries(1,u,s)}}}finally{Q(r)}}}var At=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(At||{});var hc=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ka})`}};function Ff(n){return n instanceof hc?n.changingThisBreaksApplicationSecurity:n}function NE(n,e){let t=RE(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${ka})`)}return t===e}function RE(n){return n instanceof hc&&n.getTypeName()||null}var J0=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function ME(n){return n=String(n),n.match(J0)?n:"unsafe:"+n}function X0(n,e){return n.createText(e)}function eS(n,e,t){n.setValue(e,t)}function PE(n,e,t){return n.createElement(e,t)}function pc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function xE(n,e,t){n.appendChild(e,t)}function Fv(n,e,t,r,i){r!==null?pc(n,e,t,r,i):xE(n,e,t)}function tS(n,e,t,r){n.removeChild(null,e,t,r)}function nS(n,e,t){n.setAttribute(e,"style",t)}function rS(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function kE(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&N0(n,e,r),i!==null&&rS(n,e,i),o!==null&&nS(n,e,o)}var Vf=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Vf||{});function Bf(n){let e=iS();return e?e.sanitize(Vf.URL,n)||"":NE(n,"URL")?Ff(n):ME(Ba(n))}function iS(){let n=_e();return n&&n[Vt].sanitizer}function Pr(n){return n.ownerDocument.defaultView}function oS(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var OE="ng-template";function sS(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&oS(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Uf(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Uf(n){return n.type===4&&n.value!==OE}function aS(n,e,t){let r=n.type===4&&!t?OE:n.value;return e===r}function cS(n,e,t){let r=4,i=n.attrs,o=i!==null?dS(i):0,s=!1;for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="number"){if(!s&&!St(r)&&!St(u))return!1;if(s&&St(u))continue;s=!1,r=u|r&1;continue}if(!s)if(r&4){if(r=2|r&1,u!==""&&!aS(n,u,t)||u===""&&e.length===1){if(St(r))return!1;s=!0}}else if(r&8){if(i===null||!sS(n,i,u,t)){if(St(r))return!1;s=!0}}else{let l=e[++c],h=uS(u,i,Uf(n),t);if(h===-1){if(St(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(St(r))return!1;s=!0}}}}return St(r)||s}function St(n){return(n&1)===0}function uS(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let c=e[++i];for(;typeof c=="string";)c=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return fS(e,n)}function lS(n,e,t=!1){for(let r=0;r<e.length;r++)if(cS(n,e[r],t))return!0;return!1}function dS(n){for(let e=0;e<n.length;e++){let t=n[e];if(R0(t))return e}return n.length}function fS(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Vv(n,e){return n?":not("+e.trim()+")":e}function hS(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let c=n[++t];i+="["+s+(c.length>0?'="'+c+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!St(s)&&(e+=Vv(o,i),i=""),r=s,o=o||!St(r);t++}return i!==""&&(e+=Vv(o,i)),e}function pS(n){return n.map(hS).join(",")}function gS(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!St(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var jn={};function jf(n,e,t,r,i,o,s,c,u,l,h){let p=st+r,m=p+i,E=mS(p,m),A=typeof l=="function"?l():l;return E[z]={type:n,blueprint:E,template:t,queries:null,viewQuery:c,declTNode:e,data:E.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:u,consts:A,incompleteFirstPass:!1,ssrId:h}}function mS(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:jn);return t}function yS(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=jf(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Hf(n,e,t,r,i,o,s,c,u,l,h){let p=e.blueprint.slice();return p[Tt]=i,p[$]=r|4|128|8|64|1024,(l!==null||n&&n[$]&2048)&&(p[$]|=2048),jd(p),p[Fe]=p[Ir]=n,p[Ge]=t,p[Vt]=s||n&&n[Vt],p[Ve]=c||n&&n[Ve],p[Ln]=u||n&&n[Ln]||null,p[mt]=o,p[jo]=q0(),p[Uo]=h,p[Fd]=l,p[Dt]=e.type==2?n[Dt]:p,p}function _S(n,e,t){let r=Ut(e,n),i=yS(t),o=n[Vt].rendererFactory,s=$f(n,Hf(n,i,null,LE(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function LE(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function FE(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function $f(n,e){return n[pi]?n[Ld][gt]=e:n[pi]=e,n[Ld]=e,e}function le(n=1){VE(Ht(),_e(),Sr()+n,!1)}function VE(n,e,t,r){if(!r)if((e[$]&3)===3){let o=n.preOrderCheckHooks;o!==null&&ic(e,o,t)}else{let o=n.preOrderHooks;o!==null&&oc(e,o,0,t)}Bn(t)}var Ic=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Ic||{});function mf(n,e,t,r){let i=Q(null);try{let[o,s,c]=n.inputs[t],u=null;(s&Ic.SignalBased)!==0&&(u=e[o][Lt]),u!==null&&u.transformFn!==void 0?r=u.transformFn(r):c!==null&&(r=c.call(e,r)),n.setInput!==null?n.setInput(e,u,r,t,o):iE(e,u,o,r)}finally{Q(i)}}var Wt=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Wt||{}),vS;function zf(n,e){return vS(n,e)}var wi=new Set,qf=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(qf||{}),os=new ae(""),Bv=new Set;function Gf(n){Bv.has(n)||(Bv.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var BE=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=se({token:n,providedIn:"root",factory:()=>new n})}return n})();var ES=new ae("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:W(pt)})});function UE(n,e,t){let r=n.get(ES);if(Array.isArray(e))for(let i of e)r.queue.add(i),t?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function IS(n,e){for(let[t,r]of e)UE(n,r.animateFns)}function Uv(n,e,t,r){let i=n?.[Ho]?.enter;e!==null&&i&&i.has(t.index)&&IS(r,i)}function vi(n,e,t,r,i,o,s,c){if(i!=null){let u,l=!1;Ct(i)?u=i:ln(i)&&(l=!0,i=i[Tt]);let h=yt(i);n===0&&r!==null?(Uv(c,r,o,t),s==null?xE(e,r,h):pc(e,r,h,s||null,!0)):n===1&&r!==null?(Uv(c,r,o,t),pc(e,r,h,s||null,!0)):n===2?jv(c,o,t,p=>{tS(e,h,l,p)}):n===3&&jv(c,o,t,()=>{e.destroyNode(h)}),u!=null&&kS(e,n,t,u,o,r,s)}}function wS(n,e){jE(n,e),e[Tt]=null,e[mt]=null}function TS(n,e,t,r,i,o){r[Tt]=i,r[mt]=e,wc(n,r,t,1,i,o)}function jE(n,e){e[Vt].changeDetectionScheduler?.notify(9),wc(n,e,e[Ve],2,null,null)}function DS(n){let e=n[pi];if(!e)return cf(n[z],n);for(;e;){let t=null;if(ln(e))t=e[pi];else{let r=e[nt];r&&(t=r)}if(!t){for(;e&&!e[gt]&&e!==n;)ln(e)&&cf(e[z],e),e=e[Fe];e===null&&(e=n),ln(e)&&cf(e[z],e),t=e&&e[gt]}e=t}}function Wf(n,e){let t=n[Tr],r=t.indexOf(e);t.splice(r,1)}function HE(n,e){if(br(e))return;let t=e[Ve];t.destroyNode&&wc(n,e,t,3,null,null),DS(e)}function cf(n,e){if(br(e))return;let t=Q(null);try{e[$]&=-129,e[$]|=256,e[lt]&&ri(e[lt]),SS(n,e),bS(n,e),e[z].type===1&&e[Ve].destroy();let r=e[Fn];if(r!==null&&Ct(e[Fe])){r!==e[Fe]&&Wf(r,e);let i=e[Bt];i!==null&&i.detachView(n)}pf(e)}finally{Q(t)}}function jv(n,e,t,r){let i=n?.[Ho];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);n&&wi.add(n),UE(t,()=>{if(i.leave&&i.leave.has(e.index)){let s=i.leave.get(e.index),c=[];if(s){for(let u=0;u<s.animateFns.length;u++){let l=s.animateFns[u],{promise:h}=l();c.push(h)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(c),CS(n,r)}else n&&wi.delete(n),r(!1)},i)}function CS(n,e){let t=n[Ho]?.running;if(t){t.then(()=>{n[Ho].running=void 0,wi.delete(n),e(!0)});return}e(!1)}function bS(n,e){let t=n.cleanup,r=e[hi];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let c=t[s+3];c>=0?r[c]():r[-c].unsubscribe(),s+=2}else{let c=r[t[s+1]];t[s].call(c)}r!==null&&(e[hi]=null);let i=e[cn];if(i!==null){e[cn]=null;for(let s=0;s<i.length;s++){let c=i[s];c()}}let o=e[xn];if(o!==null){e[xn]=null;for(let s of o)s.destroy()}}function SS(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Jo)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let c=i[o[s]],u=o[s+1];fe(ce.LifecycleHookStart,c,u);try{u.call(c)}finally{fe(ce.LifecycleHookEnd,c,u)}}else{fe(ce.LifecycleHookStart,i,o);try{o.call(i)}finally{fe(ce.LifecycleHookEnd,i,o)}}}}}function AS(n,e,t){return NS(n,e.parent,t)}function NS(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Tt];if(Dr(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===At.None||i===At.Emulated)return null}return Ut(r,t)}function RS(n,e,t){return PS(n,e,t)}function MS(n,e,t){return n.type&40?Ut(n,t):null}var PS=MS,Hv;function Kf(n,e,t,r){let i=AS(n,r,e),o=e[Ve],s=r.parent||e[mt],c=RS(s,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)Fv(o,i,t[u],c,!1);else Fv(o,i,t,c,!1);Hv!==void 0&&Hv(o,r,e,t,i)}function Yo(n,e){if(e!==null){let t=e.type;if(t&3)return Ut(e,n);if(t&4)return yf(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Yo(n,r);{let i=n[e.index];return Ct(i)?yf(-1,i):yt(i)}}else{if(t&128)return Yo(n,e.next);if(t&32)return zf(e,n)()||yt(n[e.index]);{let r=$E(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=kn(n[Dt]);return Yo(i,r)}else return Yo(n,e.next)}}}return null}function $E(n,e){if(e!==null){let r=n[Dt][mt],i=e.projection;return r.projection[i]}return null}function yf(n,e){let t=nt+n+1;if(t<e.length){let r=e[t],i=r[z].firstChild;if(i!==null)return Yo(r,i)}return e[Vn]}function Qf(n,e,t,r,i,o,s){for(;t!=null;){let c=r[Ln];if(t.type===128){t=t.next;continue}let u=r[t.index],l=t.type;if(s&&e===0&&(u&&Ii(yt(u),r),t.flags|=2),!Lf(t))if(l&8)Qf(n,e,t.child,r,i,o,!1),vi(e,n,c,i,u,t,o,r);else if(l&32){let h=zf(t,r),p;for(;p=h();)vi(e,n,c,i,p,t,o,r);vi(e,n,c,i,u,t,o,r)}else l&16?xS(n,e,r,t,i,o):vi(e,n,c,i,u,t,o,r);t=s?t.projectionNext:t.next}}function wc(n,e,t,r,i,o){Qf(t,r,n.firstChild,e,i,o,!1)}function xS(n,e,t,r,i,o){let s=t[Dt],u=s[mt].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let h=u[l];vi(e,n,t[Ln],i,h,r,o,t)}else{let l=u,h=s[Fe];vE(r)&&(l.flags|=128),Qf(n,e,l,h,i,o,!0)}}function kS(n,e,t,r,i,o,s){let c=r[Vn],u=yt(r);c!==u&&vi(e,n,t,o,c,i,s);for(let l=nt;l<r.length;l++){let h=r[l];wc(h[z],h,n,e,o,c)}}function OS(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:Wt.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Wt.Important),n.setStyle(t,r,i,o))}}function zE(n,e,t,r,i){let o=Sr(),s=r&2;try{Bn(-1),s&&e.length>st&&VE(n,e,st,!1);let c=s?ce.TemplateUpdateStart:ce.TemplateCreateStart;fe(c,i,t),t(r,i)}finally{Bn(o);let c=s?ce.TemplateUpdateEnd:ce.TemplateCreateEnd;fe(c,i,t)}}function Yf(n,e,t){$S(n,e,t),(t.flags&64)===64&&zS(n,e,t)}function qE(n,e,t=Ut){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],c=s===-1?t(e,n):n[s];n[i++]=c}}}function LS(n,e,t,r){let o=r.get(CE,DE)||t===At.ShadowDom||t===At.ExperimentalIsolatedShadowDom,s=n.selectRootElement(e,o);return FS(s),s}function FS(n){VS(n)}var VS=()=>null;function BS(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function US(n,e,t,r,i,o){let s=e[z];if(Zf(n,s,e,t,r)){Dr(n)&&HS(e,n.index);return}n.type&3&&(t=BS(t)),jS(n,e,t,r,i,o)}function jS(n,e,t,r,i,o){if(n.type&3){let s=Ut(n,e);r=o!=null?o(r,n.value||"",t):r,i.setProperty(s,t,r)}else n.type&12}function HS(n,e){let t=jt(e,n);t[$]&16||(t[$]|=64)}function $S(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Dr(t)&&_S(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||fE(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let c=n.data[s],u=dc(e,n,s,t);if(Ii(u,e),o!==null&&GS(e,s-r,u,c,t,o),Cr(c)){let l=jt(t.index,e);l[Ge]=dc(e,n,s,t)}}}function zS(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=pv();try{Bn(o);for(let c=r;c<i;c++){let u=n.data[c],l=e[c];Qa(c),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&qS(u,l)}}finally{Bn(-1),Qa(s)}}function qS(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function GE(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];lS(e,o.selectors,!1)&&(r??=[],Cr(o)?r.unshift(o):r.push(o))}return r}function GS(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let c=0;c<s.length;c+=2){let u=s[c],l=s[c+1];mf(r,t,u,l)}}function WS(n,e,t,r,i){let o=st+t,s=e[z],c=i(s,e,n,r,t);e[o]=c,yi(n,!0);let u=n.type===2;return u?(kE(e[Ve],c,n),(tv()===0||zo(n))&&Ii(c,e),nv()):Ii(c,e),Xa()&&(!u||!Lf(n))&&Kf(s,e,c,n),n}function KS(n){let e=n;return Kd()?cv():(e=e.parent,yi(e,!1)),e}function QS(n,e){let t=n[Ln];if(!t)return;let r;try{r=t.get(Ar,null)}catch{r=null}r?.(e)}function Zf(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],c=!1;if(s)for(let u=0;u<s.length;u+=2){let l=s[u],h=s[u+1],p=e.data[l];mf(p,t[l],h,i),c=!0}if(o)for(let u of o){let l=t[u],h=e.data[u];mf(h,l,r,i),c=!0}return c}function YS(n,e){let t=jt(e,n),r=t[z];ZS(r,t);let i=t[Tt];i!==null&&t[Uo]===null&&(t[Uo]=bE(i,t[Ln])),fe(ce.ComponentStart);try{Jf(r,t,t[Ge])}finally{fe(ce.ComponentEnd,t[Ge])}}function ZS(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Jf(n,e,t){Za(e);try{let r=n.viewQuery;r!==null&&gf(1,r,t);let i=n.template;i!==null&&zE(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Bt]?.finishViewCreation(n),n.staticContentQueries&&SE(n,e),n.staticViewQueries&&gf(2,n.viewQuery,t);let o=n.components;o!==null&&JS(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[$]&=-5,Ja()}}function JS(n,e){for(let t=0;t<e.length;t++)YS(n,e[t])}function XS(n,e,t,r){let i=Q(null);try{let o=e.tView,c=n[$]&4096?4096:16,u=Hf(n,o,t,c,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[Fn]=l;let h=n[Bt];return h!==null&&(u[Bt]=h.createEmbeddedView(o)),Jf(o,u,t),u}finally{Q(i)}}function $v(n,e){return!e||e.firstChild===null||vE(n)}function Xo(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(yt(o)),Ct(o)&&WE(o,r);let s=t.type;if(s&8)Xo(n,e,t.child,r);else if(s&32){let c=zf(t,e),u;for(;u=c();)r.push(u)}else if(s&16){let c=$E(e,t);if(Array.isArray(c))r.push(...c);else{let u=kn(e[Dt]);Xo(u[z],u,c,r,!0)}}t=i?t.projectionNext:t.next}return r}function WE(n,e){for(let t=nt;t<n.length;t++){let r=n[t],i=r[z].firstChild;i!==null&&Xo(r[z],r,i,e)}n[Vn]!==n[Tt]&&e.push(n[Vn])}function KE(n){if(n[qa]!==null){for(let e of n[qa])e.impl.addSequence(e);n[qa].length=0}}var QE=[];function eA(n){return n[lt]??tA(n)}function tA(n){let e=QE.pop()??Object.create(rA);return e.lView=n,e}function nA(n){n.lView[lt]!==n&&(n.lView=null,QE.push(n))}var rA=ge(H({},So),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{mi(n.lView)},consumerOnSignalRead(){this.lView[lt]=this}});function iA(n){let e=n[lt]??Object.create(oA);return e.lView=n,e}var oA=ge(H({},So),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=kn(n.lView);for(;e&&!YE(e[z]);)e=kn(e);e&&Hd(e)},consumerOnSignalRead(){this.lView[lt]=this}});function YE(n){return n.type!==2}function ZE(n){if(n[xn]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[xn])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[$]&8192)}}var sA=100;function JE(n,e=0){let r=n[Vt].rendererFactory,i=!1;i||r.begin?.();try{aA(n,e)}finally{i||r.end?.()}}function aA(n,e){let t=Qd();try{Po(!0),_f(n,e);let r=0;for(;Go(n);){if(r===sA)throw new ee(103,!1);r++,_f(n,1)}}finally{Po(t)}}function cA(n,e,t,r){if(br(e))return;let i=e[$],o=!1,s=!1;Za(e);let c=!0,u=null,l=null;o||(YE(n)?(l=eA(e),u=va(l)):_a()===null?(c=!1,l=iA(e),u=va(l)):e[lt]&&(ri(e[lt]),e[lt]=null));try{jd(e),lv(n.bindingStartIndex),t!==null&&zE(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let E=n.preOrderCheckHooks;E!==null&&ic(e,E,null)}else{let E=n.preOrderHooks;E!==null&&oc(e,E,0,null),sf(e,0)}if(s||uA(e),ZE(e),XE(e,0),n.contentQueries!==null&&SE(n,e),!o)if(h){let E=n.contentCheckHooks;E!==null&&ic(e,E)}else{let E=n.contentHooks;E!==null&&oc(e,E,1),sf(e,1)}dA(n,e);let p=n.components;p!==null&&tI(e,p,0);let m=n.viewQuery;if(m!==null&&gf(2,m,r),!o)if(h){let E=n.viewCheckHooks;E!==null&&ic(e,E)}else{let E=n.viewHooks;E!==null&&oc(e,E,2),sf(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[za]){for(let E of e[za])E();e[za]=null}o||(KE(e),e[$]&=-73)}catch(h){throw o||mi(e),h}finally{l!==null&&(ql(l,u),c&&nA(l)),Ja()}}function XE(n,e){for(let t=IE(n);t!==null;t=wE(t))for(let r=nt;r<t.length;r++){let i=t[r];eI(i,e)}}function uA(n){for(let e=IE(n);e!==null;e=wE(e)){if(!(e[$]&2))continue;let t=e[Tr];for(let r=0;r<t.length;r++){let i=t[r];Hd(i)}}}function lA(n,e,t){fe(ce.ComponentStart);let r=jt(e,n);try{eI(r,t)}finally{fe(ce.ComponentEnd,r[Ge])}}function eI(n,e){Wa(n)&&_f(n,e)}function _f(n,e){let r=n[z],i=n[$],o=n[lt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Ea(o)),s||=!1,o&&(o.dirty=!1),n[$]&=-9217,s)cA(r,n,r.template,n[Ge]);else if(i&8192){let c=Q(null);try{ZE(n),XE(n,1);let u=r.components;u!==null&&tI(n,u,1),KE(n)}finally{Q(c)}}}function tI(n,e,t){for(let r=0;r<e.length;r++)lA(n,e[r],t)}function dA(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Bn(~i);else{let o=i,s=t[++r],c=t[++r];hv(s,o);let u=e[o];fe(ce.HostBindingsUpdateStart,u);try{c(2,u)}finally{fe(ce.HostBindingsUpdateEnd,u)}}}}finally{Bn(-1)}}function Xf(n,e){let t=Qd()?64:1088;for(n[Vt].changeDetectionScheduler?.notify(e);n;){n[$]|=t;let r=kn(n);if(gi(n)&&!r)return n;n=r}return null}function nI(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function fA(n,e,t,r=!0){let i=e[z];if(hA(i,e,n,t),r){let s=yf(t,n),c=e[Ve],u=c.parentNode(n[Vn]);u!==null&&TS(i,n[mt],c,e,u,s)}let o=e[Uo];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function vf(n,e){if(n.length<=nt)return;let t=nt+e,r=n[t];if(r){let i=r[Fn];i!==null&&i!==n&&Wf(i,r),e>0&&(n[t-1][gt]=r[gt]);let o=Lo(n,nt+e);wS(r[z],r);let s=o[Bt];s!==null&&s.detachView(o[z]),r[Fe]=null,r[gt]=null,r[$]&=-129}return r}function hA(n,e,t,r){let i=nt+r,o=t.length;r>0&&(t[i-1][gt]=e),r<o-nt?(e[gt]=t[i],Rd(t,nt+r,e)):(t.push(e),e[gt]=null),e[Fe]=t;let s=e[Fn];s!==null&&t!==s&&rI(s,e);let c=e[Bt];c!==null&&c.insertView(n),Ka(e),e[$]|=128}function rI(n,e){let t=n[Tr],r=e[Fe];if(ln(r))n[$]|=2;else{let i=r[Fe][Dt];e[Dt]!==i&&(n[$]|=2)}t===null?n[Tr]=[e]:t.push(e)}var Ti=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[z];return Xo(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Ge]}set context(e){this._lView[Ge]=e}get destroyed(){return br(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Fe];if(Ct(e)){let t=e[$o],r=t?t.indexOf(this):-1;r>-1&&(vf(e,r),Lo(t,r))}this._attachedToViewContainer=!1}HE(this._lView[z],this._lView)}onDestroy(e){$d(this._lView,e)}markForCheck(){Xf(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[$]&=-129}reattach(){Ka(this._lView),this._lView[$]|=128}detectChanges(){this._lView[$]|=1024,JE(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=gi(this._lView),t=this._lView[Fn];t!==null&&!e&&Wf(t,this._lView),jE(this._lView[z],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ee(902,!1);this._appRef=e;let t=gi(this._lView),r=this._lView[Fn];r!==null&&!t&&rI(r,this._lView),Ka(this._lView)}};var Un=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=pA;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let o=XS(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new Ti(o)}}return n})();function pA(){return eh($t(),_e())}function eh(n,e){return n.type&4?new Un(e,n,Ci(n,e)):null}function th(n,e,t,r,i){let o=n.data[e];if(o===null)o=gA(n,e,t,r,i),fv()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=av();o.injectorIndex=s===null?-1:s.injectorIndex}return yi(o,!0),o}function gA(n,e,t,r,i){let o=Wd(),s=Kd(),c=s?o:o&&o.parent,u=n.data[e]=yA(n,c,t,e,r,i);return mA(n,u,o,s),u}function mA(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function yA(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,c=0;return iv()&&(c|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:c,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var _A=()=>null;function zv(n,e){return _A(n,e)}var iI=class{},Tc=class{},Ef=class{resolveComponentFactory(e){throw new ee(917,!1)}},Dc=class{static NULL=new Ef},Rr=class{};var oI=(()=>{class n{static \u0275prov=se({token:n,providedIn:"root",factory:()=>null})}return n})();var ac={},If=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,ac,r);return i!==ac||t===ac?i:this.parentInjector.get(e,t,r)}};function qv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let c=e[s];if(typeof c=="number")o=c;else if(o==1)i=Id(i,c);else if(o==2){let u=c,l=e[++s];r=Id(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function Nt(n,e=0){let t=_e();if(t===null)return oe(n,e);let r=$t();return mE(r,t,ut(n),e)}function sI(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let c=s,u=null,l=null;for(let h of s)if(h.resolveHostDirectives!==null){[c,u,l]=h.resolveHostDirectives(s);break}IA(n,e,t,c,o,u,l)}o!==null&&r!==null&&vA(t,r,o)}function vA(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new ee(-301,!1);r.push(e[i],o)}}function EA(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function IA(n,e,t,r,i,o,s){let c=r.length,u=null;for(let m=0;m<c;m++){let E=r[m];u===null&&Cr(E)&&(u=E,EA(n,t,m)),L0(fE(t,e),n,E.type)}SA(t,n.data.length,c),u?.viewProvidersResolver&&u.viewProvidersResolver(u);for(let m=0;m<c;m++){let E=r[m];E.providersResolver&&E.providersResolver(E)}let l=!1,h=!1,p=FE(n,e,c,null);c>0&&(t.directiveToIndex=new Map);for(let m=0;m<c;m++){let E=r[m];if(t.mergedAttrs=Pf(t.mergedAttrs,E.hostAttrs),TA(n,t,e,p,E),bA(p,E,i),s!==null&&s.has(E)){let[M,S]=s.get(E);t.directiveToIndex.set(E.type,[p,M+t.directiveStart,S+t.directiveStart])}else(o===null||!o.has(E))&&t.directiveToIndex.set(E.type,p);E.contentQueries!==null&&(t.flags|=4),(E.hostBindings!==null||E.hostAttrs!==null||E.hostVars!==0)&&(t.flags|=64);let A=E.type.prototype;!l&&(A.ngOnChanges||A.ngOnInit||A.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!h&&(A.ngOnChanges||A.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),h=!0),p++}wA(n,t,o)}function wA(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))Gv(0,e,i,r),Gv(1,e,i,r),Kv(e,r,!1);else{let o=t.get(i);Wv(0,e,o,r),Wv(1,e,o,r),Kv(e,r,!0)}}}function Gv(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),aI(e,o)}}function Wv(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],c;n===0?c=e.hostDirectiveInputs??={}:c=e.hostDirectiveOutputs??={},c[s]??=[],c[s].push(r,o),aI(e,s)}}function aI(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function Kv(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||Uf(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,c=0;for(;c<r.length;){let u=r[c];if(u===0){c+=4;continue}else if(u===5){c+=2;continue}else if(typeof u=="number")break;if(!t&&i.hasOwnProperty(u)){let l=i[u];for(let h of l)if(h===e){s??=[],s.push(u,r[c+1]);break}}else if(t&&o.hasOwnProperty(u)){let l=o[u];for(let h=0;h<l.length;h+=2)if(l[h]===e){s??=[],s.push(l[h+1],r[c+1]);break}}c+=2}n.initialInputs??=[],n.initialInputs.push(s)}function TA(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=di(i.type,!0)),s=new Jo(o,Cr(i),Nt,null);n.blueprint[r]=s,t[r]=s,DA(n,e,r,FE(n,t,i.hostVars,jn),i)}function DA(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let c=~e.index;CA(s)!=c&&s.push(c),s.push(t,r,o)}}function CA(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function bA(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Cr(e)&&(t[""]=n)}}function SA(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function cI(n,e,t,r,i,o,s,c){let u=e[z],l=u.consts,h=qo(l,s),p=th(u,n,t,r,h);return o&&sI(u,e,p,qo(l,c),i),p.mergedAttrs=Pf(p.mergedAttrs,p.attrs),p.attrs!==null&&qv(p,p.attrs,!1),p.mergedAttrs!==null&&qv(p,p.mergedAttrs,!0),u.queries!==null&&u.queries.elementStart(u,p),p}function uI(n,e){aE(n,e),Vd(e)&&n.queries.elementEnd(e)}function nh(n){return dI(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function lI(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function dI(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function rh(n,e,t){if(t===jn)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function uf(n,e,t){return function r(i){let o=Dr(n)?jt(n.index,e):e;Xf(o,5);let s=e[Ge],c=Qv(e,s,t,i),u=r.__ngNextListenerFn__;for(;u;)c=Qv(e,s,u,i)&&c,u=u.__ngNextListenerFn__;return c}}function Qv(n,e,t,r){let i=Q(null);try{return fe(ce.OutputStart,e,t),t(r)!==!1}catch(o){return QS(n,o),!1}finally{fe(ce.OutputEnd,e,t),Q(i)}}function AA(n,e,t,r,i,o,s,c){let u=zo(n),l=!1,h=null;if(!r&&u&&(h=RA(e,t,o,n.index)),h!==null){let p=h.__ngLastListenerFn__||h;p.__ngNextListenerFn__=s,h.__ngLastListenerFn__=s,l=!0}else{let p=Ut(n,t),m=r?r(p):p;Y0(t,m,o,c);let E=i.listen(m,o,c);if(!NA(o)){let A=r?M=>r(yt(M[n.index])):n.index;fI(A,e,t,o,c,E,!1)}}return l}function NA(n){return n.startsWith("animation")||n.startsWith("transition")}function RA(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let c=e[hi],u=i[o+2];return c&&c.length>u?c[u]:null}typeof s=="string"&&(o+=2)}return null}function fI(n,e,t,r,i,o,s){let c=e.firstCreatePass?qd(e):null,u=zd(t),l=u.length;u.push(i,o),c&&c.push(r,n,l,(l+1)*(s?-1:1))}function Yv(n,e,t,r,i,o){let s=e[t],c=e[z],l=c.data[t].outputs[r],p=s[l].subscribe(o);fI(n.index,c,e,i,o,p,!0)}var wf=Symbol("BINDING");var Tf=class extends Dc{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=vr(e);return new es(t,this.ngModule)}};function MA(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&Ic.SignalBased)!==0};return i&&(o.transform=i),o})}function PA(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function xA(n,e,t){let r=e instanceof pt?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new If(t,r):t}function kA(n){let e=n.get(Rr,null);if(e===null)throw new ee(407,!1);let t=n.get(oI,null),r=n.get(yr,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function OA(n,e){let t=hI(n);return PE(e,t,t==="svg"?Bd:t==="math"?K_:null)}function hI(n){return(n.selectors[0][0]||"div").toLowerCase()}var es=class extends Tc{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=MA(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=PA(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=pS(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,o,s){fe(ce.DynamicComponentStart);let c=Q(null);try{let u=this.componentDef,l=LA(r,u,s,o),h=xA(u,i||this.ngModule,e),p=kA(h),m=p.rendererFactory.createRenderer(null,u),E=r?LS(m,r,u.encapsulation,h):OA(u,m),A=s?.some(Zv)||o?.some(x=>typeof x!="function"&&x.bindings.some(Zv)),M=Hf(null,l,null,512|LE(u),null,null,p,m,h,null,bE(E,h,!0));M[st]=E,Za(M);let S=null;try{let x=cI(st,M,2,"#host",()=>l.directiveRegistry,!0,0);kE(m,E,x),Ii(E,M),Yf(l,M,x),AE(l,x,M),uI(l,x),t!==void 0&&VA(x,this.ngContentSelectors,t),S=jt(x.index,M),M[Ge]=S[Ge],Jf(l,M,null)}catch(x){throw S!==null&&pf(S),pf(M),x}finally{fe(ce.DynamicComponentEnd),Ja()}return new gc(this.componentType,M,!!A)}finally{Q(c)}}};function LA(n,e,t,r){let i=n?["ng-version","21.0.6"]:gS(e.selectors[0]),o=null,s=null,c=0;if(t)for(let h of t)c+=h[wf].requiredVars,h.create&&(h.targetIdx=0,(o??=[]).push(h)),h.update&&(h.targetIdx=0,(s??=[]).push(h));if(r)for(let h=0;h<r.length;h++){let p=r[h];if(typeof p!="function")for(let m of p.bindings){c+=m[wf].requiredVars;let E=h+1;m.create&&(m.targetIdx=E,(o??=[]).push(m)),m.update&&(m.targetIdx=E,(s??=[]).push(m))}}let u=[e];if(r)for(let h of r){let p=typeof h=="function"?h:h.type,m=bd(p);u.push(m)}return jf(0,null,FA(o,s),1,c,u,null,null,null,[i],null)}function FA(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function Zv(n){let e=n[wf].kind;return e==="input"||e==="twoWay"}var gc=class extends iI{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=Ga(t[z],st),this.location=Ci(this._tNode,t),this.instance=jt(this._tNode.index,t)[Ge],this.hostView=this.changeDetectorRef=new Ti(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=Zf(r,i[z],i,e,t);this.previousInputValues.set(e,t);let s=jt(r.index,i);Xf(s,1)}get injector(){return new Nr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function VA(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var xr=(()=>{class n{static __NG_ELEMENT_ID__=BA}return n})();function BA(){let n=$t();return gI(n,_e())}var UA=xr,pI=class extends UA{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Ci(this._hostTNode,this._hostLView)}get injector(){return new Nr(this._hostTNode,this._hostLView)}get parentInjector(){let e=xf(this._hostTNode,this._hostLView);if(uE(e)){let t=lc(e,this._hostLView),r=uc(e),i=t[z].data[r+8];return new Nr(i,t)}else return new Nr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Jv(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-nt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=zv(this._lContainer,e.ssrId),c=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(c,i,$v(this._hostTNode,s)),c}createComponent(e,t,r,i,o,s,c){let u=e&&!E0(e),l;if(u)l=t;else{let S=t||{};l=S.index,r=S.injector,i=S.projectableNodes,o=S.environmentInjector||S.ngModuleRef,s=S.directives,c=S.bindings}let h=u?e:new es(vr(e)),p=r||this.parentInjector;if(!o&&h.ngModule==null){let x=(u?p:this.parentInjector).get(pt,null);x&&(o=x)}let m=vr(h.componentType??{}),E=zv(this._lContainer,m?.id??null),A=E?.firstChild??null,M=h.create(p,i,A,o,s,c);return this.insertImpl(M.hostView,l,$v(this._hostTNode,E)),M}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(Z_(i)){let c=this.indexOf(e);if(c!==-1)this.detach(c);else{let u=i[Fe],l=new pI(u,u[mt],u[Fe]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return fA(s,i,o,r),e.attachToViewContainerRef(),Rd(lf(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Jv(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=vf(this._lContainer,t);r&&(Lo(lf(this._lContainer),t),HE(r[z],r))}detach(e){let t=this._adjustIndex(e,-1),r=vf(this._lContainer,t);return r&&Lo(lf(this._lContainer),t)!=null?new Ti(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function Jv(n){return n[$o]}function lf(n){return n[$o]||(n[$o]=[])}function gI(n,e){let t,r=e[n.index];return Ct(r)?t=r:(t=nI(r,e,null,n),e[n.index]=t,$f(e,t)),HA(t,e,n,r),new pI(t,n,e)}function jA(n,e){let t=n[Ve],r=t.createComment(""),i=Ut(e,n),o=t.parentNode(i);return pc(t,o,r,t.nextSibling(i),!1),r}var HA=qA,$A=()=>!1;function zA(n,e,t){return $A(n,e,t)}function qA(n,e,t,r){if(n[Vn])return;let i;t.type&8?i=yt(r):i=jA(e,t),n[Vn]=i}var Df=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Cf=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let r=e.contentQueries!==null?e.contentQueries[0]:t.length,i=[];for(let o=0;o<r;o++){let s=t.getByIndex(o),c=this.queries[s.indexInDeclarationView];i.push(c.clone())}return new n(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)ih(e,t).matches!==null&&this.queries[t].setDirty()}},bf=class{flags;read;predicate;constructor(e,t,r=null){this.flags=t,this.read=r,typeof e=="string"?this.predicate=XA(e):this.predicate=e}},Sf=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,o=this.getByIndex(r).embeddedTView(e,i);o&&(o.indexInDeclarationView=r,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Af=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];this.matchTNodeWithReadOption(e,t,GA(t,o)),this.matchTNodeWithReadOption(e,t,sc(t,e,o,!1,!1))}else r===Un?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,sc(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===bi||i===xr||i===Un&&t.type&4)this.addMatch(t.index,-2);else{let o=sc(t,e,i,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,r)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function GA(n,e){let t=n.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1]}return null}function WA(n,e){return n.type&11?Ci(n,e):n.type&4?eh(n,e):null}function KA(n,e,t,r){return t===-1?WA(e,n):t===-2?QA(n,e,r):dc(n,n[z],t,e)}function QA(n,e,t){if(t===bi)return Ci(e,n);if(t===Un)return eh(e,n);if(t===xr)return gI(e,n)}function mI(n,e,t,r){let i=e[Bt].queries[r];if(i.matches===null){let o=n.data,s=t.matches,c=[];for(let u=0;s!==null&&u<s.length;u+=2){let l=s[u];if(l<0)c.push(null);else{let h=o[l];c.push(KA(e,h,s[u+1],t.metadata.read))}}i.matches=c}return i.matches}function Nf(n,e,t,r){let i=n.queries.getByIndex(t),o=i.matches;if(o!==null){let s=mI(n,e,i,t);for(let c=0;c<o.length;c+=2){let u=o[c];if(u>0)r.push(s[c/2]);else{let l=o[c+1],h=e[-u];for(let p=nt;p<h.length;p++){let m=h[p];m[Fn]===m[Fe]&&Nf(m[z],m,l,r)}if(h[Tr]!==null){let p=h[Tr];for(let m=0;m<p.length;m++){let E=p[m];Nf(E[z],E,l,r)}}}}}return r}function YA(n,e){return n[Bt].queries[e].queryList}function ZA(n,e,t){let r=new fc((t&4)===4);return ev(n,e,r,r.destroy),(e[Bt]??=new Cf).queries.push(new Df(r))-1}function JA(n,e,t){let r=Ht();return r.firstCreatePass&&(eN(r,new bf(n,e,t),-1),(e&2)===2&&(r.staticViewQueries=!0)),ZA(r,_e(),e)}function XA(n){return n.split(",").map(e=>e.trim())}function eN(n,e,t){n.queries===null&&(n.queries=new Sf),n.queries.track(new Af(e,t))}function ih(n,e){return n.queries.getByIndex(e)}function tN(n,e){let t=n[z],r=ih(t,e);return r.crossesNgTemplate?Nf(t,n,e,[]):mI(t,n,r,e)}var ts=class{};var ns=class extends ts{injector;componentFactoryResolver=new Tf(this);instance=null;constructor(e){super();let t=new mr([...e.providers,{provide:ts,useValue:this},{provide:Dc,useValue:this.componentFactoryResolver}],e.parent||Bo(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function yI(n,e,t=null){return new ns({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var nN=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=kd(!1,t.type),i=r.length>0?yI([r],this._injector,""):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=se({token:n,providedIn:"environment",factory:()=>new n(oe(pt))})}return n})();function ss(n){return yc(()=>{let e=_I(n),t=ge(H({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===kf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(nN).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||At.Emulated,styles:n.styles||ht,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Gf("NgStandalone"),vI(t);let r=n.dependencies;return t.directiveDefs=Xv(r,rN),t.pipeDefs=Xv(r,x_),t.id=sN(t),t})}function rN(n){return vr(n)||bd(n)}function Cc(n){return yc(()=>({type:n.type,bootstrap:n.bootstrap||ht,declarations:n.declarations||ht,imports:n.imports||ht,exports:n.exports||ht,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function iN(n,e){if(n==null)return Er;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,c,u;Array.isArray(i)?(c=i[0],o=i[1],s=i[2]??o,u=i[3]||null):(o=i,s=i,c=Ic.None,u=null),t[o]=[r,c,u],e[o]=s}return t}function oN(n){if(n==null)return Er;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function bc(n){return yc(()=>{let e=_I(n);return vI(e),e})}function _I(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Er,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||ht,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:iN(n.inputs,e),outputs:oN(n.outputs),debugInfo:null}}function vI(n){n.features?.forEach(e=>e(n))}function Xv(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let o=e(i);o!==null&&r.push(o)}return r}:null}function sN(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function aN(n,e,t,r,i,o,s,c){if(t.firstCreatePass){n.mergedAttrs=Pf(n.mergedAttrs,n.attrs);let h=n.tView=jf(2,n,i,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),h.queries=t.queries.embeddedTView(n))}c&&(n.flags|=c),yi(n,!1);let u=uN(t,e,n,r);Xa()&&Kf(t,e,u,n),Ii(u,e);let l=nI(u,e,u,n);e[r+st]=l,$f(e,l),zA(l,n,e)}function cN(n,e,t,r,i,o,s,c,u,l,h){let p=t+st,m;return e.firstCreatePass?(m=th(e,p,4,s||null,c||null),Gd()&&sI(e,n,m,qo(e.consts,l),GE),aE(e,m)):m=e.data[p],aN(m,n,e,t,r,i,o,u),zo(m)&&Yf(e,n,m),l!=null&&qE(n,m,h),m}function Ke(n,e,t,r,i,o,s,c){let u=_e(),l=Ht(),h=qo(l.consts,o);return cN(u,l,n,e,t,r,i,h,void 0,s,c),Ke}var uN=lN;function lN(n,e,t,r){return ec(!0),e[Ve].createComment("")}var oh=new ae("");function Sc(n){return!!n&&typeof n.then=="function"}function sh(n){return!!n&&typeof n.subscribe=="function"}var EI=new ae("");var ah=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=W(EI,{optional:!0})??[];injector=W(On);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=$a(this.injector,i);if(Sc(o))t.push(o);else if(sh(o)){let s=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),II=new ae("");function wI(){Wl(()=>{let n="";throw new ee(600,n)})}function TI(n){return n.isBoundToModule}var dN=10;var Ac=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=W(Ar);afterRenderManager=W(BE);zonelessEnabled=W(Ko);rootEffectScheduler=W(nc);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new an;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=W(_i);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(sd(t=>!t))}constructor(){W(os,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=W(pt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=On.NULL){return this._injector.get(qe).run(()=>{fe(ce.BootstrapComponentStart);let s=t instanceof Tc;if(!this._injector.get(ah).done){let A="";throw new ee(405,A)}let u;s?u=t:u=this._injector.get(Dc).resolveComponentFactory(t),this.componentTypes.push(u.componentType);let l=TI(u)?void 0:this._injector.get(ts),h=r||u.selector,p=u.create(i,[],h,l),m=p.location.nativeElement,E=p.injector.get(oh,null);return E?.registerApplication(m),p.onDestroy(()=>{this.detachView(p.hostView),Zo(this.components,p),E?.unregisterApplication(m)}),this._loadComponent(p),fe(ce.BootstrapComponentEnd,p),p})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){fe(ce.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(qf.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw fe(ce.ChangeDetectionEnd),new ee(101,!1);let t=Q(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Q(t),this.afterTick.next(),fe(ce.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Rr,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<dN;){fe(ce.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{fe(ce.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!Go(i))continue;let o=r&&!this.zonelessEnabled?0:1;JE(i,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Go(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Zo(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(II,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Zo(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ee(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Zo(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var cV=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function he(n,e,t){let r=_e(),i=Yd();if(rh(r,i,e)){let o=Ht(),s=Ev();US(s,r,n,e,r[Ve],t)}return he}function eE(n,e,t,r,i){Zf(e,n,t,i?"class":"style",r)}function O(n,e,t,r){let i=_e(),o=i[z],s=n+st,c=o.firstCreatePass?cI(s,i,2,e,GE,Gd(),t,r):o.data[s];if(WS(c,i,n,e,fN),zo(c)){let u=i[z];Yf(u,i,c),AE(u,c,i)}return r!=null&&qE(i,c),O}function U(){let n=Ht(),e=$t(),t=KS(e);return n.firstCreatePass&&uI(n,t),ov(t)&&sv(),rv(),t.classesWithoutHost!=null&&S0(t)&&eE(n,t,_e(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&A0(t)&&eE(n,t,_e(),t.stylesWithoutHost,!1),U}function we(n,e,t,r){return O(n,e,t,r),U(),we}var fN=(n,e,t,r,i)=>(ec(!0),PE(e[Ve],r,Iv()));function _t(){return _e()}var as="en-US";var hN=as;function DI(n){typeof n=="string"&&(hN=n.toLowerCase().replace(/_/g,"-"))}function Ee(n,e,t){let r=_e(),i=Ht(),o=$t();return pN(i,r,r[Ve],o,n,e,t),Ee}function pN(n,e,t,r,i,o,s){let c=!0,u=null;if((r.type&3||s)&&(u??=uf(r,e,o),AA(r,n,e,s,t,i,o,u)&&(c=!1)),c){let l=r.outputs?.[i],h=r.hostDirectiveOutputs?.[i];if(h&&h.length)for(let p=0;p<h.length;p+=2){let m=h[p],E=h[p+1];u??=uf(r,e,o),Yv(r,e,m,E,i,u)}if(l&&l.length)for(let p of l)u??=uf(r,e,o),Yv(r,e,p,i,i,u)}}function Te(n=1){return vv(n)}function Si(n,e,t){return JA(n,e,t),Si}function Ai(n){let e=_e(),t=Ht(),r=Zd();Ya(r+1);let i=ih(t,r);if(n.dirty&&Y_(e)===((i.metadata.flags&2)===2)){if(i.matches===null)n.reset([]);else{let o=tN(e,r);n.reset(o,H0),n.notifyOnChanges()}return!0}return!1}function Ni(){return YA(_e(),Zd())}function kr(n){let e=uv();return Q_(e,st+n)}function rc(n,e){return n<<17|e<<2}function Mr(n){return n>>17&32767}function gN(n){return(n&2)==2}function mN(n,e){return n&131071|e<<17}function Rf(n){return n|2}function Di(n){return(n&131068)>>2}function df(n,e){return n&-131069|e<<2}function yN(n){return(n&1)===1}function Mf(n){return n|1}function _N(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,c=Mr(s),u=Di(s);n[r]=t;let l=!1,h;if(Array.isArray(t)){let p=t;h=p[1],(h===null||fi(p,h)>0)&&(l=!0)}else h=t;if(i)if(u!==0){let m=Mr(n[c+1]);n[r+1]=rc(m,c),m!==0&&(n[m+1]=df(n[m+1],r)),n[c+1]=mN(n[c+1],r)}else n[r+1]=rc(c,0),c!==0&&(n[c+1]=df(n[c+1],r)),c=r;else n[r+1]=rc(u,0),c===0?c=r:n[u+1]=df(n[u+1],r),u=r;l&&(n[r+1]=Rf(n[r+1])),tE(n,h,r,!0),tE(n,h,r,!1),vN(e,h,n,r,o),s=rc(c,u),o?e.classBindings=s:e.styleBindings=s}function vN(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&fi(o,e)>=0&&(t[r+1]=Mf(t[r+1]))}function tE(n,e,t,r){let i=n[t+1],o=e===null,s=r?Mr(i):Di(i),c=!1;for(;s!==0&&(c===!1||o);){let u=n[s],l=n[s+1];EN(u,e)&&(c=!0,n[s+1]=r?Mf(l):Rf(l)),s=r?Mr(l):Di(l)}c&&(n[t+1]=r?Rf(i):Mf(i))}function EN(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?fi(n,e)>=0:!1}function cs(n,e,t){return CI(n,e,t,!1),cs}function Ri(n,e){return CI(n,e,null,!0),Ri}function CI(n,e,t,r){let i=_e(),o=Ht(),s=dv(2);if(o.firstUpdatePass&&wN(o,n,s,r),e!==jn&&rh(i,s,e)){let c=o.data[Sr()];SN(o,c,i,i[Ve],n,i[s+1]=AN(e,t),r,s)}}function IN(n,e){return e>=n.expandoStartIndex}function wN(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[Sr()],s=IN(n,t);NN(o,r)&&e===null&&!s&&(e=!1),e=TN(i,o,e,r),_N(i,o,e,t,s,r)}}function TN(n,e,t,r){let i=gv(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=ff(null,n,e,t,r),t=rs(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=ff(i,n,e,t,r),o===null){let u=DN(n,e,r);u!==void 0&&Array.isArray(u)&&(u=ff(null,n,e,u[1],r),u=rs(u,e.attrs,r),CN(n,e,r,u))}else o=bN(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function DN(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Di(r)!==0)return n[Mr(r)]}function CN(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Mr(i)]=r}function bN(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=rs(r,s,t)}return rs(r,e.attrs,t)}function ff(n,e,t,r,i){let o=null,s=t.directiveEnd,c=t.directiveStylingLast;for(c===-1?c=t.directiveStart:c++;c<s&&(o=e[c],r=rs(r,o.hostAttrs,i),o!==n);)c++;return n!==null&&(t.directiveStylingLast=c),r}function rs(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),j_(n,s,t?!0:e[++o]))}return n===void 0?null:n}function SN(n,e,t,r,i,o,s,c){if(!(e.type&3))return;let u=n.data,l=u[c+1],h=yN(l)?nE(u,e,t,i,Di(l),s):void 0;if(!mc(h)){mc(o)||gN(l)&&(o=nE(u,null,t,i,c,s));let p=Ud(Sr(),t);OS(r,s,p,i,o)}}function nE(n,e,t,r,i,o){let s=e===null,c;for(;i>0;){let u=n[i],l=Array.isArray(u),h=l?u[1]:u,p=h===null,m=t[i+1];m===jn&&(m=p?ht:void 0);let E=p?Ha(m,r):h===r?m:void 0;if(l&&!mc(E)&&(E=Ha(u,r)),mc(E)&&(c=E,s))return c;let A=n[i+1];i=s?Mr(A):Di(A)}if(e!==null){let u=o?e.residualClasses:e.residualStyles;u!=null&&(c=Ha(u,r))}return c}function mc(n){return n!==void 0}function AN(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Pn(Ff(n)))),n}function NN(n,e){return(n.flags&(e?8:16))!==0}function Ae(n,e=""){let t=_e(),r=Ht(),i=n+st,o=r.firstCreatePass?th(r,i,1,e,null):r.data[i],s=RN(r,t,o,e,n);t[i]=s,Xa()&&Kf(r,t,s,o),yi(o,!1)}var RN=(n,e,t,r,i)=>(ec(!0),X0(e[Ve],r));function MN(n,e,t,r=""){return rh(n,Yd(),t)?e+Ba(t)+r:jn}function Hn(n){return us("",n),Hn}function us(n,e,t){let r=_e(),i=MN(r,n,e,t);return i!==jn&&PN(r,Sr(),i),us}function PN(n,e,t){let r=Ud(e,n);eS(n[Ve],r,t)}var bI=(()=>{class n{applicationErrorHandler=W(Ar);appRef=W(Ac);taskService=W(_i);ngZone=W(qe);zonelessEnabled=W(Ko);tracing=W(os,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new tt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(xo):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(W(of,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?tf:ef;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(xo+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,tf(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ch(){return Gf("NgZoneless"),xd([...uh(),[]])}function uh(){return[{provide:yr,useExisting:bI},{provide:qe,useClass:ko},{provide:Ko,useValue:!0}]}function xN(){return typeof $localize<"u"&&$localize.locale||as}var Nc=new ae("",{factory:()=>W(Nc,{optional:!0,skipSelf:!0})||xN()});var lh=new ae(""),KN=new ae("");function ls(n){return!n.moduleRef}function QN(n){let e=ls(n)?n.r3Injector:n.moduleRef.injector,t=e.get(qe);return t.run(()=>{ls(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(Ar),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),ls(n)){let o=()=>e.destroy(),s=n.platformInjector.get(lh);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(lh);s.add(o),n.moduleRef.onDestroy(()=>{Zo(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return ZN(r,t,()=>{let o=e.get(_i),s=o.add(),c=e.get(ah);return c.runInitializers(),c.donePromise.then(()=>{let u=e.get(Nc,as);if(DI(u||as),!e.get(KN,!0))return ls(n)?e.get(Ac):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(ls(n)){let h=e.get(Ac);return n.rootComponent!==void 0&&h.bootstrap(n.rootComponent),h}else return YN?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void o.remove(s))})})}var YN;function ZN(n,e,t){try{let r=t();return Sc(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var Rc=null;function JN(n=[],e){return On.create({name:e,providers:[{provide:Vo,useValue:"platform"},{provide:lh,useValue:new Set([()=>Rc=null])},...n]})}function XN(n=[]){if(Rc)return Rc;let e=JN(n);return Rc=e,wI(),eR(e),e}function eR(n){let e=n.get(vc,null);$a(n,()=>{e?.forEach(t=>t())})}var dh=class{constructor(){}supports(e){return nh(e)}create(e){return new fh(e)}},tR=(n,e)=>e,fh=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||tR}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<SI(r,i,o)?t:r,c=SI(s,i,o),u=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=c-i,h=u-i;if(l!=h){for(let m=0;m<l;m++){let E=m<o.length?o[m]:o[m]=0,A=E+m;h<=A&&A<l&&(o[m]=E+1)}let p=s.previousIndex;o[p]=h-l}}c!==u&&e(s,c,u)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!nh(e))throw new ee(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let c=0;c<this.length;c++)o=e[c],s=this._trackByFn(c,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,c),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,c)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,lI(e,c=>{s=this._trackByFn(i,c),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,c,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,c,s,i)),Object.is(t.item,c)||this._addIdentityChange(t,c)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new hh(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Mc),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Mc),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},hh=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},ph=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Mc=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new ph,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function SI(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function AI(){return new gh([new dh])}var gh=(()=>{class n{factories;static \u0275prov=se({token:n,providedIn:"root",factory:AI});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=W(n,{optional:!0,skipSelf:!0});return n.create(t,r||AI())}}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new ee(901,!1)}}return n})();function RI(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;fe(ce.BootstrapApplicationStart);try{let o=i?.injector??XN(r),s=[uh(),bv,...t||[]],c=new ns({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return QN({r3Injector:c.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{fe(ce.BootstrapApplicationEnd)}}var MI=null;function fs(){return MI}function mh(n){MI??=n}var ds=class{};var Pc=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},kc=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Pc(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let c=r.get(o);r.move(c,s),PI(c,i)}});for(let i=0,o=r.length;i<o;i++){let c=r.get(i).context;c.index=i,c.count=o,c.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);PI(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Nt(xr),Nt(Un),Nt(gh))};static \u0275dir=bc({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function PI(n,e){n.context.$implicit=e.item}var yh=(()=>{class n{_viewContainer;_context=new xc;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){xI(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){xI(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Nt(xr),Nt(Un))};static \u0275dir=bc({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),xc=class{$implicit=null;ngIf=null};function xI(n,e){if(n&&!n.createEmbeddedView)throw new ee(2020,!1)}var Mi=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Cc({type:n});static \u0275inj=Oo({})}return n})();function _h(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var hs=class{};var kI="browser";var ps=class{_doc;constructor(e){this._doc=e}manager},Oc=(()=>{class n extends ps{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(oe(bt))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),Vc=new ae(""),wh=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(s=>{s.manager=this});let i=t.filter(s=>!(s instanceof Oc));this._plugins=i.slice().reverse();let o=t.find(s=>s instanceof Oc);o&&this._plugins.push(o)}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new ee(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(oe(Vc),oe(qe))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),vh="ng-app-id";function OI(n){for(let e of n)e.remove()}function LI(n,e){let t=e.createElement("style");return t.textContent=n,t}function rR(n,e,t,r){let i=n.head?.querySelectorAll(`style[${vh}="${e}"],link[${vh}="${e}"]`);if(i)for(let o of i)o.removeAttribute(vh),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function Ih(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Th=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,rR(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,LI);r?.forEach(i=>this.addUsage(i,this.external,Ih))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(OI(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])OI(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,LI(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,Ih(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(oe(bt),oe(_c),oe(Ec,8),oe(is))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),Eh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Dh=/%COMP%/g;var VI="%COMP%",iR=`_nghost-${VI}`,oR=`_ngcontent-${VI}`,sR=!0,aR=new ae("",{factory:()=>sR});function cR(n){return oR.replace(Dh,n)}function uR(n){return iR.replace(Dh,n)}function BI(n,e){return e.map(t=>t.replace(Dh,n))}var Ch=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,r,i,o,s,c,u=null,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=c,this.nonce=u,this.tracingService=l,this.defaultRenderer=new gs(t,s,c,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof Fc?i.applyToHost(t):i instanceof ms&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.tracingService;switch(r.encapsulation){case At.Emulated:o=new Fc(u,l,r,this.appId,h,s,c,p);break;case At.ShadowDom:return new Lc(u,t,r,s,c,this.nonce,p,l);case At.ExperimentalIsolatedShadowDom:return new Lc(u,t,r,s,c,this.nonce,p);default:o=new ms(u,l,r,h,s,c,p);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(oe(wh),oe(Th),oe(_c),oe(aR),oe(bt),oe(qe),oe(Ec),oe(os,8))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),gs=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Eh[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(FI(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(FI(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ee(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=Eh[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Eh[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Wt.DashCase|Wt.Important)?e.style.setProperty(t,r,i&Wt.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Wt.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=fs().getGlobalEventTarget(this.doc,e),!e))throw new ee(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function FI(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Lc=class extends gs{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,o,s,c,u){super(e,i,o,c),this.hostEl=t,this.sharedStylesHost=u,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let l=r.styles;l=BI(r.id,l);for(let p of l){let m=document.createElement("style");s&&m.setAttribute("nonce",s),m.textContent=p,this.shadowRoot.appendChild(m)}let h=r.getExternalStyles?.();if(h)for(let p of h){let m=Ih(p,i);s&&m.setAttribute("nonce",s),this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},ms=class extends gs{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,c,u){super(e,o,s,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let l=r.styles;this.styles=u?BI(u,l):l,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&wi.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Fc=class extends ms{contentAttr;hostAttr;constructor(e,t,r,i,o,s,c,u){let l=i+"-"+r.id;super(e,t,r,o,s,c,u,l),this.contentAttr=cR(l),this.hostAttr=uR(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var Bc=class n extends ds{supportsDOMEvents=!0;static makeCurrent(){mh(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=lR();return t==null?null:dR(t)}resetBaseElement(){ys=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return _h(document.cookie,e)}},ys=null;function lR(){return ys=ys||document.head.querySelector("base"),ys?ys.getAttribute("href"):null}function dR(n){return new URL(n,document.baseURI).pathname}var fR=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),UI=["alt","control","meta","shift"],hR={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},pR={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},jI=(()=>{class n extends ps{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),c=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fs().onAndCancel(t,s.domEventName,c,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),s="code."),UI.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let u={};return u.domEventName=i,u.fullKey=s,u}static matchEventFullKeyCode(t,r){let i=hR[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),UI.forEach(s=>{if(s!==i){let c=pR[s];c(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(oe(bt))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})();function bh(n,e,t){let r=H({rootComponent:n,platformRef:t?.platformRef},gR(e));return RI(r)}function gR(n){return{appProviders:[...ER,...n?.providers??[]],platformProviders:vR}}function mR(){Bc.makeCurrent()}function yR(){return new un}function _R(){return Of(document),document}var vR=[{provide:is,useValue:kI},{provide:vc,useValue:mR,multi:!0},{provide:bt,useFactory:_R}];var ER=[{provide:Vo,useValue:"root"},{provide:un,useFactory:yR},{provide:Vc,useClass:Oc,multi:!0},{provide:Vc,useClass:jI,multi:!0},Ch,Th,wh,{provide:Rr,useExisting:Ch},{provide:hs,useClass:fR},[]];var HI=()=>{};var qI=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},IR=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],s=n[t++],c=n[t++],u=((i&7)<<18|(o&63)<<12|(s&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},GI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],s=i+1<n.length,c=s?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,h=o>>2,p=(o&3)<<4|c>>4,m=(c&15)<<2|l>>6,E=l&63;u||(E=64,s||(m=64)),r.push(t[h],t[p],t[m],t[E])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(qI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):IR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||c==null||l==null||p==null)throw new Ah;let m=o<<2|c>>4;if(r.push(m),l!==64){let E=c<<4&240|l>>2;if(r.push(E),p!==64){let A=l<<6&192|p;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ah=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},wR=function(n){let e=qI(n);return GI.encodeByteArray(e,!0)},vs=function(n){return wR(n).replace(/\./g,"")},jc=function(n){try{return GI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function WI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var TR=()=>WI().__FIREBASE_DEFAULTS__,DR=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},CR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&jc(n[1]);return e&&JSON.parse(e)},Hc=()=>{try{return HI()||TR()||DR()||CR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Rh=n=>Hc()?.emulatorHosts?.[n],KI=n=>{let e=Rh(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Mh=()=>Hc()?.config,Ph=n=>Hc()?.[`_${n}`];var Uc=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function $n(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $c(n){return(await fetch(n,{credentials:"include"})).ok}function QI(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=H({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[vs(JSON.stringify(t)),vs(JSON.stringify(s)),""].join(".")}var _s={};function bR(){let n={prod:[],emulator:[]};for(let e of Object.keys(_s))_s[e]?n.emulator.push(e):n.prod.push(e);return n}function SR(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var $I=!1;function zc(n,e){if(typeof window>"u"||typeof document>"u"||!$n(window.location.host)||_s[n]===e||_s[n]||$I)return;_s[n]=e;function t(m){return`__firebase__banner__${m}`}let r="__firebase__banner",o=bR().prod.length>0;function s(){let m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,E){m.setAttribute("width","24"),m.setAttribute("id",E),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){let m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{$I=!0,s()},m}function h(m,E){m.setAttribute("id",E),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){let m=SR(r),E=t("text"),A=document.getElementById(E)||document.createElement("span"),M=t("learnmore"),S=document.getElementById(M)||document.createElement("a"),x=t("preprendIcon"),F=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){let G=m.element;c(G),h(S,M);let be=l();u(F,x),G.append(F,A,S,be),document.body.appendChild(G)}o?(A.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Be(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function YI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Be())}function AR(){let n=Hc()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ZI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function JI(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function XI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ew(){let n=Be();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tw(){return!AR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xh(){try{return typeof indexedDB=="object"}catch{return!1}}function nw(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var NR="FirebaseError",dt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=NR,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dn.prototype.create)}},dn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?RR(o,r):"Error",c=`${this.serviceName}: ${s} (${i}).`;return new dt(i,c,r)}};function RR(n,e){return n.replace(MR,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var MR=/\{\$([^}]+)}/g;function rw(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Qt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],s=e[i];if(zI(o)&&zI(s)){if(!Qt(o,s))return!1}else if(o!==s)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function zI(n){return n!==null&&typeof n=="object"}function Pi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xi(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function ki(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function iw(n,e){let t=new Nh(n,e);return t.subscribe.bind(t)}var Nh=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");PR(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Sh),i.error===void 0&&(i.error=Sh),i.complete===void 0&&(i.complete=Sh);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function PR(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Sh(){}var t6=14400*1e3;function Qe(n){return n&&n._delegate?n._delegate:n}var vt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Or="[DEFAULT]";var kh=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Uc;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kR(e))try{this.getOrInitializeService({instanceIdentifier:Or})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Or){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Or){return this.instances.has(e)}getOptions(e=Or){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,s]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(o);r===c&&s.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xR(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Or){return this.component?this.component.multipleInstances?e:Or:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function xR(n){return n===Or?void 0:n}function kR(n){return n.instantiationMode==="EAGER"}var qc=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new kh(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var OR=[],te=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(te||{}),LR={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},FR=te.INFO,VR={[te.DEBUG]:"log",[te.VERBOSE]:"log",[te.INFO]:"info",[te.WARN]:"warn",[te.ERROR]:"error"},BR=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=VR[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},zn=class{constructor(e){this.name=e,this._logLevel=FR,this._logHandler=BR,this._userLogHandler=null,OR.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in te))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,te.DEBUG,...e),this._logHandler(this,te.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,te.VERBOSE,...e),this._logHandler(this,te.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,te.INFO,...e),this._logHandler(this,te.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,te.WARN,...e),this._logHandler(this,te.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,te.ERROR,...e),this._logHandler(this,te.ERROR,...e)}};var UR=(n,e)=>e.some(t=>n instanceof t),ow,sw;function jR(){return ow||(ow=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HR(){return sw||(sw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var aw=new WeakMap,Lh=new WeakMap,cw=new WeakMap,Oh=new WeakMap,Vh=new WeakMap;function $R(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Yt(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&aw.set(t,n)}).catch(()=>{}),Vh.set(e,n),e}function zR(n){if(Lh.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Lh.set(n,e)}var Fh={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Lh.get(n);if(e==="objectStoreNames")return n.objectStoreNames||cw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Yt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function uw(n){Fh=n(Fh)}function qR(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Gc(this),e,...t);return cw.set(r,e.sort?e.sort():[e]),Yt(r)}:HR().includes(n)?function(...e){return n.apply(Gc(this),e),Yt(aw.get(this))}:function(...e){return Yt(n.apply(Gc(this),e))}}function GR(n){return typeof n=="function"?qR(n):(n instanceof IDBTransaction&&zR(n),UR(n,jR())?new Proxy(n,Fh):n)}function Yt(n){if(n instanceof IDBRequest)return $R(n);if(Oh.has(n))return Oh.get(n);let e=GR(n);return e!==n&&(Oh.set(n,e),Vh.set(e,n)),e}var Gc=n=>Vh.get(n);function dw(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(n,e),c=Yt(s);return r&&s.addEventListener("upgradeneeded",u=>{r(Yt(s.result),u.oldVersion,u.newVersion,Yt(s.transaction),u)}),t&&s.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}var WR=["get","getKey","getAll","getAllKeys","count"],KR=["put","add","delete","clear"],Bh=new Map;function lw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Bh.get(e))return Bh.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=KR.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||WR.includes(t)))return;let o=async function(s,...c){let u=this.transaction(s,i?"readwrite":"readonly"),l=u.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[t](...c),i&&u.done]))[0]};return Bh.set(e,o),o}uw(n=>ge(H({},n),{get:(e,t,r)=>lw(e,t)||n.get(e,t,r),has:(e,t)=>!!lw(e,t)||n.has(e,t)}));var jh=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(QR(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function QR(n){return n.getComponent()?.type==="VERSION"}var Hh="@firebase/app",fw="0.14.6";var fn=new zn("@firebase/app"),YR="@firebase/app-compat",ZR="@firebase/analytics-compat",JR="@firebase/analytics",XR="@firebase/app-check-compat",eM="@firebase/app-check",tM="@firebase/auth",nM="@firebase/auth-compat",rM="@firebase/database",iM="@firebase/data-connect",oM="@firebase/database-compat",sM="@firebase/functions",aM="@firebase/functions-compat",cM="@firebase/installations",uM="@firebase/installations-compat",lM="@firebase/messaging",dM="@firebase/messaging-compat",fM="@firebase/performance",hM="@firebase/performance-compat",pM="@firebase/remote-config",gM="@firebase/remote-config-compat",mM="@firebase/storage",yM="@firebase/storage-compat",_M="@firebase/firestore",vM="@firebase/ai",EM="@firebase/firestore-compat",IM="firebase",wM="12.6.0";var $h="[DEFAULT]",TM={[Hh]:"fire-core",[YR]:"fire-core-compat",[JR]:"fire-analytics",[ZR]:"fire-analytics-compat",[eM]:"fire-app-check",[XR]:"fire-app-check-compat",[tM]:"fire-auth",[nM]:"fire-auth-compat",[rM]:"fire-rtdb",[iM]:"fire-data-connect",[oM]:"fire-rtdb-compat",[sM]:"fire-fn",[aM]:"fire-fn-compat",[cM]:"fire-iid",[uM]:"fire-iid-compat",[lM]:"fire-fcm",[dM]:"fire-fcm-compat",[fM]:"fire-perf",[hM]:"fire-perf-compat",[pM]:"fire-rc",[gM]:"fire-rc-compat",[mM]:"fire-gcs",[yM]:"fire-gcs-compat",[_M]:"fire-fst",[EM]:"fire-fst-compat",[vM]:"fire-vertex","fire-js":"fire-js",[IM]:"fire-js-all"};var Wc=new Map,DM=new Map,zh=new Map;function hw(n,e){try{n.container.addComponent(e)}catch(t){fn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Gn(n){let e=n.name;if(zh.has(e))return fn.debug(`There were multiple attempts to register component ${e}.`),!1;zh.set(e,n);for(let t of Wc.values())hw(t,n);for(let t of DM.values())hw(t,n);return!0}function Is(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function rt(n){return n==null?!1:n.settings!==void 0}var CM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qn=new dn("app","Firebase",CM);var qh=class{constructor(e,t,r){this._isDeleted=!1,this._options=H({},e),this._config=H({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qn.create("app-deleted",{appName:this._name})}};var Wn=wM;function Kh(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=H({name:$h,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw qn.create("bad-app-name",{appName:String(i)});if(t||(t=Mh()),!t)throw qn.create("no-options");let o=Wc.get(i);if(o){if(Qt(t,o.options)&&Qt(r,o.config))return o;throw qn.create("duplicate-app",{appName:i})}let s=new qc(i);for(let u of zh.values())s.addComponent(u);let c=new qh(t,r,s);return Wc.set(i,c),c}function Kc(n=$h){let e=Wc.get(n);if(!e&&n===$h&&Mh())return Kh();if(!e)throw qn.create("no-app",{appName:n});return e}function Rt(n,e,t){let r=TM[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){let s=[`Unable to register library "${r}" with version "${e}":`];i&&s.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fn.warn(s.join(" "));return}Gn(new vt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var bM="firebase-heartbeat-database",SM=1,Es="firebase-heartbeat-store",Uh=null;function yw(){return Uh||(Uh=dw(bM,SM,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Es)}catch(t){console.warn(t)}}}}).catch(n=>{throw qn.create("idb-open",{originalErrorMessage:n.message})})),Uh}async function AM(n){try{let t=(await yw()).transaction(Es),r=await t.objectStore(Es).get(_w(n));return await t.done,r}catch(e){if(e instanceof dt)fn.warn(e.message);else{let t=qn.create("idb-get",{originalErrorMessage:e?.message});fn.warn(t.message)}}}async function pw(n,e){try{let r=(await yw()).transaction(Es,"readwrite");await r.objectStore(Es).put(e,_w(n)),await r.done}catch(t){if(t instanceof dt)fn.warn(t.message);else{let r=qn.create("idb-set",{originalErrorMessage:t?.message});fn.warn(r.message)}}}function _w(n){return`${n.name}!${n.options.appId}`}var NM=1024,RM=30,Gh=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Wh(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=gw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>RM){let i=PM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=gw(),{heartbeatsToSend:t,unsentEntries:r}=MM(this._heartbeatsCache.heartbeats),i=vs(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return fn.warn(e),""}}};function gw(){return new Date().toISOString().substring(0,10)}function MM(n,e=NM){let t=[],r=n.slice();for(let i of n){let o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),mw(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),mw(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Wh=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xh()?nw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await AM(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return pw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return pw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function mw(n){return vs(JSON.stringify({version:2,heartbeats:n})).length}function PM(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function xM(n){Gn(new vt("platform-logger",e=>new jh(e),"PRIVATE")),Gn(new vt("heartbeat",e=>new Gh(e),"PRIVATE")),Rt(Hh,fw,n),Rt(Hh,fw,"esm2020"),Rt("fire-js","")}xM("");var kM="firebase",OM="12.7.0";Rt(kM,OM,"app");var vw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ew={};var hn,Qh;(function(){var n;function e(T,y){function _(){}_.prototype=y.prototype,T.F=y.prototype,T.prototype=new _,T.prototype.constructor=T,T.D=function(w,I,C){for(var v=Array(arguments.length-2),it=2;it<arguments.length;it++)v[it-2]=arguments[it];return y.prototype[I].apply(w,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,y,_){_||(_=0);let w=Array(16);if(typeof y=="string")for(var I=0;I<16;++I)w[I]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(I=0;I<16;++I)w[I]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=T.g[0],_=T.g[1],I=T.g[2];let C=T.g[3],v;v=y+(C^_&(I^C))+w[0]+3614090360&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(I^y&(_^I))+w[1]+3905402710&4294967295,C=y+(v<<12&4294967295|v>>>20),v=I+(_^C&(y^_))+w[2]+606105819&4294967295,I=C+(v<<17&4294967295|v>>>15),v=_+(y^I&(C^y))+w[3]+3250441966&4294967295,_=I+(v<<22&4294967295|v>>>10),v=y+(C^_&(I^C))+w[4]+4118548399&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(I^y&(_^I))+w[5]+1200080426&4294967295,C=y+(v<<12&4294967295|v>>>20),v=I+(_^C&(y^_))+w[6]+2821735955&4294967295,I=C+(v<<17&4294967295|v>>>15),v=_+(y^I&(C^y))+w[7]+4249261313&4294967295,_=I+(v<<22&4294967295|v>>>10),v=y+(C^_&(I^C))+w[8]+1770035416&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(I^y&(_^I))+w[9]+2336552879&4294967295,C=y+(v<<12&4294967295|v>>>20),v=I+(_^C&(y^_))+w[10]+4294925233&4294967295,I=C+(v<<17&4294967295|v>>>15),v=_+(y^I&(C^y))+w[11]+2304563134&4294967295,_=I+(v<<22&4294967295|v>>>10),v=y+(C^_&(I^C))+w[12]+1804603682&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(I^y&(_^I))+w[13]+4254626195&4294967295,C=y+(v<<12&4294967295|v>>>20),v=I+(_^C&(y^_))+w[14]+2792965006&4294967295,I=C+(v<<17&4294967295|v>>>15),v=_+(y^I&(C^y))+w[15]+1236535329&4294967295,_=I+(v<<22&4294967295|v>>>10),v=y+(I^C&(_^I))+w[1]+4129170786&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^I&(y^_))+w[6]+3225465664&4294967295,C=y+(v<<9&4294967295|v>>>23),v=I+(y^_&(C^y))+w[11]+643717713&4294967295,I=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(I^C))+w[0]+3921069994&4294967295,_=I+(v<<20&4294967295|v>>>12),v=y+(I^C&(_^I))+w[5]+3593408605&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^I&(y^_))+w[10]+38016083&4294967295,C=y+(v<<9&4294967295|v>>>23),v=I+(y^_&(C^y))+w[15]+3634488961&4294967295,I=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(I^C))+w[4]+3889429448&4294967295,_=I+(v<<20&4294967295|v>>>12),v=y+(I^C&(_^I))+w[9]+568446438&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^I&(y^_))+w[14]+3275163606&4294967295,C=y+(v<<9&4294967295|v>>>23),v=I+(y^_&(C^y))+w[3]+4107603335&4294967295,I=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(I^C))+w[8]+1163531501&4294967295,_=I+(v<<20&4294967295|v>>>12),v=y+(I^C&(_^I))+w[13]+2850285829&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^I&(y^_))+w[2]+4243563512&4294967295,C=y+(v<<9&4294967295|v>>>23),v=I+(y^_&(C^y))+w[7]+1735328473&4294967295,I=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(I^C))+w[12]+2368359562&4294967295,_=I+(v<<20&4294967295|v>>>12),v=y+(_^I^C)+w[5]+4294588738&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^I)+w[8]+2272392833&4294967295,C=y+(v<<11&4294967295|v>>>21),v=I+(C^y^_)+w[11]+1839030562&4294967295,I=C+(v<<16&4294967295|v>>>16),v=_+(I^C^y)+w[14]+4259657740&4294967295,_=I+(v<<23&4294967295|v>>>9),v=y+(_^I^C)+w[1]+2763975236&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^I)+w[4]+1272893353&4294967295,C=y+(v<<11&4294967295|v>>>21),v=I+(C^y^_)+w[7]+4139469664&4294967295,I=C+(v<<16&4294967295|v>>>16),v=_+(I^C^y)+w[10]+3200236656&4294967295,_=I+(v<<23&4294967295|v>>>9),v=y+(_^I^C)+w[13]+681279174&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^I)+w[0]+3936430074&4294967295,C=y+(v<<11&4294967295|v>>>21),v=I+(C^y^_)+w[3]+3572445317&4294967295,I=C+(v<<16&4294967295|v>>>16),v=_+(I^C^y)+w[6]+76029189&4294967295,_=I+(v<<23&4294967295|v>>>9),v=y+(_^I^C)+w[9]+3654602809&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^I)+w[12]+3873151461&4294967295,C=y+(v<<11&4294967295|v>>>21),v=I+(C^y^_)+w[15]+530742520&4294967295,I=C+(v<<16&4294967295|v>>>16),v=_+(I^C^y)+w[2]+3299628645&4294967295,_=I+(v<<23&4294967295|v>>>9),v=y+(I^(_|~C))+w[0]+4096336452&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~I))+w[7]+1126891415&4294967295,C=y+(v<<10&4294967295|v>>>22),v=I+(y^(C|~_))+w[14]+2878612391&4294967295,I=C+(v<<15&4294967295|v>>>17),v=_+(C^(I|~y))+w[5]+4237533241&4294967295,_=I+(v<<21&4294967295|v>>>11),v=y+(I^(_|~C))+w[12]+1700485571&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~I))+w[3]+2399980690&4294967295,C=y+(v<<10&4294967295|v>>>22),v=I+(y^(C|~_))+w[10]+4293915773&4294967295,I=C+(v<<15&4294967295|v>>>17),v=_+(C^(I|~y))+w[1]+2240044497&4294967295,_=I+(v<<21&4294967295|v>>>11),v=y+(I^(_|~C))+w[8]+1873313359&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~I))+w[15]+4264355552&4294967295,C=y+(v<<10&4294967295|v>>>22),v=I+(y^(C|~_))+w[6]+2734768916&4294967295,I=C+(v<<15&4294967295|v>>>17),v=_+(C^(I|~y))+w[13]+1309151649&4294967295,_=I+(v<<21&4294967295|v>>>11),v=y+(I^(_|~C))+w[4]+4149444226&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~I))+w[11]+3174756917&4294967295,C=y+(v<<10&4294967295|v>>>22),v=I+(y^(C|~_))+w[2]+718787259&4294967295,I=C+(v<<15&4294967295|v>>>17),v=_+(C^(I|~y))+w[9]+3951481745&4294967295,T.g[0]=T.g[0]+y&4294967295,T.g[1]=T.g[1]+(I+(v<<21&4294967295|v>>>11))&4294967295,T.g[2]=T.g[2]+I&4294967295,T.g[3]=T.g[3]+C&4294967295}r.prototype.v=function(T,y){y===void 0&&(y=T.length);let _=y-this.blockSize,w=this.C,I=this.h,C=0;for(;C<y;){if(I==0)for(;C<=_;)i(this,T,C),C+=this.blockSize;if(typeof T=="string"){for(;C<y;)if(w[I++]=T.charCodeAt(C++),I==this.blockSize){i(this,w),I=0;break}}else for(;C<y;)if(w[I++]=T[C++],I==this.blockSize){i(this,w),I=0;break}}this.h=I,this.o+=y},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var y=1;y<T.length-8;++y)T[y]=0;y=this.o*8;for(var _=T.length-8;_<T.length;++_)T[_]=y&255,y/=256;for(this.v(T),T=Array(16),y=0,_=0;_<4;++_)for(let w=0;w<32;w+=8)T[y++]=this.g[_]>>>w&255;return T};function o(T,y){var _=c;return Object.prototype.hasOwnProperty.call(_,T)?_[T]:_[T]=y(T)}function s(T,y){this.h=y;let _=[],w=!0;for(let I=T.length-1;I>=0;I--){let C=T[I]|0;w&&C==y||(_[I]=C,w=!1)}this.g=_}var c={};function u(T){return-128<=T&&T<128?o(T,function(y){return new s([y|0],y<0?-1:0)}):new s([T|0],T<0?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return p;if(T<0)return S(l(-T));let y=[],_=1;for(let w=0;T>=_;w++)y[w]=T/_|0,_*=4294967296;return new s(y,0)}function h(T,y){if(T.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(T.charAt(0)=="-")return S(h(T.substring(1),y));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');let _=l(Math.pow(y,8)),w=p;for(let C=0;C<T.length;C+=8){var I=Math.min(8,T.length-C);let v=parseInt(T.substring(C,C+I),y);I<8?(I=l(Math.pow(y,I)),w=w.j(I).add(l(v))):(w=w.j(_),w=w.add(l(v)))}return w}var p=u(0),m=u(1),E=u(16777216);n=s.prototype,n.m=function(){if(M(this))return-S(this).m();let T=0,y=1;for(let _=0;_<this.g.length;_++){let w=this.i(_);T+=(w>=0?w:4294967296+w)*y,y*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(A(this))return"0";if(M(this))return"-"+S(this).toString(T);let y=l(Math.pow(T,6));var _=this;let w="";for(;;){let I=be(_,y).g;_=x(_,I.j(y));let C=((_.g.length>0?_.g[0]:_.h)>>>0).toString(T);if(_=I,A(_))return C+w;for(;C.length<6;)C="0"+C;w=C+w}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function A(T){if(T.h!=0)return!1;for(let y=0;y<T.g.length;y++)if(T.g[y]!=0)return!1;return!0}function M(T){return T.h==-1}n.l=function(T){return T=x(this,T),M(T)?-1:A(T)?0:1};function S(T){let y=T.g.length,_=[];for(let w=0;w<y;w++)_[w]=~T.g[w];return new s(_,~T.h).add(m)}n.abs=function(){return M(this)?S(this):this},n.add=function(T){let y=Math.max(this.g.length,T.g.length),_=[],w=0;for(let I=0;I<=y;I++){let C=w+(this.i(I)&65535)+(T.i(I)&65535),v=(C>>>16)+(this.i(I)>>>16)+(T.i(I)>>>16);w=v>>>16,C&=65535,v&=65535,_[I]=v<<16|C}return new s(_,_[_.length-1]&-2147483648?-1:0)};function x(T,y){return T.add(S(y))}n.j=function(T){if(A(this)||A(T))return p;if(M(this))return M(T)?S(this).j(S(T)):S(S(this).j(T));if(M(T))return S(this.j(S(T)));if(this.l(E)<0&&T.l(E)<0)return l(this.m()*T.m());let y=this.g.length+T.g.length,_=[];for(var w=0;w<2*y;w++)_[w]=0;for(w=0;w<this.g.length;w++)for(let I=0;I<T.g.length;I++){let C=this.i(w)>>>16,v=this.i(w)&65535,it=T.i(I)>>>16,Cn=T.i(I)&65535;_[2*w+2*I]+=v*Cn,F(_,2*w+2*I),_[2*w+2*I+1]+=C*Cn,F(_,2*w+2*I+1),_[2*w+2*I+1]+=v*it,F(_,2*w+2*I+1),_[2*w+2*I+2]+=C*it,F(_,2*w+2*I+2)}for(T=0;T<y;T++)_[T]=_[2*T+1]<<16|_[2*T];for(T=y;T<2*y;T++)_[T]=0;return new s(_,0)};function F(T,y){for(;(T[y]&65535)!=T[y];)T[y+1]+=T[y]>>>16,T[y]&=65535,y++}function G(T,y){this.g=T,this.h=y}function be(T,y){if(A(y))throw Error("division by zero");if(A(T))return new G(p,p);if(M(T))return y=be(S(T),y),new G(S(y.g),S(y.h));if(M(y))return y=be(T,S(y)),new G(S(y.g),y.h);if(T.g.length>30){if(M(T)||M(y))throw Error("slowDivide_ only works with positive integers.");for(var _=m,w=y;w.l(T)<=0;)_=xe(_),w=xe(w);var I=Se(_,1),C=Se(w,1);for(w=Se(w,2),_=Se(_,2);!A(w);){var v=C.add(w);v.l(T)<=0&&(I=I.add(_),C=v),w=Se(w,1),_=Se(_,1)}return y=x(T,I.j(y)),new G(I,y)}for(I=p;T.l(y)>=0;){for(_=Math.max(1,Math.floor(T.m()/y.m())),w=Math.ceil(Math.log(_)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),C=l(_),v=C.j(y);M(v)||v.l(T)>0;)_-=w,C=l(_),v=C.j(y);A(C)&&(C=m),I=I.add(C),T=x(T,v)}return new G(I,T)}n.B=function(T){return be(this,T).h},n.and=function(T){let y=Math.max(this.g.length,T.g.length),_=[];for(let w=0;w<y;w++)_[w]=this.i(w)&T.i(w);return new s(_,this.h&T.h)},n.or=function(T){let y=Math.max(this.g.length,T.g.length),_=[];for(let w=0;w<y;w++)_[w]=this.i(w)|T.i(w);return new s(_,this.h|T.h)},n.xor=function(T){let y=Math.max(this.g.length,T.g.length),_=[];for(let w=0;w<y;w++)_[w]=this.i(w)^T.i(w);return new s(_,this.h^T.h)};function xe(T){let y=T.g.length+1,_=[];for(let w=0;w<y;w++)_[w]=T.i(w)<<1|T.i(w-1)>>>31;return new s(_,T.h)}function Se(T,y){let _=y>>5;y%=32;let w=T.g.length-_,I=[];for(let C=0;C<w;C++)I[C]=y>0?T.i(C+_)>>>y|T.i(C+_+1)<<32-y:T.i(C+_);return new s(I,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Qh=Ew.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,hn=Ew.Integer=s}).apply(typeof vw<"u"?vw:typeof self<"u"?self:typeof window<"u"?window:{});var Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pn={};var Yh,LM,Oi,Zh,ws,Yc,Jh,Xh,ep;(function(){var n,e=Object.defineProperty;function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qc=="object"&&Qc];for(var d=0;d<a.length;++d){var f=a[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(a,d){if(d)e:{var f=r;a=a.split(".");for(var g=0;g<a.length-1;g++){var D=a[g];if(!(D in f))break e;f=f[D]}a=a[a.length-1],g=f[a],d=d(g),d!=g&&d!=null&&e(f,a,{configurable:!0,writable:!0,value:d})}}i("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(a){return a||function(d){var f=[],g;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&f.push([g,d[g]]);return f}});var o=o||{},s=this||self;function c(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function u(a,d,f){return a.call.apply(a.bind,arguments)}function l(a,d,f){return l=u,l.apply(null,arguments)}function h(a,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),a.apply(this,g)}}function p(a,d){function f(){}f.prototype=d.prototype,a.Z=d.prototype,a.prototype=new f,a.prototype.constructor=a,a.Ob=function(g,D,b){for(var P=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)P[Y-2]=arguments[Y];return d.prototype[D].apply(g,P)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function E(a){let d=a.length;if(d>0){let f=Array(d);for(let g=0;g<d;g++)f[g]=a[g];return f}return[]}function A(a,d){for(let g=1;g<arguments.length;g++){let D=arguments[g];var f=typeof D;if(f=f!="object"?f:D?Array.isArray(D)?"array":f:"null",f=="array"||f=="object"&&typeof D.length=="number"){f=a.length||0;let b=D.length||0;a.length=f+b;for(let P=0;P<b;P++)a[f+P]=D[P]}else a.push(D)}}class M{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return this.h>0?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function S(a){s.setTimeout(()=>{throw a},0)}function x(){var a=T;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class F{constructor(){this.h=this.g=null}add(d,f){let g=G.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var G=new M(()=>new be,a=>a.reset());class be{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,Se=!1,T=new F,y=()=>{let a=Promise.resolve(void 0);xe=()=>{a.then(_)}};function _(){for(var a;a=x();){try{a.h.call(a.g)}catch(f){S(f)}var d=G;d.j(a),d.h<100&&(d.h++,a.next=d.g,d.g=a)}Se=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var C=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let f=()=>{};s.addEventListener("test",f,d),s.removeEventListener("test",f,d)}catch{}return a})();function v(a){return/^[\s\xa0]*$/.test(a)}function it(a,d){I.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,d)}p(it,I),it.prototype.init=function(a,d){let f=this.type=a.type,g=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget,d||(f=="mouseover"?d=a.fromElement:f=="mouseout"&&(d=a.toElement)),this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&it.Z.h.call(this)},it.prototype.h=function(){it.Z.h.call(this);let a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Cn="closure_listenable_"+(Math.random()*1e6|0),FC=0;function VC(a,d,f,g,D){this.listener=a,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=D,this.key=++FC,this.da=this.fa=!1}function Xs(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ea(a,d,f){for(let g in a)d.call(f,a[g],g,a)}function BC(a,d){for(let f in a)d.call(void 0,a[f],f,a)}function Ym(a){let d={};for(let f in a)d[f]=a[f];return d}let Zm="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Jm(a,d){let f,g;for(let D=1;D<arguments.length;D++){g=arguments[D];for(f in g)a[f]=g[f];for(let b=0;b<Zm.length;b++)f=Zm[b],Object.prototype.hasOwnProperty.call(g,f)&&(a[f]=g[f])}}function ta(a){this.src=a,this.g={},this.h=0}ta.prototype.add=function(a,d,f,g,D){let b=a.toString();a=this.g[b],a||(a=this.g[b]=[],this.h++);let P=_l(a,d,g,D);return P>-1?(d=a[P],f||(d.fa=!1)):(d=new VC(d,this.src,b,!!g,D),d.fa=f,a.push(d)),d};function yl(a,d){let f=d.type;if(f in a.g){var g=a.g[f],D=Array.prototype.indexOf.call(g,d,void 0),b;(b=D>=0)&&Array.prototype.splice.call(g,D,1),b&&(Xs(d),a.g[f].length==0&&(delete a.g[f],a.h--))}}function _l(a,d,f,g){for(let D=0;D<a.length;++D){let b=a[D];if(!b.da&&b.listener==d&&b.capture==!!f&&b.ha==g)return D}return-1}var vl="closure_lm_"+(Math.random()*1e6|0),El={};function Xm(a,d,f,g,D){if(g&&g.once)return ty(a,d,f,g,D);if(Array.isArray(d)){for(let b=0;b<d.length;b++)Xm(a,d[b],f,g,D);return null}return f=Dl(f),a&&a[Cn]?a.J(d,f,c(g)?!!g.capture:!!g,D):ey(a,d,f,!1,g,D)}function ey(a,d,f,g,D,b){if(!d)throw Error("Invalid event type");let P=c(D)?!!D.capture:!!D,Y=wl(a);if(Y||(a[vl]=Y=new ta(a)),f=Y.add(d,f,g,P,b),f.proxy)return f;if(g=UC(),f.proxy=g,g.src=a,g.listener=f,a.addEventListener)C||(D=P),D===void 0&&(D=!1),a.addEventListener(d.toString(),g,D);else if(a.attachEvent)a.attachEvent(ry(d.toString()),g);else if(a.addListener&&a.removeListener)a.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function UC(){function a(f){return d.call(a.src,a.listener,f)}let d=jC;return a}function ty(a,d,f,g,D){if(Array.isArray(d)){for(let b=0;b<d.length;b++)ty(a,d[b],f,g,D);return null}return f=Dl(f),a&&a[Cn]?a.K(d,f,c(g)?!!g.capture:!!g,D):ey(a,d,f,!0,g,D)}function ny(a,d,f,g,D){if(Array.isArray(d))for(var b=0;b<d.length;b++)ny(a,d[b],f,g,D);else g=c(g)?!!g.capture:!!g,f=Dl(f),a&&a[Cn]?(a=a.i,b=String(d).toString(),b in a.g&&(d=a.g[b],f=_l(d,f,g,D),f>-1&&(Xs(d[f]),Array.prototype.splice.call(d,f,1),d.length==0&&(delete a.g[b],a.h--)))):a&&(a=wl(a))&&(d=a.g[d.toString()],a=-1,d&&(a=_l(d,f,g,D)),(f=a>-1?d[a]:null)&&Il(f))}function Il(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[Cn])yl(d.i,a);else{var f=a.type,g=a.proxy;d.removeEventListener?d.removeEventListener(f,g,a.capture):d.detachEvent?d.detachEvent(ry(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=wl(d))?(yl(f,a),f.h==0&&(f.src=null,d[vl]=null)):Xs(a)}}}function ry(a){return a in El?El[a]:El[a]="on"+a}function jC(a,d){if(a.da)a=!0;else{d=new it(d,this);let f=a.listener,g=a.ha||a.src;a.fa&&Il(a),a=f.call(g,d)}return a}function wl(a){return a=a[vl],a instanceof ta?a:null}var Tl="__closure_events_fn_"+(Math.random()*1e9>>>0);function Dl(a){return typeof a=="function"?a:(a[Tl]||(a[Tl]=function(d){return a.handleEvent(d)}),a[Tl])}function He(){w.call(this),this.i=new ta(this),this.M=this,this.G=null}p(He,w),He.prototype[Cn]=!0,He.prototype.removeEventListener=function(a,d,f,g){ny(this,a,d,f,g)};function Xe(a,d){var f,g=a.G;if(g)for(f=[];g;g=g.G)f.push(g);if(a=a.M,g=d.type||d,typeof d=="string")d=new I(d,a);else if(d instanceof I)d.target=d.target||a;else{var D=d;d=new I(g,a),Jm(d,D)}D=!0;let b,P;if(f)for(P=f.length-1;P>=0;P--)b=d.g=f[P],D=na(b,g,!0,d)&&D;if(b=d.g=a,D=na(b,g,!0,d)&&D,D=na(b,g,!1,d)&&D,f)for(P=0;P<f.length;P++)b=d.g=f[P],D=na(b,g,!1,d)&&D}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var a=this.i;for(let d in a.g){let f=a.g[d];for(let g=0;g<f.length;g++)Xs(f[g]);delete a.g[d],a.h--}}this.G=null},He.prototype.J=function(a,d,f,g){return this.i.add(String(a),d,!1,f,g)},He.prototype.K=function(a,d,f,g){return this.i.add(String(a),d,!0,f,g)};function na(a,d,f,g){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();let D=!0;for(let b=0;b<d.length;++b){let P=d[b];if(P&&!P.da&&P.capture==f){let Y=P.listener,ke=P.ha||P.src;P.fa&&yl(a.i,P),D=Y.call(ke,g)!==!1&&D}}return D&&!g.defaultPrevented}function HC(a,d){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=l(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(d)>2147483647?-1:s.setTimeout(a,d||0)}function iy(a){a.g=HC(()=>{a.g=null,a.i&&(a.i=!1,iy(a))},a.l);let d=a.h;a.h=null,a.m.apply(null,d)}class $C extends w{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:iy(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lo(a){w.call(this),this.h=a,this.g={}}p(lo,w);var oy=[];function sy(a){ea(a.g,function(d,f){this.g.hasOwnProperty(f)&&Il(d)},a),a.g={}}lo.prototype.N=function(){lo.Z.N.call(this),sy(this)},lo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cl=s.JSON.stringify,zC=s.JSON.parse,qC=class{stringify(a){return s.JSON.stringify(a,void 0)}parse(a){return s.JSON.parse(a,void 0)}};function ay(){}function cy(){}var fo={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function bl(){I.call(this,"d")}p(bl,I);function Sl(){I.call(this,"c")}p(Sl,I);var ar={},uy=null;function ra(){return uy=uy||new He}ar.Ia="serverreachability";function ly(a){I.call(this,ar.Ia,a)}p(ly,I);function ho(a){let d=ra();Xe(d,new ly(d))}ar.STAT_EVENT="statevent";function dy(a,d){I.call(this,ar.STAT_EVENT,a),this.stat=d}p(dy,I);function et(a){let d=ra();Xe(d,new dy(d,a))}ar.Ja="timingevent";function fy(a,d){I.call(this,ar.Ja,a),this.size=d}p(fy,I);function po(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){a()},d)}function go(){this.g=!0}go.prototype.ua=function(){this.g=!1};function GC(a,d,f,g,D,b){a.info(function(){if(a.g)if(b){var P="",Y=b.split("&");for(let pe=0;pe<Y.length;pe++){var ke=Y[pe].split("=");if(ke.length>1){let Le=ke[0];ke=ke[1];let Ot=Le.split("_");P=Ot.length>=2&&Ot[1]=="type"?P+(Le+"="+ke+"&"):P+(Le+"=redacted&")}}}else P=null;else P=b;return"XMLHTTP REQ ("+g+") [attempt "+D+"]: "+d+`
`+f+`
`+P})}function WC(a,d,f,g,D,b,P){a.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+D+"]: "+d+`
`+f+`
`+b+" "+P})}function ei(a,d,f,g){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+QC(a,f)+(g?" "+g:"")})}function KC(a,d){a.info(function(){return"TIMEOUT: "+d})}go.prototype.info=function(){};function QC(a,d){if(!a.g)return d;if(!d)return null;try{let b=JSON.parse(d);if(b){for(a=0;a<b.length;a++)if(Array.isArray(b[a])){var f=b[a];if(!(f.length<2)){var g=f[1];if(Array.isArray(g)&&!(g.length<1)){var D=g[0];if(D!="noop"&&D!="stop"&&D!="close")for(let P=1;P<g.length;P++)g[P]=""}}}}return Cl(b)}catch{return d}}var ia={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},hy={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},py;function Al(){}p(Al,ay),Al.prototype.g=function(){return new XMLHttpRequest},py=new Al;function mo(a){return encodeURIComponent(String(a))}function YC(a){var d=1;a=a.split(":");let f=[];for(;d>0&&a.length;)f.push(a.shift()),d--;return a.length&&f.push(a.join(":")),f}function bn(a,d,f,g){this.j=a,this.i=d,this.l=f,this.S=g||1,this.V=new lo(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gy}function gy(){this.i=null,this.g="",this.h=!1}var my={},Nl={};function Rl(a,d,f){a.M=1,a.A=sa(kt(d)),a.u=f,a.R=!0,yy(a,null)}function yy(a,d){a.F=Date.now(),oa(a),a.B=kt(a.A);var f=a.B,g=a.S;Array.isArray(g)||(g=[String(g)]),Ry(f.i,"t",g),a.C=0,f=a.j.L,a.h=new gy,a.g=Ky(a.j,f?d:null,!a.u),a.P>0&&(a.O=new $C(l(a.Y,a,a.g),a.P)),d=a.V,f=a.g,g=a.ba;var D="readystatechange";Array.isArray(D)||(D&&(oy[0]=D.toString()),D=oy);for(let b=0;b<D.length;b++){let P=Xm(f,D[b],g||d.handleEvent,!1,d.h||d);if(!P)break;d.g[P.key]=P}d=a.J?Ym(a.J):{},a.u?(a.v||(a.v="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,d)):(a.v="GET",a.g.ea(a.B,a.v,null,d)),ho(),GC(a.i,a.v,a.B,a.l,a.S,a.u)}bn.prototype.ba=function(a){a=a.target;let d=this.O;d&&Nn(a)==3?d.j():this.Y(a)},bn.prototype.Y=function(a){try{if(a==this.g)e:{let Y=Nn(this.g),ke=this.g.ya(),pe=this.g.ca();if(!(Y<3)&&(Y!=3||this.g&&(this.h.h||this.g.la()||Fy(this.g)))){this.K||Y!=4||ke==7||(ke==8||pe<=0?ho(3):ho(2)),Ml(this);var d=this.g.ca();this.X=d;var f=ZC(this);if(this.o=d==200,WC(this.i,this.v,this.B,this.l,this.S,Y,d),this.o){if(this.U&&!this.L){t:{if(this.g){var g,D=this.g;if((g=D.g?D.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(g)){var b=g;break t}}b=null}if(a=b)ei(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Pl(this,a);else{this.o=!1,this.m=3,et(12),cr(this),yo(this);break e}}if(this.R){a=!0;let Le;for(;!this.K&&this.C<f.length;)if(Le=JC(this,f),Le==Nl){Y==4&&(this.m=4,et(14),a=!1),ei(this.i,this.l,null,"[Incomplete Response]");break}else if(Le==my){this.m=4,et(15),ei(this.i,this.l,f,"[Invalid Chunk]"),a=!1;break}else ei(this.i,this.l,Le,null),Pl(this,Le);if(_y(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Y!=4||f.length!=0||this.h.h||(this.m=1,et(16),a=!1),this.o=this.o&&a,!a)ei(this.i,this.l,f,"[Invalid Chunked Response]"),cr(this),yo(this);else if(f.length>0&&!this.W){this.W=!0;var P=this.j;P.g==this&&P.aa&&!P.P&&(P.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),Bl(P),P.P=!0,et(11))}}else ei(this.i,this.l,f,null),Pl(this,f);Y==4&&cr(this),this.o&&!this.K&&(Y==4?zy(this.j,this):(this.o=!1,oa(this)))}else fb(this.g),d==400&&f.indexOf("Unknown SID")>0?(this.m=3,et(12)):(this.m=0,et(13)),cr(this),yo(this)}}}catch{}finally{}};function ZC(a){if(!_y(a))return a.g.la();let d=Fy(a.g);if(d==="")return"";let f="",g=d.length,D=Nn(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return cr(a),yo(a),"";a.h.i=new s.TextDecoder}for(let b=0;b<g;b++)a.h.h=!0,f+=a.h.i.decode(d[b],{stream:!(D&&b==g-1)});return d.length=0,a.h.g+=f,a.C=0,a.h.g}function _y(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function JC(a,d){var f=a.C,g=d.indexOf(`
`,f);return g==-1?Nl:(f=Number(d.substring(f,g)),isNaN(f)?my:(g+=1,g+f>d.length?Nl:(d=d.slice(g,g+f),a.C=g+f,d)))}bn.prototype.cancel=function(){this.K=!0,cr(this)};function oa(a){a.T=Date.now()+a.H,vy(a,a.H)}function vy(a,d){if(a.D!=null)throw Error("WatchDog timer not null");a.D=po(l(a.aa,a),d)}function Ml(a){a.D&&(s.clearTimeout(a.D),a.D=null)}bn.prototype.aa=function(){this.D=null;let a=Date.now();a-this.T>=0?(KC(this.i,this.B),this.M!=2&&(ho(),et(17)),cr(this),this.m=2,yo(this)):vy(this,this.T-a)};function yo(a){a.j.I==0||a.K||zy(a.j,a)}function cr(a){Ml(a);var d=a.O;d&&typeof d.dispose=="function"&&d.dispose(),a.O=null,sy(a.V),a.g&&(d=a.g,a.g=null,d.abort(),d.dispose())}function Pl(a,d){try{var f=a.j;if(f.I!=0&&(f.g==a||xl(f.h,a))){if(!a.L&&xl(f.h,a)&&f.I==3){try{var g=f.Ba.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var D=g;if(D[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<a.F)fa(f),la(f);else break e;Vl(f),et(18)}}else f.xa=D[1],0<f.xa-f.K&&D[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=po(l(f.Va,f),6e3));wy(f.h)<=1&&f.ta&&(f.ta=void 0)}else lr(f,11)}else if((a.L||f.g==a)&&fa(f),!v(d))for(D=f.Ba.g.parse(d),d=0;d<D.length;d++){let pe=D[d],Le=pe[0];if(!(Le<=f.K))if(f.K=Le,pe=pe[1],f.I==2)if(pe[0]=="c"){f.M=pe[1],f.ba=pe[2];let Ot=pe[3];Ot!=null&&(f.ka=Ot,f.j.info("VER="+f.ka));let dr=pe[4];dr!=null&&(f.za=dr,f.j.info("SVER="+f.za));let Rn=pe[5];Rn!=null&&typeof Rn=="number"&&Rn>0&&(g=1.5*Rn,f.O=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Mn=a.g;if(Mn){let pa=Mn.g?Mn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pa){var b=g.h;b.g||pa.indexOf("spdy")==-1&&pa.indexOf("quic")==-1&&pa.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(kl(b,b.h),b.h=null))}if(g.G){let Ul=Mn.g?Mn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ul&&(g.wa=Ul,ye(g.J,g.G,Ul))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-a.F,f.j.info("Handshake RTT: "+f.T+"ms")),g=f;var P=a;if(g.na=Wy(g,g.L?g.ba:null,g.W),P.L){Ty(g.h,P);var Y=P,ke=g.O;ke&&(Y.H=ke),Y.D&&(Ml(Y),oa(Y)),g.g=P}else Hy(g);f.i.length>0&&da(f)}else pe[0]!="stop"&&pe[0]!="close"||lr(f,7);else f.I==3&&(pe[0]=="stop"||pe[0]=="close"?pe[0]=="stop"?lr(f,7):Fl(f):pe[0]!="noop"&&f.l&&f.l.qa(pe),f.A=0)}}ho(4)}catch{}}var XC=class{constructor(a,d){this.g=a,this.map=d}};function Ey(a){this.l=a||10,s.PerformanceNavigationTiming?(a=s.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Iy(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function wy(a){return a.h?1:a.g?a.g.size:0}function xl(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function kl(a,d){a.g?a.g.add(d):a.h=d}function Ty(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}Ey.prototype.cancel=function(){if(this.i=Dy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Dy(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let d=a.i;for(let f of a.g.values())d=d.concat(f.G);return d}return E(a.i)}var Cy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eb(a,d){if(a){a=a.split("&");for(let f=0;f<a.length;f++){let g=a[f].indexOf("="),D,b=null;g>=0?(D=a[f].substring(0,g),b=a[f].substring(g+1)):D=a[f],d(D,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Sn(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let d;a instanceof Sn?(this.l=a.l,_o(this,a.j),this.o=a.o,this.g=a.g,vo(this,a.u),this.h=a.h,Ol(this,My(a.i)),this.m=a.m):a&&(d=String(a).match(Cy))?(this.l=!1,_o(this,d[1]||"",!0),this.o=Eo(d[2]||""),this.g=Eo(d[3]||"",!0),vo(this,d[4]),this.h=Eo(d[5]||"",!0),Ol(this,d[6]||"",!0),this.m=Eo(d[7]||"")):(this.l=!1,this.i=new wo(null,this.l))}Sn.prototype.toString=function(){let a=[];var d=this.j;d&&a.push(Io(d,by,!0),":");var f=this.g;return(f||d=="file")&&(a.push("//"),(d=this.o)&&a.push(Io(d,by,!0),"@"),a.push(mo(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&a.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(Io(f,f.charAt(0)=="/"?rb:nb,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",Io(f,ob)),a.join("")},Sn.prototype.resolve=function(a){let d=kt(this),f=!!a.j;f?_o(d,a.j):f=!!a.o,f?d.o=a.o:f=!!a.g,f?d.g=a.g:f=a.u!=null;var g=a.h;if(f)vo(d,a.u);else if(f=!!a.h){if(g.charAt(0)!="/")if(this.g&&!this.h)g="/"+g;else{var D=d.h.lastIndexOf("/");D!=-1&&(g=d.h.slice(0,D+1)+g)}if(D=g,D==".."||D==".")g="";else if(D.indexOf("./")!=-1||D.indexOf("/.")!=-1){g=D.lastIndexOf("/",0)==0,D=D.split("/");let b=[];for(let P=0;P<D.length;){let Y=D[P++];Y=="."?g&&P==D.length&&b.push(""):Y==".."?((b.length>1||b.length==1&&b[0]!="")&&b.pop(),g&&P==D.length&&b.push("")):(b.push(Y),g=!0)}g=b.join("/")}else g=D}return f?d.h=g:f=a.i.toString()!=="",f?Ol(d,My(a.i)):f=!!a.m,f&&(d.m=a.m),d};function kt(a){return new Sn(a)}function _o(a,d,f){a.j=f?Eo(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function vo(a,d){if(d){if(d=Number(d),isNaN(d)||d<0)throw Error("Bad port number "+d);a.u=d}else a.u=null}function Ol(a,d,f){d instanceof wo?(a.i=d,sb(a.i,a.l)):(f||(d=Io(d,ib)),a.i=new wo(d,a.l))}function ye(a,d,f){a.i.set(d,f)}function sa(a){return ye(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function Eo(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Io(a,d,f){return typeof a=="string"?(a=encodeURI(a).replace(d,tb),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function tb(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var by=/[#\/\?@]/g,nb=/[#\?:]/g,rb=/[#\?]/g,ib=/[#\?@]/g,ob=/#/g;function wo(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function ur(a){a.g||(a.g=new Map,a.h=0,a.i&&eb(a.i,function(d,f){a.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=wo.prototype,n.add=function(a,d){ur(this),this.i=null,a=ti(this,a);let f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(d),this.h+=1,this};function Sy(a,d){ur(a),d=ti(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function Ay(a,d){return ur(a),d=ti(a,d),a.g.has(d)}n.forEach=function(a,d){ur(this),this.g.forEach(function(f,g){f.forEach(function(D){a.call(d,D,g,this)},this)},this)};function Ny(a,d){ur(a);let f=[];if(typeof d=="string")Ay(a,d)&&(f=f.concat(a.g.get(ti(a,d))));else for(a=Array.from(a.g.values()),d=0;d<a.length;d++)f=f.concat(a[d]);return f}n.set=function(a,d){return ur(this),this.i=null,a=ti(this,a),Ay(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},n.get=function(a,d){return a?(a=Ny(this,a),a.length>0?String(a[0]):d):d};function Ry(a,d,f){Sy(a,d),f.length>0&&(a.i=null,a.g.set(ti(a,d),E(f)),a.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],d=Array.from(this.g.keys());for(let g=0;g<d.length;g++){var f=d[g];let D=mo(f);f=Ny(this,f);for(let b=0;b<f.length;b++){let P=D;f[b]!==""&&(P+="="+mo(f[b])),a.push(P)}}return this.i=a.join("&")};function My(a){let d=new wo;return d.i=a.i,a.g&&(d.g=new Map(a.g),d.h=a.h),d}function ti(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function sb(a,d){d&&!a.j&&(ur(a),a.i=null,a.g.forEach(function(f,g){let D=g.toLowerCase();g!=D&&(Sy(this,g),Ry(this,D,f))},a)),a.j=d}function ab(a,d){let f=new go;if(s.Image){let g=new Image;g.onload=h(An,f,"TestLoadImage: loaded",!0,d,g),g.onerror=h(An,f,"TestLoadImage: error",!1,d,g),g.onabort=h(An,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=h(An,f,"TestLoadImage: timeout",!1,d,g),s.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=a}else d(!1)}function cb(a,d){let f=new go,g=new AbortController,D=setTimeout(()=>{g.abort(),An(f,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:g.signal}).then(b=>{clearTimeout(D),b.ok?An(f,"TestPingServer: ok",!0,d):An(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),An(f,"TestPingServer: error",!1,d)})}function An(a,d,f,g,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),g(f)}catch{}}function ub(){this.g=new qC}function aa(a){this.i=a.Sb||null,this.h=a.ab||!1}p(aa,ay),aa.prototype.g=function(){return new ca(this.i,this.h)};function ca(a,d){He.call(this),this.H=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(ca,He),n=ca.prototype,n.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=d,this.readyState=1,Do(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let d={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(d.body=a),(this.H||s).fetch(new Request(this.D,d)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,To(this)),this.readyState=0},n.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Do(this)),this.g&&(this.readyState=3,Do(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Py(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function Py(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}n.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.B.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?To(this):Do(this),this.readyState==3&&Py(this)}},n.Oa=function(a){this.g&&(this.response=this.responseText=a,To(this))},n.Na=function(a){this.g&&(this.response=a,To(this))},n.ga=function(){this.g&&To(this)};function To(a){a.readyState=4,a.l=null,a.j=null,a.B=null,Do(a)}n.setRequestHeader=function(a,d){this.A.append(a,d)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=d.next();return a.join(`\r
`)};function Do(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function xy(a){let d="";return ea(a,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function Ll(a,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=xy(f),typeof a=="string"?f!=null&&mo(f):ye(a,d,f))}function Ie(a){He.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ie,He);var lb=/^https?$/i,db=["POST","PUT"];n=Ie.prototype,n.Fa=function(a){this.H=a},n.ea=function(a,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():py.g(),this.g.onreadystatechange=m(l(this.Ca,this));try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(b){ky(this,b);return}if(a=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var D in g)f.set(D,g[D]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let b of g.keys())f.set(b,g.get(b));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(b=>b.toLowerCase()=="content-type"),D=s.FormData&&a instanceof s.FormData,!(Array.prototype.indexOf.call(db,d,void 0)>=0)||g||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,P]of f)this.g.setRequestHeader(b,P);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(b){ky(this,b)}};function ky(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.o=5,Oy(a),ua(a)}function Oy(a){a.A||(a.A=!0,Xe(a,"complete"),Xe(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,Xe(this,"complete"),Xe(this,"abort"),ua(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ua(this,!0)),Ie.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ly(this):this.Xa())},n.Xa=function(){Ly(this)};function Ly(a){if(a.h&&typeof o<"u"){if(a.v&&Nn(a)==4)setTimeout(a.Ca.bind(a),0);else if(Xe(a,"readystatechange"),Nn(a)==4){a.h=!1;try{let b=a.ca();e:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=b===0){let P=String(a.D).match(Cy)[1]||null;!P&&s.self&&s.self.location&&(P=s.self.location.protocol.slice(0,-1)),g=!lb.test(P?P.toLowerCase():"")}f=g}if(f)Xe(a,"complete"),Xe(a,"success");else{a.o=6;try{var D=Nn(a)>2?a.g.statusText:""}catch{D=""}a.l=D+" ["+a.ca()+"]",Oy(a)}}finally{ua(a)}}}}function ua(a,d){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);let f=a.g;a.g=null,d||Xe(a,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Nn(a){return a.g?a.g.readyState:0}n.ca=function(){try{return Nn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),zC(d)}};function Fy(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function fb(a){let d={};a=(a.g&&Nn(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<a.length;g++){if(v(a[g]))continue;var f=YC(a[g]);let D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let b=d[D]||[];d[D]=b,b.push(f)}BC(d,function(g){return g.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Co(a,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||d}function Vy(a){this.za=0,this.i=[],this.j=new go,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Co("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Co("baseRetryDelayMs",5e3,a),this.Za=Co("retryDelaySeedMs",1e4,a),this.Ta=Co("forwardChannelMaxRetries",2,a),this.va=Co("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new Ey(a&&a.concurrentRequestLimit),this.Ba=new ub,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Vy.prototype,n.ka=8,n.I=1,n.connect=function(a,d,f,g){et(0),this.W=a,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.J=Wy(this,null,this.W),da(this)};function Fl(a){if(By(a),a.I==3){var d=a.V++,f=kt(a.J);if(ye(f,"SID",a.M),ye(f,"RID",d),ye(f,"TYPE","terminate"),bo(a,f),d=new bn(a,a.j,d),d.M=2,d.A=sa(kt(f)),f=!1,s.navigator&&s.navigator.sendBeacon)try{f=s.navigator.sendBeacon(d.A.toString(),"")}catch{}!f&&s.Image&&(new Image().src=d.A,f=!0),f||(d.g=Ky(d.j,null),d.g.ea(d.A)),d.F=Date.now(),oa(d)}Gy(a)}function la(a){a.g&&(Bl(a),a.g.cancel(),a.g=null)}function By(a){la(a),a.v&&(s.clearTimeout(a.v),a.v=null),fa(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&s.clearTimeout(a.m),a.m=null)}function da(a){if(!Iy(a.h)&&!a.m){a.m=!0;var d=a.Ea;xe||y(),Se||(xe(),Se=!0),T.add(d,a),a.D=0}}function hb(a,d){return wy(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=d.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=po(l(a.Ea,a,d),qy(a,a.D)),a.D++,!0)}n.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;let D=new bn(this,this.j,a),b=this.o;if(this.U&&(b?(b=Ym(b),Jm(b,this.U)):b=this.U),this.u!==null||this.R||(D.J=b,b=null),this.S)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,d>4096){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=jy(this,D,d),f=kt(this.J),ye(f,"RID",a),ye(f,"CVER",22),this.G&&ye(f,"X-HTTP-Session-Id",this.G),bo(this,f),b&&(this.R?d="headers="+mo(xy(b))+"&"+d:this.u&&Ll(f,this.u,b)),kl(this.h,D),this.Ra&&ye(f,"TYPE","init"),this.S?(ye(f,"$req",d),ye(f,"SID","null"),D.U=!0,Rl(D,f,null)):Rl(D,f,d),this.I=2}}else this.I==3&&(a?Uy(this,a):this.i.length==0||Iy(this.h)||Uy(this))};function Uy(a,d){var f;d?f=d.l:f=a.V++;let g=kt(a.J);ye(g,"SID",a.M),ye(g,"RID",f),ye(g,"AID",a.K),bo(a,g),a.u&&a.o&&Ll(g,a.u,a.o),f=new bn(a,a.j,f,a.D+1),a.u===null&&(f.J=a.o),d&&(a.i=d.G.concat(a.i)),d=jy(a,f,1e3),f.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),kl(a.h,f),Rl(f,g,d)}function bo(a,d){a.H&&ea(a.H,function(f,g){ye(d,g,f)}),a.l&&ea({},function(f,g){ye(d,g,f)})}function jy(a,d,f){f=Math.min(a.i.length,f);let g=a.l?l(a.l.Ka,a.l,a):null;e:{var D=a.i;let Y=-1;for(;;){let ke=["count="+f];Y==-1?f>0?(Y=D[0].g,ke.push("ofs="+Y)):Y=0:ke.push("ofs="+Y);let pe=!0;for(let Le=0;Le<f;Le++){var b=D[Le].g;let Ot=D[Le].map;if(b-=Y,b<0)Y=Math.max(0,D[Le].g-100),pe=!1;else try{b="req"+b+"_"||"";try{var P=Ot instanceof Map?Ot:Object.entries(Ot);for(let[dr,Rn]of P){let Mn=Rn;c(Rn)&&(Mn=Cl(Rn)),ke.push(b+dr+"="+encodeURIComponent(Mn))}}catch(dr){throw ke.push(b+"type="+encodeURIComponent("_badmap")),dr}}catch{g&&g(Ot)}}if(pe){P=ke.join("&");break e}}P=void 0}return a=a.i.splice(0,f),d.G=a,P}function Hy(a){if(!a.g&&!a.v){a.Y=1;var d=a.Da;xe||y(),Se||(xe(),Se=!0),T.add(d,a),a.A=0}}function Vl(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=po(l(a.Da,a),qy(a,a.A)),a.A++,!0)}n.Da=function(){if(this.v=null,$y(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=po(l(this.Wa,this),a)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,et(10),la(this),$y(this))};function Bl(a){a.B!=null&&(s.clearTimeout(a.B),a.B=null)}function $y(a){a.g=new bn(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var d=kt(a.na);ye(d,"RID","rpc"),ye(d,"SID",a.M),ye(d,"AID",a.K),ye(d,"CI",a.F?"0":"1"),!a.F&&a.ia&&ye(d,"TO",a.ia),ye(d,"TYPE","xmlhttp"),bo(a,d),a.u&&a.o&&Ll(d,a.u,a.o),a.O&&(a.g.H=a.O);var f=a.g;a=a.ba,f.M=1,f.A=sa(kt(d)),f.u=null,f.R=!0,yy(f,a)}n.Va=function(){this.C!=null&&(this.C=null,la(this),Vl(this),et(19))};function fa(a){a.C!=null&&(s.clearTimeout(a.C),a.C=null)}function zy(a,d){var f=null;if(a.g==d){fa(a),Bl(a),a.g=null;var g=2}else if(xl(a.h,d))f=d.G,Ty(a.h,d),g=1;else return;if(a.I!=0){if(d.o)if(g==1){f=d.u?d.u.length:0,d=Date.now()-d.F;var D=a.D;g=ra(),Xe(g,new fy(g,f)),da(a)}else Hy(a);else if(D=d.m,D==3||D==0&&d.X>0||!(g==1&&hb(a,d)||g==2&&Vl(a)))switch(f&&f.length>0&&(d=a.h,d.i=d.i.concat(f)),D){case 1:lr(a,5);break;case 4:lr(a,10);break;case 3:lr(a,6);break;default:lr(a,2)}}}function qy(a,d){let f=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(f*=2),f*d}function lr(a,d){if(a.j.info("Error code "+d),d==2){var f=l(a.bb,a),g=a.Ua;let D=!g;g=new Sn(g||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||_o(g,"https"),sa(g),D?ab(g.toString(),f):cb(g.toString(),f)}else et(2);a.I=0,a.l&&a.l.pa(d),Gy(a),By(a)}n.bb=function(a){a?(this.j.info("Successfully pinged google.com"),et(2)):(this.j.info("Failed to ping google.com"),et(1))};function Gy(a){if(a.I=0,a.ja=[],a.l){let d=Dy(a.h);(d.length!=0||a.i.length!=0)&&(A(a.ja,d),A(a.ja,a.i),a.h.i.length=0,E(a.i),a.i.length=0),a.l.oa()}}function Wy(a,d,f){var g=f instanceof Sn?kt(f):new Sn(f);if(g.g!="")d&&(g.g=d+"."+g.g),vo(g,g.u);else{var D=s.location;g=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;let b=new Sn(null);g&&_o(b,g),d&&(b.g=d),D&&vo(b,D),f&&(b.h=f),g=b}return f=a.G,d=a.wa,f&&d&&ye(g,f,d),ye(g,"VER",a.ka),bo(a,g),g}function Ky(a,d,f){if(d&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Aa&&!a.ma?new Ie(new aa({ab:f})):new Ie(a.ma),d.Fa(a.L),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qy(){}n=Qy.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ha(){}ha.prototype.g=function(a,d){return new at(a,d)};function at(a,d){He.call(this),this.g=new Vy(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.sa&&(a?a["X-WebChannel-Client-Profile"]=d.sa:a={"X-WebChannel-Client-Profile":d.sa}),this.g.U=a,(a=d&&d.Qb)&&!v(a)&&(this.g.u=a),this.A=d&&d.supportsCrossDomainXhr||!1,this.v=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!v(d)&&(this.g.G=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new ni(this)}p(at,He),at.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},at.prototype.close=function(){Fl(this.g)},at.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.v&&(f={},f.__data__=Cl(a),a=f);d.i.push(new XC(d.Ya++,a)),d.I==3&&da(d)},at.prototype.N=function(){this.g.l=null,delete this.j,Fl(this.g),delete this.g,at.Z.N.call(this)};function Yy(a){bl.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(let f in d){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}p(Yy,bl);function Zy(){Sl.call(this),this.status=1}p(Zy,Sl);function ni(a){this.g=a}p(ni,Qy),ni.prototype.ra=function(){Xe(this.g,"a")},ni.prototype.qa=function(a){Xe(this.g,new Yy(a))},ni.prototype.pa=function(a){Xe(this.g,new Zy)},ni.prototype.oa=function(){Xe(this.g,"b")},ha.prototype.createWebChannel=ha.prototype.g,at.prototype.send=at.prototype.o,at.prototype.open=at.prototype.m,at.prototype.close=at.prototype.close,ep=pn.createWebChannelTransport=function(){return new ha},Xh=pn.getStatEventTarget=function(){return ra()},Jh=pn.Event=ar,Yc=pn.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ia.NO_ERROR=0,ia.TIMEOUT=8,ia.HTTP_ERROR=6,ws=pn.ErrorCode=ia,hy.COMPLETE="complete",Zh=pn.EventType=hy,cy.EventType=fo,fo.OPEN="a",fo.CLOSE="b",fo.ERROR="c",fo.MESSAGE="d",He.prototype.listen=He.prototype.J,Oi=pn.WebChannel=cy,LM=pn.FetchXmlHttpFactory=aa,Ie.prototype.listenOnce=Ie.prototype.K,Ie.prototype.getLastError=Ie.prototype.Ha,Ie.prototype.getLastErrorCode=Ie.prototype.ya,Ie.prototype.getStatus=Ie.prototype.ca,Ie.prototype.getResponseJson=Ie.prototype.La,Ie.prototype.getResponseText=Ie.prototype.la,Ie.prototype.send=Ie.prototype.ea,Ie.prototype.setWithCredentials=Ie.prototype.Fa,Yh=pn.XhrIo=Ie}).apply(typeof Qc<"u"?Qc:typeof self<"u"?self:typeof window<"u"?window:{});var Iw="@firebase/firestore",ww="4.9.3";var Ue=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ue.UNAUTHENTICATED=new Ue(null),Ue.GOOGLE_CREDENTIALS=new Ue("google-credentials-uid"),Ue.FIRST_PARTY=new Ue("first-party-uid"),Ue.MOCK_USER=new Ue("mock-user");var no="12.7.0";var jr=new zn("@firebase/firestore");function Li(){return jr.logLevel}function k(n,...e){if(jr.logLevel<=te.DEBUG){let t=e.map(Hg);jr.debug(`Firestore (${no}): ${n}`,...t)}}function gn(n,...e){if(jr.logLevel<=te.ERROR){let t=e.map(Hg);jr.error(`Firestore (${no}): ${n}`,...t)}}function zi(n,...e){if(jr.logLevel<=te.WARN){let t=e.map(Hg);jr.warn(`Firestore (${no}): ${n}`,...t)}}function Hg(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function V(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,cT(n,r,t)}function cT(n,e,t){let r=`FIRESTORE (${no}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw gn(r),new Error(r)}function ue(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||cT(e,i,r)}function q(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends dt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Jt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ru=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},sp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ue.UNAUTHENTICATED))}shutdown(){}},ap=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},cp=class{constructor(e){this.t=e,this.currentUser=Ue.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ue(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),o=new Jt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Jt,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let u=o;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Jt)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string",31837,{l:r}),new ru(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string",2055,{h:e}),new Ue(e)}},up=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ue.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},lp=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new up(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ue.FIRST_PARTY))}shutdown(){}invalidateToken(){}},iu=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},dp=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ue(this.o===void 0,3512);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new iu(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ue(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new iu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function FM(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var As=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=FM(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function ne(n,e){return n<e?-1:n>e?1:0}function fp(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),o=e.charAt(r);if(i!==o)return tp(i)===tp(o)?ne(i,o):tp(i)?1:-1}return ne(n.length,e.length)}var VM=55296,BM=57343;function tp(n){let e=n.charCodeAt(0);return e>=VM&&e<=BM}function qi(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Tw="__name__",ou=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&V(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&V(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return ne(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):fp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hn.fromString(e.substring(4,e.length-2))}},Ce=class n extends ou{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},UM=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ft=class n extends ou{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return UM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Tw}static keyField(){return new n([Tw])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new L(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new L(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new L(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(s=!s,i++):c!=="."||s?(r+=c,i++):(o(),i++)}if(o(),s)throw new L(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ce.fromString(e))}static fromName(e){return new n(Ce.fromString(e).popFirst(5))}static empty(){return new n(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ce(e.slice()))}};function jM(n,e,t){if(!t)throw new L(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function HM(n,e,t,r){if(e===!0&&r===!0)throw new L(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Dw(n){if(!B.isDocumentKey(n))throw new L(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function uT(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function $g(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":V(12329,{type:typeof n})}function Kn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=$g(n);throw new L(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Me(n,e){let t={typeString:n};return e&&(t.value=e),t}function js(n,e){if(!uT(n))throw new L(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new L(N.INVALID_ARGUMENT,t);return!0}var Cw=-62135596800,bw=1e6,Pe=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*bw);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Cw)throw new L(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bw}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(js(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Cw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Pe._jsonSchemaVersion="firestore/timestamp/1.0",Pe._jsonSchema={type:Me("string",Pe._jsonSchemaVersion),seconds:Me("number"),nanoseconds:Me("number")};var K=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Pe(0,0))}static max(){return new n(new Pe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ns=-1,hp=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};hp.UNKNOWN_ID=-1;function $M(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new Pe(t+1,0):new Pe(t,r));return new Hr(i,B.empty(),e)}function zM(n){return new Hr(n.readTime,n.key,Ns)}var Hr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(K.min(),B.empty(),Ns)}static max(){return new n(K.max(),B.empty(),Ns)}};function qM(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}var GM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",pp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function ro(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==GM)throw n;k("LocalStore","Unexpectedly lost primary lease")}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&V(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(c=>{++i,c.next(()=>{++o,s&&o===i&&t()},u=>r(u))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),c=0;for(let u=0;u<o;u++){let l=u;t(e[l]).next(h=>{s[l]=h,++c,c===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function WM(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function io(n){return n.name==="IndexedDbTransactionError"}var zg=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),qg=-1;function Fu(n){return n==null}function Rs(n){return n===0&&1/n==-1/0}function KM(n){return typeof n=="number"&&Number.isInteger(n)&&!Rs(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var lT="";function QM(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Sw(e)),e=YM(n.get(t),e);return Sw(e)}function YM(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case lT:t+="";break;default:t+=o}}return t}function Sw(n){return n+lT+""}var ZM="remoteDocuments",dT="owner";var fT="mutationQueues";var hT="mutations";var pT="documentMutations",JM="remoteDocumentsV14";var gT="remoteDocumentGlobal";var mT="targets";var yT="targetDocuments";var _T="targetGlobal",vT="collectionParents";var ET="clientMetadata";var IT="bundles";var wT="namedQueries";var XM="indexConfiguration";var eP="indexState";var tP="indexEntries";var TT="documentOverlays";var nP="globals";var rP=[fT,hT,pT,ZM,mT,dT,_T,yT,ET,gT,vT,IT,wT],V6=[...rP,TT],iP=[fT,hT,pT,JM,mT,dT,_T,yT,ET,gT,vT,IT,wT,TT],oP=iP,sP=[...oP,XM,eP,tP];var B6=[...sP,nP];function Aw(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function DT(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var De=class n{constructor(e,t){this.comparator=e,this.root=t||Xt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ui(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ui(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ui(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ui(this.root,e,this.comparator,!0)}},Ui=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Xt=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw V(43730,{key:this.key,value:this.value});if(this.right.isRed())throw V(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw V(27949);return e+(this.isRed()?0:1)}};Xt.EMPTY=null,Xt.RED=!0,Xt.BLACK=!1;Xt.EMPTY=new class{constructor(){this.size=0}get key(){throw V(57766)}get value(){throw V(16141)}get color(){throw V(16727)}get left(){throw V(29726)}get right(){throw V(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Xt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var je=class n{constructor(e){this.comparator=e,this.data=new De(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new su(this.data.getIterator())}getIteratorFrom(e){return new su(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},su=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Zt=class n{constructor(e){this.fields=e,e.sort(ft.comparator)}static empty(){return new n([])}unionWith(e){let t=new je(ft.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return qi(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var au=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Je=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new au("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Je.EMPTY_BYTE_STRING=new Je("");var aP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mn(n){if(ue(!!n,39018),typeof n=="string"){let e=0,t=aP.exec(n);if(ue(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ve(n.seconds),nanos:ve(n.nanos)}}function ve(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function yn(n){return typeof n=="string"?Je.fromBase64String(n):Je.fromUint8Array(n)}var CT="server_timestamp",bT="__type__",ST="__previous_value__",AT="__local_write_time__";function Gg(n){return(n?.mapValue?.fields||{})[bT]?.stringValue===CT}function Vu(n){let e=n.mapValue.fields[ST];return Gg(e)?Vu(e):e}function Ms(n){let e=mn(n.mapValue.fields[AT].timestampValue);return new Pe(e.seconds,e.nanos)}var gp=class{constructor(e,t,r,i,o,s,c,u,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=h}},cu="(default)",uu=class n{constructor(e,t){this.projectId=e,this.database=t||cu}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===cu}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Wg="__type__",NT="__max__",Zc={mapValue:{fields:{__type__:{stringValue:NT}}}},Kg="__vector__",Gi="value";function Jn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Gg(n)?4:MT(n)?9007199254740991:RT(n)?10:11:V(28295,{value:n})}function nn(n,e){if(n===e)return!0;let t=Jn(n);if(t!==Jn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ms(n).isEqual(Ms(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=mn(i.timestampValue),c=mn(o.timestampValue);return s.seconds===c.seconds&&s.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return yn(i.bytesValue).isEqual(yn(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return ve(i.geoPointValue.latitude)===ve(o.geoPointValue.latitude)&&ve(i.geoPointValue.longitude)===ve(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return ve(i.integerValue)===ve(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=ve(i.doubleValue),c=ve(o.doubleValue);return s===c?Rs(s)===Rs(c):isNaN(s)&&isNaN(c)}return!1})(n,e);case 9:return qi(n.arrayValue.values||[],e.arrayValue.values||[],nn);case 10:case 11:return(function(i,o){let s=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Aw(s)!==Aw(c))return!1;for(let u in s)if(s.hasOwnProperty(u)&&(c[u]===void 0||!nn(s[u],c[u])))return!1;return!0})(n,e);default:return V(52216,{left:n})}}function Ps(n,e){return(n.values||[]).find(t=>nn(t,e))!==void 0}function Wi(n,e){if(n===e)return 0;let t=Jn(n),r=Jn(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return(function(o,s){let c=ve(o.integerValue||o.doubleValue),u=ve(s.integerValue||s.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return Nw(n.timestampValue,e.timestampValue);case 4:return Nw(Ms(n),Ms(e));case 5:return fp(n.stringValue,e.stringValue);case 6:return(function(o,s){let c=yn(o),u=yn(s);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(o,s){let c=o.split("/"),u=s.split("/");for(let l=0;l<c.length&&l<u.length;l++){let h=ne(c[l],u[l]);if(h!==0)return h}return ne(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,s){let c=ne(ve(o.latitude),ve(s.latitude));return c!==0?c:ne(ve(o.longitude),ve(s.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Rw(n.arrayValue,e.arrayValue);case 10:return(function(o,s){let c=o.fields||{},u=s.fields||{},l=c[Gi]?.arrayValue,h=u[Gi]?.arrayValue,p=ne(l?.values?.length||0,h?.values?.length||0);return p!==0?p:Rw(l,h)})(n.mapValue,e.mapValue);case 11:return(function(o,s){if(o===Zc.mapValue&&s===Zc.mapValue)return 0;if(o===Zc.mapValue)return 1;if(s===Zc.mapValue)return-1;let c=o.fields||{},u=Object.keys(c),l=s.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){let m=fp(u[p],h[p]);if(m!==0)return m;let E=Wi(c[u[p]],l[h[p]]);if(E!==0)return E}return ne(u.length,h.length)})(n.mapValue,e.mapValue);default:throw V(23264,{he:t})}}function Nw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);let t=mn(n),r=mn(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function Rw(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Wi(t[i],r[i]);if(o)return o}return ne(t.length,r.length)}function Ki(n){return mp(n)}function mp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=mn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return yn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return B.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=mp(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${mp(t.fields[s])}`;return i+"}"})(n.mapValue):V(61005,{value:n})}function eu(n){switch(Jn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Vu(n);return e?16+eu(e):16;case 5:return 2*n.stringValue.length;case 6:return yn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,o)=>i+eu(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Qr(r.fields,(o,s)=>{i+=o.length+eu(s)}),i})(n.mapValue);default:throw V(13486,{value:n})}}function yp(n){return!!n&&"integerValue"in n}function Qg(n){return!!n&&"arrayValue"in n}function Mw(n){return!!n&&"nullValue"in n}function Pw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function tu(n){return!!n&&"mapValue"in n}function RT(n){return(n?.mapValue?.fields||{})[Wg]?.stringValue===Kg}function Ds(n){if(n.geoPointValue)return{geoPointValue:H({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:H({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Qr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ds(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ds(n.arrayValue.values[t]);return e}return H({},n)}function MT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===NT}var j6={mapValue:{fields:{[Wg]:{stringValue:Kg},[Gi]:{arrayValue:{}}}}};var Mt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!tu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ds(t)}setAll(e){let t=ft.emptyPath(),r={},i=[];e.forEach((s,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}s?r[c.lastSegment()]=Ds(s):i.push(c.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());tu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];tu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Qr(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Ds(this.value))}};function PT(n){let e=[];return Qr(n.fields,(t,r)=>{let i=new ft([t]);if(tu(r)){let o=PT(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Zt(e)}var Pt=class n{constructor(e,t,r,i,o,s,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=c}static newInvalidDocument(e){return new n(e,0,K.min(),K.min(),K.min(),Mt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,K.min(),K.min(),Mt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,K.min(),K.min(),Mt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Qi=class{constructor(e,t){this.position=e,this.inclusive=t}};function xw(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(s.referenceValue),t.key):r=Wi(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function kw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!nn(n.position[t],e.position[t]))return!1;return!0}var Yi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function cP(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var lu=class{},Oe=class n extends lu{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new vp(e,t,r):t==="array-contains"?new wp(e,r):t==="in"?new Tp(e,r):t==="not-in"?new Dp(e,r):t==="array-contains-any"?new Cp(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Ep(e,r):new Ip(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wi(t,this.value)):t!==null&&Jn(this.value)===Jn(t)&&this.matchesComparison(Wi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return V(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},rn=class n extends lu{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return xT(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function xT(n){return n.op==="and"}function kT(n){return uP(n)&&xT(n)}function uP(n){for(let e of n.filters)if(e instanceof rn)return!1;return!0}function _p(n){if(n instanceof Oe)return n.field.canonicalString()+n.op.toString()+Ki(n.value);if(kT(n))return n.filters.map(e=>_p(e)).join(",");{let e=n.filters.map(t=>_p(t)).join(",");return`${n.op}(${e})`}}function OT(n,e){return n instanceof Oe?(function(r,i){return i instanceof Oe&&r.op===i.op&&r.field.isEqual(i.field)&&nn(r.value,i.value)})(n,e):n instanceof rn?(function(r,i){return i instanceof rn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,c)=>o&&OT(s,i.filters[c]),!0):!1})(n,e):void V(19439)}function LT(n){return n instanceof Oe?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ki(t.value)}`})(n):n instanceof rn?(function(t){return t.op.toString()+" {"+t.getFilters().map(LT).join(" ,")+"}"})(n):"Filter"}var vp=class extends Oe{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},Ep=class extends Oe{constructor(e,t){super(e,"in",t),this.keys=FT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Ip=class extends Oe{constructor(e,t){super(e,"not-in",t),this.keys=FT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function FT(n,e){return(e.arrayValue?.values||[]).map(t=>B.fromName(t.referenceValue))}var wp=class extends Oe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Qg(t)&&Ps(t.arrayValue,this.value)}},Tp=class extends Oe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ps(this.value.arrayValue,t)}},Dp=class extends Oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ps(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ps(this.value.arrayValue,t)}},Cp=class extends Oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Qg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ps(this.value.arrayValue,r))}};var bp=class{constructor(e,t=null,r=[],i=[],o=null,s=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=c,this.Te=null}};function Ow(n,e=null,t=[],r=[],i=null,o=null,s=null){return new bp(n,e,t,r,i,o,s)}function Yg(n){let e=q(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>_p(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),Fu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ki(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ki(r)).join(",")),e.Te=t}return e.Te}function Zg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!cP(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!OT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!kw(n.startAt,e.startAt)&&kw(n.endAt,e.endAt)}function Sp(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Zi=class{constructor(e,t=null,r=[],i=[],o=null,s="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function lP(n,e,t,r,i,o,s,c){return new Zi(n,e,t,r,i,o,s,c)}function Bu(n){return new Zi(n)}function Lw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dP(n){return n.collectionGroup!==null}function Cs(n){let e=q(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let c=new je(ft.comparator);return s.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(c=c.add(l.field))})}),c})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Yi(o,r))}),t.has(ft.keyField().canonicalString())||e.Ie.push(new Yi(ft.keyField(),r))}return e.Ie}function en(n){let e=q(n);return e.Ee||(e.Ee=fP(e,Cs(n))),e.Ee}function fP(n,e){if(n.limitType==="F")return Ow(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Yi(i.field,o)});let t=n.endAt?new Qi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Qi(n.startAt.position,n.startAt.inclusive):null;return Ow(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ap(n,e,t){return new Zi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Uu(n,e){return Zg(en(n),en(e))&&n.limitType===e.limitType}function VT(n){return`${Yg(en(n))}|lt:${n.limitType}`}function Fi(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>LT(i)).join(", ")}]`),Fu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(s){return`${s.field.canonicalString()} (${s.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ki(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ki(i)).join(",")),`Target(${r})`})(en(n))}; limitType=${n.limitType})`}function ju(n,e){return e.isFoundDocument()&&(function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(let o of Cs(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(s,c,u){let l=xw(s,c,u);return s.inclusive?l<=0:l<0})(r.startAt,Cs(r),i)||r.endAt&&!(function(s,c,u){let l=xw(s,c,u);return s.inclusive?l>=0:l>0})(r.endAt,Cs(r),i))})(n,e)}function hP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function BT(n){return(e,t)=>{let r=!1;for(let i of Cs(n)){let o=pP(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function pP(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):(function(o,s,c){let u=s.data.field(o),l=c.data.field(o);return u!==null&&l!==null?Wi(u,l):V(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return V(19790,{direction:n.dir})}}var _n=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Qr(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return DT(this.inner)}size(){return this.innerSize}};var gP=new De(B.comparator);function vn(){return gP}var UT=new De(B.comparator);function Ts(...n){let e=UT;for(let t of n)e=e.insert(t.key,t);return e}function jT(n){let e=UT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Lr(){return bs()}function HT(){return bs()}function bs(){return new _n(n=>n.toString(),(n,e)=>n.isEqual(e))}var mP=new De(B.comparator),yP=new je(B.comparator);function re(...n){let e=yP;for(let t of n)e=e.add(t);return e}var _P=new je(ne);function vP(){return _P}function Jg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rs(e)?"-0":e}}function $T(n){return{integerValue:""+n}}function zT(n,e){return KM(e)?$T(e):Jg(n,e)}var Ji=class{constructor(){this._=void 0}};function EP(n,e,t){return n instanceof Xi?(function(i,o){let s={fields:{[bT]:{stringValue:CT},[AT]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Gg(o)&&(o=Vu(o)),o&&(s.fields[ST]=o),{mapValue:s}})(t,e):n instanceof $r?GT(n,e):n instanceof zr?WT(n,e):(function(i,o){let s=qT(i,o),c=Fw(s)+Fw(i.Ae);return yp(s)&&yp(i.Ae)?$T(c):Jg(i.serializer,c)})(n,e)}function IP(n,e,t){return n instanceof $r?GT(n,e):n instanceof zr?WT(n,e):t}function qT(n,e){return n instanceof qr?(function(r){return yp(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var Xi=class extends Ji{},$r=class extends Ji{constructor(e){super(),this.elements=e}};function GT(n,e){let t=KT(e);for(let r of n.elements)t.some(i=>nn(i,r))||t.push(r);return{arrayValue:{values:t}}}var zr=class extends Ji{constructor(e){super(),this.elements=e}};function WT(n,e){let t=KT(e);for(let r of n.elements)t=t.filter(i=>!nn(i,r));return{arrayValue:{values:t}}}var qr=class extends Ji{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function Fw(n){return ve(n.integerValue||n.doubleValue)}function KT(n){return Qg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Np=class{constructor(e,t){this.field=e,this.transform=t}};function wP(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof $r&&i instanceof $r||r instanceof zr&&i instanceof zr?qi(r.elements,i.elements,nn):r instanceof qr&&i instanceof qr?nn(r.Ae,i.Ae):r instanceof Xi&&i instanceof Xi})(n.transform,e.transform)}var Rp=class{constructor(e,t){this.version=e,this.transformResults=t}},Br=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function nu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var eo=class{};function QT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new du(n.key,Br.none()):new Gr(n.key,n.data,Br.none());{let t=n.data,r=Mt.empty(),i=new je(ft.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new En(n.key,r,new Zt(i.toArray()),Br.none())}}function TP(n,e,t){n instanceof Gr?(function(i,o,s){let c=i.value.clone(),u=Bw(i.fieldTransforms,o,s.transformResults);c.setAll(u),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()})(n,e,t):n instanceof En?(function(i,o,s){if(!nu(i.precondition,o))return void o.convertToUnknownDocument(s.version);let c=Bw(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(YT(i)),u.setAll(c),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()})(n,e,t):(function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()})(0,e,t)}function Ss(n,e,t,r){return n instanceof Gr?(function(o,s,c,u){if(!nu(o.precondition,s))return c;let l=o.value.clone(),h=Uw(o.fieldTransforms,u,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof En?(function(o,s,c,u){if(!nu(o.precondition,s))return c;let l=Uw(o.fieldTransforms,u,s),h=s.data;return h.setAll(YT(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))})(n,e,t,r):(function(o,s,c){return nu(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):c})(n,e,t)}function DP(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=qT(r.transform,i||null);o!=null&&(t===null&&(t=Mt.empty()),t.set(r.field,o))}return t||null}function Vw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&qi(r,i,(o,s)=>wP(o,s))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Gr=class extends eo{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},En=class extends eo{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function YT(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Bw(n,e,t){let r=new Map;ue(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,c=e.data.field(o.field);r.set(o.field,IP(s,c,t[i]))}return r}function Uw(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,EP(o,s,e))}return r}var du=class extends eo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Mp=class extends eo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Pp=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&TP(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ss(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ss(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=HT();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,c=this.applyToLocalView(s,o.mutatedFields);c=t.has(i.key)?null:c;let u=QT(s,c);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&qi(this.mutations,e.mutations,(t,r)=>Vw(t,r))&&qi(this.baseMutations,e.baseMutations,(t,r)=>Vw(t,r))}},xp=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ue(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return mP})(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var kp=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Op=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ne,ie;function CP(n){switch(n){case N.OK:return V(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return V(15467,{code:n})}}function ZT(n){if(n===void 0)return gn("GRPC error has no .code"),N.UNKNOWN;switch(n){case Ne.OK:return N.OK;case Ne.CANCELLED:return N.CANCELLED;case Ne.UNKNOWN:return N.UNKNOWN;case Ne.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Ne.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Ne.INTERNAL:return N.INTERNAL;case Ne.UNAVAILABLE:return N.UNAVAILABLE;case Ne.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Ne.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Ne.NOT_FOUND:return N.NOT_FOUND;case Ne.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Ne.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Ne.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Ne.ABORTED:return N.ABORTED;case Ne.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Ne.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Ne.DATA_LOSS:return N.DATA_LOSS;default:return V(39323,{code:n})}}(ie=Ne||(Ne={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";var bP=null;function SP(){return new TextEncoder}var AP=new hn([4294967295,4294967295],0);function jw(n){let e=SP().encode(n),t=new Qh;return t.update(e),new Uint8Array(t.digest())}function Hw(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new hn([t,r],0),new hn([i,o],0)]}var Lp=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Fr(`Invalid padding: ${t}`);if(r<0)throw new Fr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Fr(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=hn.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(hn.fromNumber(r)));return i.compare(AP)===1&&(i=new hn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=jw(e),[r,i]=Hw(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(r,i,o);if(!this.we(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(c=>s.insert(c)),s}insert(e){if(this.ge===0)return;let t=jw(e),[r,i]=Hw(t);for(let o=0;o<this.hashCount;o++){let s=this.ye(r,i,o);this.Se(s)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Fr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var fu=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,xs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(K.min(),i,new De(ne),vn(),re())}},xs=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,re(),re(),re())}};var ji=class{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}},hu=class{constructor(e,t){this.targetId=e,this.Ce=t}},pu=class{constructor(e,t,r=Je.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},gu=class{constructor(){this.ve=0,this.Fe=$w(),this.Me=Je.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=re(),t=re(),r=re();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:V(38017,{changeType:o})}}),new xs(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=$w()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ue(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},Fp=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=vn(),this.Je=Jc(),this.He=Jc(),this.Ye=new De(ne)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:V(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let o=i.target;if(Sp(o))if(r===0){let s=new B(o.path);this.et(t,s,Pt.newNoDocument(s,K.min()))}else ue(r===1,20013,{expectedCount:r});else{let s=this._t(t);if(s!==r){let c=this.ut(e),u=c?this.ct(c,e,s):1;if(u!==0){this.it(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,l)}bP?.lt((function(h,p,m,E,A){let M={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},S=p.unchangedNames;return S&&(M.bloomFilter={applied:A===0,hashCount:S?.hashCount??0,bitmapLength:S?.bits?.bitmap?.length??0,padding:S?.bits?.padding??0,mightContain:x=>E?.mightContain(x)??!1}),M})(s,e.Ce,this.Ge.ht(),c,u))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,c;try{s=yn(r).toUint8Array()}catch(u){if(u instanceof au)return zi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Lp(s,i,o)}catch(u){return zi(u instanceof Fr?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Ge.ht(),c=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(t,o,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((o,s)=>{let c=this.ot(s);if(c){if(o.current&&Sp(c.target)){let u=new B(c.target.path);this.It(u).has(s)||this.Et(s,u)||this.et(s,u,Pt.newNoDocument(u,e))}o.Be&&(t.set(s,o.ke()),o.qe())}});let r=re();this.He.forEach((o,s)=>{let c=!0;s.forEachWhile(u=>{let l=this.ot(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));let i=new fu(e,t,this.Ye,this.je,r);return this.je=vn(),this.Je=Jc(),this.He=Jc(),this.Ye=new De(ne),i}Xe(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new gu,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new je(ne),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new je(ne),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new gu),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Jc(){return new De(B.comparator)}function $w(){return new De(B.comparator)}var NP={asc:"ASCENDING",desc:"DESCENDING"},RP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MP={and:"AND",or:"OR"},Vp=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Bp(n,e){return n.useProto3Json||Fu(e)?e:{value:e}}function mu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function PP(n,e){return mu(n,e.toTimestamp())}function tn(n){return ue(!!n,49232),K.fromTimestamp((function(t){let r=mn(t);return new Pe(r.seconds,r.nanos)})(n))}function Xg(n,e){return Up(n,e).canonicalString()}function Up(n,e){let t=(function(i){return new Ce(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function XT(n){let e=Ce.fromString(n);return ue(iD(e),10190,{key:e.toString()}),e}function jp(n,e){return Xg(n.databaseId,e.path)}function np(n,e){let t=XT(e);if(t.get(1)!==n.databaseId.projectId)throw new L(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(tD(t))}function eD(n,e){return Xg(n.databaseId,e)}function xP(n){let e=XT(n);return e.length===4?Ce.emptyPath():tD(e)}function Hp(n){return new Ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function tD(n){return ue(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zw(n,e,t){return{name:jp(n,e),fields:t.value.mapValue.fields}}function kP(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:V(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(l,h){return l.useProto3Json?(ue(h===void 0||typeof h=="string",58123),Je.fromBase64String(h||"")):(ue(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Je.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),s=e.targetChange.cause,c=s&&(function(l){let h=l.code===void 0?N.UNKNOWN:ZT(l.code);return new L(h,l.message||"")})(s);t=new pu(r,i,o,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=np(n,r.document.name),o=tn(r.document.updateTime),s=r.document.createTime?tn(r.document.createTime):K.min(),c=new Mt({mapValue:{fields:r.document.fields}}),u=Pt.newFoundDocument(i,o,s,c),l=r.targetIds||[],h=r.removedTargetIds||[];t=new ji(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=np(n,r.document),o=r.readTime?tn(r.readTime):K.min(),s=Pt.newNoDocument(i,o),c=r.removedTargetIds||[];t=new ji([],c,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=np(n,r.document),o=r.removedTargetIds||[];t=new ji([],o,i,null)}else{if(!("filter"in e))return V(11601,{Rt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Op(i,o),c=r.targetId;t=new hu(c,s)}}return t}function OP(n,e){let t;if(e instanceof Gr)t={update:zw(n,e.key,e.value)};else if(e instanceof du)t={delete:jp(n,e.key)};else if(e instanceof En)t={update:zw(n,e.key,e.data),updateMask:zP(e.fieldMask)};else{if(!(e instanceof Mp))return V(16599,{Vt:e.type});t={verify:jp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,s){let c=s.transform;if(c instanceof Xi)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof $r)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof zr)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof qr)return{fieldPath:s.field.canonicalString(),increment:c.Ae};throw V(20930,{transform:s.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:PP(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:V(27497)})(n,e.precondition)),t}function LP(n,e){return n&&n.length>0?(ue(e!==void 0,14353),n.map(t=>(function(i,o){let s=i.updateTime?tn(i.updateTime):tn(o);return s.isEqual(K.min())&&(s=tn(o)),new Rp(s,i.transformResults||[])})(t,e))):[]}function FP(n,e){return{documents:[eD(n,e.path)]}}function VP(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=eD(n,i);let o=(function(l){if(l.length!==0)return rD(rn.create(l,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let s=(function(l){if(l.length!==0)return l.map(h=>(function(m){return{field:Vi(m.field),direction:jP(m.dir)}})(h))})(e.orderBy);s&&(t.structuredQuery.orderBy=s);let c=Bp(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{ft:t,parent:i}}function BP(n){let e=xP(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ue(r===1,65062);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=(function(p){let m=nD(p);return m instanceof rn&&kT(m)?m.getFilters():[m]})(t.where));let s=[];t.orderBy&&(s=(function(p){return p.map(m=>(function(A){return new Yi(Bi(A.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(m))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,Fu(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){let m=!!p.before,E=p.values||[];return new Qi(E,m)})(t.startAt));let l=null;return t.endAt&&(l=(function(p){let m=!p.before,E=p.values||[];return new Qi(E,m)})(t.endAt)),lP(e,i,s,o,c,"F",u,l)}function UP(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return V(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function nD(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Bi(t.unaryFilter.field);return Oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Bi(t.unaryFilter.field);return Oe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Bi(t.unaryFilter.field);return Oe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Bi(t.unaryFilter.field);return Oe.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return V(61313);default:return V(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Oe.create(Bi(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return V(58110);default:return V(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return rn.create(t.compositeFilter.filters.map(r=>nD(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return V(1026)}})(t.compositeFilter.op))})(n):V(30097,{filter:n})}function jP(n){return NP[n]}function HP(n){return RP[n]}function $P(n){return MP[n]}function Vi(n){return{fieldPath:n.canonicalString()}}function Bi(n){return ft.fromServerFormat(n.fieldPath)}function rD(n){return n instanceof Oe?(function(t){if(t.op==="=="){if(Pw(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NAN"}};if(Mw(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Pw(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NOT_NAN"}};if(Mw(t.value))return{unaryFilter:{field:Vi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vi(t.field),op:HP(t.op),value:t.value}}})(n):n instanceof rn?(function(t){let r=t.getFilters().map(i=>rD(i));return r.length===1?r[0]:{compositeFilter:{op:$P(t.op),filters:r}}})(n):V(54877,{filter:n})}function zP(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function iD(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ks=class n{constructor(e,t,r,i,o=K.min(),s=K.min(),c=Je.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var $p=class{constructor(e){this.yt=e}};function qP(n){let e=BP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ap(e,e.limit,"L"):e}var yu=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ve(e.integerValue));else if("doubleValue"in e){let r=ve(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Rs(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=mn(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(yn(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?MT(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):RT(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):V(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=Gi,o=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ve(o)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),B.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};yu.Kt=new yu;var zp=class{constructor(){this.Cn=new qp}addToCollectionParentIndex(e,t){return this.Cn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Hr.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Hr.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},qp=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new je(Ce.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new je(Ce.comparator)).toArray()}};var H6=new Uint8Array(0);var qw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oD=41943040,Et=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Et.DEFAULT_COLLECTION_PERCENTILE=10,Et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Et.DEFAULT=new Et(oD,Et.DEFAULT_COLLECTION_PERCENTILE,Et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Et.DISABLED=new Et(-1,0,0);var Os=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var Gw="LruGarbageCollector",GP=1048576;function Ww([n,e],[t,r]){let i=ne(n,t);return i===0?ne(e,r):i}var Gp=class{constructor(e){this.Ir=e,this.buffer=new je(Ww),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Ww(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Wp=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){k(Gw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){io(t)?k(Gw,"Ignoring IndexedDB error during garbage collection: ",t):await ro(t)}await this.Vr(3e5)})}},Kp=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(zg.ce);let r=new Gp(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(qw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qw):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,o,s,c,u,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,c=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Li()<=te.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(c-s)+`ms
	Removed ${o} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function WP(n,e){return new Kp(n,e)}var Qp=class{constructor(){this.changes=new _n(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Pt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Yp=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Zp=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ss(r.mutation,i,Zt.empty(),Pe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){let i=Lr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Ts();return o.forEach((c,u)=>{s=s.insert(c,u.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Lr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,c)=>{t.set(s,c)})})}computeViews(e,t,r,i){let o=vn(),s=bs(),c=(function(){return bs()})();return t.forEach((u,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof En)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),Ss(h.mutation,l,h.mutation.getFieldMask(),Pe.now())):s.set(l.key,Zt.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>c.set(l,new Yp(h,s.get(l)??null))),c))}recalculateAndSaveOverlays(e,t){let r=bs(),i=new De((s,c)=>s-c),o=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let c of s)c.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let h=r.get(u)||Zt.empty();h=c.applyToLocalView(l,h),r.set(u,h);let p=(i.get(c.batchId)||re()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{let s=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),l=u.key,h=u.value,p=HT();h.forEach(m=>{if(!o.has(m)){let E=QT(t.get(m),r.get(m));E!==null&&p.set(m,E),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return R.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(s){return B.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):R.resolve(Lr()),c=Ns,u=o;return s.next(l=>R.forEach(l,(h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),o.get(h)?R.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,u,l,re())).next(h=>({batchId:c,changes:jT(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=Ts();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Ts();return this.indexManager.getCollectionParents(e,o).next(c=>R.forEach(c,u=>{let l=(function(p,m){return new Zi(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((u,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,Pt.newInvalidDocument(h)))});let c=Ts();return s.forEach((u,l)=>{let h=o.get(u);h!==void 0&&Ss(h.mutation,l,Zt.empty(),Pe.now()),ju(t,l)&&(c=c.insert(u,l))}),c})}};var Jp=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return R.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:tn(i.createTime)}})(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:qP(i.bundledQuery),readTime:tn(i.readTime)}})(t)),R.resolve()}};var Xp=class{constructor(){this.overlays=new De(B.comparator),this.qr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Lr();return R.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.St(e,t,o)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=Lr(),o=t.length+1,s=new B(t.child("")),c=this.overlays.getIteratorFrom(s);for(;c.hasNext();){let u=c.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new De((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=Lr(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let c=Lr(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,h)=>c.set(l,h)),!(c.size()>=i)););return R.resolve(c)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new kp(t,r));let o=this.qr.get(t);o===void 0&&(o=re(),this.qr.set(t,o)),this.qr.set(t,o.add(r.key))}};var eg=class{constructor(){this.sessionToken=Je.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var Ls=class{constructor(){this.Qr=new je(Re.$r),this.Ur=new je(Re.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new Re(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new Re(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){let t=new B(new Ce([])),r=new Re(t,e),i=new Re(t,e+1),o=[];return this.Ur.forEachInRange([r,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new B(new Ce([])),r=new Re(t,e),i=new Re(t,e+1),o=re();return this.Ur.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Re(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Re=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return B.comparator(e.key,t.key)||ne(e.Yr,t.Yr)}static Kr(e,t){return ne(e.Yr,t.Yr)||B.comparator(e.key,t.key)}};var tg=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new je(Re.$r)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Pp(o,t,r,i);this.mutationQueue.push(s);for(let c of i)this.Zr=this.Zr.add(new Re(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return R.resolve(s)}lookupMutationBatch(e,t){return R.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),o=i<0?0:i;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?qg:this.tr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Re(t,0),i=new Re(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,i],s=>{let c=this.Xr(s.Yr);o.push(c)}),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new je(ne);return t.forEach(i=>{let o=new Re(i,0),s=new Re(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],c=>{r=r.add(c.Yr)})}),R.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let s=new Re(new B(o),0),c=new je(ne);return this.Zr.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(c=c.add(u.Yr)),!0)},s),R.resolve(this.ti(c))}ti(e){let t=[];return e.forEach(r=>{let i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ue(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return R.forEach(t.mutations,i=>{let o=new Re(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new Re(t,0),i=this.Zr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ng=class{constructor(e){this.ri=e,this.docs=(function(){return new De(B.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():Pt.newInvalidDocument(t))}getEntries(e,t){let r=vn();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Pt.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=vn(),s=t.path,c=new B(s.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:l,value:{document:h}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||qM(zM(h),r)<=0||(i.has(h.key)||ju(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,r,i){V(9500)}ii(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new rg(this)}getSize(e){return R.resolve(this.size)}},rg=class extends Qp{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var ig=class{constructor(e){this.persistence=e,this.si=new _n(t=>Yg(t),Zg),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.oi=0,this._i=new Ls,this.targetCount=0,this.ai=Os.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),R.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new Os(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Pr(t),R.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.si.forEach((s,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),R.waitFor(o).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this._i.containsKey(t))}};var _u=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new zg(0),this.li=!1,this.li=!0,this.hi=new eg,this.referenceDelegate=e(this),this.Pi=new ig(this),this.indexManager=new zp,this.remoteDocumentCache=(function(i){return new ng(i)})(r=>this.referenceDelegate.Ti(r)),this.serializer=new $p(t),this.Ii=new Jp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Xp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new tg(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new og(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,t){return R.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}},og=class extends pp{constructor(e){super(),this.currentSequenceNumber=e}},sg=class n{constructor(e){this.persistence=e,this.Ri=new Ls,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw V(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),R.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.fi,r=>{let i=B.fromPath(r);return this.gi(e,i).next(o=>{o||t.removeEntry(i,K.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return R.or([()=>R.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},vu=class n{constructor(e,t){this.persistence=e,this.pi=new _n(r=>QM(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=WP(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return R.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return R.forEach(this.pi,(r,i)=>this.br(e,r,i).next(o=>o?R.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,t).next(c=>{c||(r++,o.removeEntry(s,K.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),R.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),R.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),R.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=eu(e.data.value)),t}br(e,t,r){return R.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return R.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var ag=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=re(),i=re();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var cg=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var ug=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return tw()?8:WM(Be())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ys(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new cg;return this.Ss(e,t,s).next(c=>{if(o.result=c,this.Vs)return this.bs(e,t,s,c.size)})}).next(()=>o.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(Li()<=te.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",Fi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),R.resolve()):(Li()<=te.DEBUG&&k("QueryEngine","Query:",Fi(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Li()<=te.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",Fi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,en(t))):R.resolve())}ys(e,t){if(Lw(t))return R.resolve(null);let r=en(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ap(t,null,"F"),r=en(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=re(...o);return this.ps.getDocuments(e,s).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.Ds(t,c);return this.Cs(t,l,s,u.readTime)?this.ys(e,Ap(t,null,"F")):this.vs(e,l,t,u)}))})))}ws(e,t,r,i){return Lw(t)||i.isEqual(K.min())?R.resolve(null):this.ps.getDocuments(e,r).next(o=>{let s=this.Ds(t,o);return this.Cs(t,s,r,i)?R.resolve(null):(Li()<=te.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fi(t)),this.vs(e,s,t,$M(i,Ns)).next(c=>c))})}Ds(e,t){let r=new je(BT(e));return t.forEach((i,o)=>{ju(e,o)&&(r=r.add(o))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,r){return Li()<=te.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",Fi(t)),this.ps.getDocumentsMatchingQuery(e,t,Hr.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var em="LocalStore",KP=3e8,lg=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new De(ne),this.xs=new _n(o=>Yg(o),Zg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Zp(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function QP(n,e,t,r){return new lg(n,e,t,r)}async function sD(n,e){let t=q(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],c=[],u=re();for(let l of i){s.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}for(let l of o){c.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next(l=>({Ls:l,removedBatchIds:s,addedBatchIds:c}))})})}function YP(n,e){let t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,l,h){let p=l.batch,m=p.keys(),E=R.resolve();return m.forEach(A=>{E=E.next(()=>h.getEntry(u,A)).next(M=>{let S=l.docVersions.get(A);ue(S!==null,48541),M.version.compareTo(S)<0&&(p.applyToRemoteDocument(M,l),M.isValidDocument()&&(M.setReadTime(l.commitVersion),h.addEntry(M)))})}),E.next(()=>c.mutationQueue.removeMutationBatch(u,p))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=re();for(let l=0;l<c.mutationResults.length;++l)c.mutationResults[l].transformResults.length>0&&(u=u.add(c.batch.mutations[l].key));return u})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function aD(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function ZP(n,e){let t=q(n),r=e.snapshotVersion,i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;let c=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Pi.addMatchingKeys(o,h.addedDocuments,p)));let E=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?E=E.withResumeToken(Je.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):h.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(h.resumeToken,r)),i=i.insert(p,E),(function(M,S,x){return M.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=KP?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0})(m,E,h)&&c.push(t.Pi.updateTargetData(o,E))});let u=vn(),l=re();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),c.push(JP(o,s,e.documentUpdates).next(h=>{u=h.ks,l=h.qs})),!r.isEqual(K.min())){let h=t.Pi.getLastRemoteSnapshotVersion(o).next(p=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r));c.push(h)}return R.waitFor(c).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,u,l)).next(()=>u)}).then(o=>(t.Ms=i,o))}function JP(n,e,t){let r=re(),i=re();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=vn();return t.forEach((c,u)=>{let l=o.get(c);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(K.min())?(e.removeEntry(c,u.readTime),s=s.insert(c,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(c,u)):k(em,"Ignoring outdated watch update for ",c,". Current version:",l.version," Watch version:",u.version)}),{ks:s,qs:i}})}function XP(n,e){let t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=qg),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ex(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(o=>o?(i=o,R.resolve(i)):t.Pi.allocateTargetId(r).next(s=>(i=new ks(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function dg(n,e,t){let r=q(n),i=r.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!io(s))throw s;k(em,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Kw(n,e,t){let r=q(n),i=K.min(),o=re();return r.persistence.runTransaction("Execute query","readwrite",s=>(function(u,l,h){let p=q(u),m=p.xs.get(h);return m!==void 0?R.resolve(p.Ms.get(m)):p.Pi.getTargetData(l,h)})(r,s,en(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(s,c.targetId).next(u=>{o=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(s,e,t?i:K.min(),t?o:re())).next(c=>(tx(r,hP(e),c),{documents:c,Qs:o})))}function tx(n,e,t){let r=n.Os.get(e)||K.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.Os.set(e,r)}var Eu=class{constructor(){this.activeTargetIds=vP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var fg=class{constructor(){this.Mo=new Eu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Eu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var hg=class{Oo(e){}shutdown(){}};var Qw="ConnectivityMonitor",Iu=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){k(Qw,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){k(Qw,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Xc=null;function pg(){return Xc===null?Xc=(function(){return 268435456+Math.round(2147483648*Math.random())})():Xc++,"0x"+Xc.toString(16)}var rp="RestConnection",nx={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},gg=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===cu?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,o){let s=pg(),c=this.zo(e,t.toUriEncodedString());k(rp,`Sending RPC '${e}' ${s}:`,c,r);let u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);let{host:l}=new URL(c),h=$n(l);return this.Jo(e,c,u,r,h).then(p=>(k(rp,`Received RPC '${e}' ${s}: `,p),p),p=>{throw zi(rp,`RPC '${e}' ${s} failed with error: `,p,"url: ",c,"request:",r),p})}Ho(e,t,r,i,o,s){return this.Go(e,t,r,i,o)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+no})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}zo(e,t){let r=nx[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var mg=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var Ye="WebChannelConnection",yg=class extends gg{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,o){let s=pg();return new Promise((c,u)=>{let l=new Yh;l.setWithCredentials(!0),l.listenOnce(Zh.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ws.NO_ERROR:let p=l.getResponseJson();k(Ye,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),c(p);break;case ws.TIMEOUT:k(Ye,`RPC '${e}' ${s} timed out`),u(new L(N.DEADLINE_EXCEEDED,"Request time out"));break;case ws.HTTP_ERROR:let m=l.getStatus();if(k(Ye,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let E=l.getResponseJson();Array.isArray(E)&&(E=E[0]);let A=E?.error;if(A&&A.status&&A.message){let M=(function(x){let F=x.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(F)>=0?F:N.UNKNOWN})(A.status);u(new L(M,A.message))}else u(new L(N.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new L(N.UNAVAILABLE,"Connection failed."));break;default:V(9055,{l_:e,streamId:s,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{k(Ye,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(i);k(Ye,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)})}T_(e,t,r){let i=pg(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=ep(),c=Xh(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let h=o.join("");k(Ye,`Creating RPC '${e}' stream ${i}: ${h}`,u);let p=s.createWebChannel(h,u);this.I_(p);let m=!1,E=!1,A=new mg({Yo:S=>{E?k(Ye,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(k(Ye,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(Ye,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},Zo:()=>p.close()}),M=(S,x,F)=>{S.listen(x,G=>{try{F(G)}catch(be){setTimeout(()=>{throw be},0)}})};return M(p,Oi.EventType.OPEN,()=>{E||(k(Ye,`RPC '${e}' stream ${i} transport opened.`),A.o_())}),M(p,Oi.EventType.CLOSE,()=>{E||(E=!0,k(Ye,`RPC '${e}' stream ${i} transport closed`),A.a_(),this.E_(p))}),M(p,Oi.EventType.ERROR,S=>{E||(E=!0,zi(Ye,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),A.a_(new L(N.UNAVAILABLE,"The operation could not be completed")))}),M(p,Oi.EventType.MESSAGE,S=>{if(!E){let x=S.data[0];ue(!!x,16349);let F=x,G=F?.error||F[0]?.error;if(G){k(Ye,`RPC '${e}' stream ${i} received error:`,G);let be=G.status,xe=(function(y){let _=Ne[y];if(_!==void 0)return ZT(_)})(be),Se=G.message;xe===void 0&&(xe=N.INTERNAL,Se="Unknown error status: "+be+" with message "+G.message),E=!0,A.a_(new L(xe,Se)),p.close()}else k(Ye,`RPC '${e}' stream ${i} received:`,x),A.u_(x)}}),M(c,Jh.STAT_EVENT,S=>{S.stat===Yc.PROXY?k(Ye,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Yc.NOPROXY&&k(Ye,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function ip(){return typeof document<"u"?document:null}function Hu(n){return new Vp(n,!0)}var wu=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var Yw="PersistentStream",Tu=class{constructor(e,t,r,i,o,s,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new wu(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(gn(t.toString()),gn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new L(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return k(Yw,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(k(Yw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},_g=class extends Tu{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=kP(this.serializer,e),r=(function(o){if(!("targetChange"in o))return K.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?K.min():s.readTime?tn(s.readTime):K.min()})(e);return this.listener.H_(t,r)}Y_(e){let t={};t.database=Hp(this.serializer),t.addTarget=(function(o,s){let c,u=s.target;if(c=Sp(u)?{documents:FP(o,u)}:{query:VP(o,u).ft},c.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){c.resumeToken=JT(o,s.resumeToken);let l=Bp(o,s.expectedCount);l!==null&&(c.expectedCount=l)}else if(s.snapshotVersion.compareTo(K.min())>0){c.readTime=mu(o,s.snapshotVersion.toTimestamp());let l=Bp(o,s.expectedCount);l!==null&&(c.expectedCount=l)}return c})(this.serializer,e);let r=UP(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){let t={};t.database=Hp(this.serializer),t.removeTarget=e,this.q_(t)}},vg=class extends Tu{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=LP(e.writeResults,e.commitTime),r=tn(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=Hp(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>OP(this.serializer,r))};this.q_(t)}};var Eg=class{},Ig=class extends Eg{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new L(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,Up(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(N.UNKNOWN,o.toString())})}Ho(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,c])=>this.connection.Ho(e,Up(t,r),i,s,c,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(N.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},wg=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(gn(t),this.aa=!1):k("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Wr="RemoteStore",Tg=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{r.enqueueAndForget(async()=>{Yr(this)&&(k(Wr,"Restarting streams for network reachability change."),await(async function(u){let l=q(u);l.Ea.add(4),await Hs(l),l.Ra.set("Unknown"),l.Ea.delete(4),await $u(l)})(this))})}),this.Ra=new wg(r,i)}};async function $u(n){if(Yr(n))for(let e of n.da)await e(!0)}async function Hs(n){for(let e of n.da)await e(!1)}function cD(n,e){let t=q(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),im(t)?rm(t):oo(t).O_()&&nm(t,e))}function tm(n,e){let t=q(n),r=oo(t);t.Ia.delete(e),r.O_()&&uD(t,e),t.Ia.size===0&&(r.O_()?r.L_():Yr(t)&&t.Ra.set("Unknown"))}function nm(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}oo(n).Y_(e)}function uD(n,e){n.Va.Ue(e),oo(n).Z_(e)}function rm(n){n.Va=new Fp({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),oo(n).start(),n.Ra.ua()}function im(n){return Yr(n)&&!oo(n).x_()&&n.Ia.size>0}function Yr(n){return q(n).Ea.size===0}function lD(n){n.Va=void 0}async function rx(n){n.Ra.set("Online")}async function ix(n){n.Ia.forEach((e,t)=>{nm(n,e)})}async function ox(n,e){lD(n),im(n)?(n.Ra.ha(e),rm(n)):n.Ra.set("Unknown")}async function sx(n,e,t){if(n.Ra.set("Online"),e instanceof pu&&e.state===2&&e.cause)try{await(async function(i,o){let s=o.cause;for(let c of o.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,s),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){k(Wr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Du(n,r)}else if(e instanceof ji?n.Va.Ze(e):e instanceof hu?n.Va.st(e):n.Va.tt(e),!t.isEqual(K.min()))try{let r=await aD(n.localStore);t.compareTo(r)>=0&&await(function(o,s){let c=o.Va.Tt(s);return c.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let h=o.Ia.get(l);h&&o.Ia.set(l,h.withResumeToken(u.resumeToken,s))}}),c.targetMismatches.forEach((u,l)=>{let h=o.Ia.get(u);if(!h)return;o.Ia.set(u,h.withResumeToken(Je.EMPTY_BYTE_STRING,h.snapshotVersion)),uD(o,u);let p=new ks(h.target,u,l,h.sequenceNumber);nm(o,p)}),o.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){k(Wr,"Failed to raise snapshot:",r),await Du(n,r)}}async function Du(n,e,t){if(!io(e))throw e;n.Ea.add(1),await Hs(n),n.Ra.set("Offline"),t||(t=()=>aD(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{k(Wr,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await $u(n)})}function dD(n,e){return e().catch(t=>Du(n,t,e))}async function zu(n){let e=q(n),t=Xn(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:qg;for(;ax(e);)try{let i=await XP(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,cx(e,i)}catch(i){await Du(e,i)}fD(e)&&hD(e)}function ax(n){return Yr(n)&&n.Ta.length<10}function cx(n,e){n.Ta.push(e);let t=Xn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function fD(n){return Yr(n)&&!Xn(n).x_()&&n.Ta.length>0}function hD(n){Xn(n).start()}async function ux(n){Xn(n).ra()}async function lx(n){let e=Xn(n);for(let t of n.Ta)e.ea(t.mutations)}async function dx(n,e,t){let r=n.Ta.shift(),i=xp.from(r,e,t);await dD(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await zu(n)}async function fx(n,e){e&&Xn(n).X_&&await(async function(r,i){if((function(s){return CP(s)&&s!==N.ABORTED})(i.code)){let o=r.Ta.shift();Xn(r).B_(),await dD(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await zu(r)}})(n,e),fD(n)&&hD(n)}async function Zw(n,e){let t=q(n);t.asyncQueue.verifyOperationInProgress(),k(Wr,"RemoteStore received new credentials");let r=Yr(t);t.Ea.add(3),await Hs(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await $u(t)}async function hx(n,e){let t=q(n);e?(t.Ea.delete(2),await $u(t)):e||(t.Ea.add(2),await Hs(t),t.Ra.set("Unknown"))}function oo(n){return n.ma||(n.ma=(function(t,r,i){let o=q(t);return o.sa(),new _g(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:rx.bind(null,n),t_:ix.bind(null,n),r_:ox.bind(null,n),H_:sx.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),im(n)?rm(n):n.Ra.set("Unknown")):(await n.ma.stop(),lD(n))})),n.ma}function Xn(n){return n.fa||(n.fa=(function(t,r,i){let o=q(t);return o.sa(),new vg(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:ux.bind(null,n),r_:fx.bind(null,n),ta:lx.bind(null,n),na:dx.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await zu(n)):(await n.fa.stop(),n.Ta.length>0&&(k(Wr,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var Dg=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Jt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,c=new n(e,t,s,i,o);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function om(n,e){if(gn("AsyncQueue",`${e}: ${n}`),io(n))return new L(N.UNAVAILABLE,`${e}: ${n}`);throw n}var Cu=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=Ts(),this.sortedSet=new De(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var bu=class{constructor(){this.ga=new De(B.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):V(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},to=class n{constructor(e,t,r,i,o,s,c,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(c=>{s.push({type:0,doc:c})}),new n(e,t,Cu.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Cg=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}},bg=class{constructor(){this.queries=Jw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=q(t),o=i.queries;i.queries=Jw(),o.forEach((s,c)=>{for(let u of c.Sa)u.onError(r)})})(this,new L(N.ABORTED,"Firestore shutting down"))}};function Jw(){return new _n(n=>VT(n),Uu)}async function pD(n,e){let t=q(n),r=3,i=e.query,o=t.queries.get(i);o?!o.ba()&&e.Da()&&(r=2):(o=new Cg,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(s){let c=om(s,`Initialization of query '${Fi(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&sm(t)}async function gD(n,e){let t=q(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function px(n,e){let t=q(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let c of s.Sa)c.Fa(i)&&(r=!0);s.wa=i}}r&&sm(t)}function gx(n,e,t){let r=q(n),i=r.queries.get(e);if(i)for(let o of i.Sa)o.onError(t);r.queries.delete(e)}function sm(n){n.Ca.forEach(e=>{e.next()})}var Sg,Xw;(Xw=Sg||(Sg={})).Ma="default",Xw.Cache="cache";var Su=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new to(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=to.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sg.Cache}};var Au=class{constructor(e){this.key=e}},Nu=class{constructor(e){this.key=e}},Ag=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=re(),this.mutatedKeys=re(),this.eu=BT(e),this.tu=new Cu(this.eu)}get nu(){return this.Ya}ru(e,t){let r=t?t.iu:new bu,i=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,s=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),E=ju(this.query,p)?p:null,A=!!m&&this.mutatedKeys.has(m.key),M=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations),S=!1;m&&E?m.data.isEqual(E.data)?A!==M&&(r.track({type:3,doc:E}),S=!0):this.su(m,E)||(r.track({type:2,doc:E}),S=!0,(u&&this.eu(E,u)>0||l&&this.eu(E,l)<0)&&(c=!0)):!m&&E?(r.track({type:0,doc:E}),S=!0):m&&!E&&(r.track({type:1,doc:m}),S=!0,(u||l)&&(c=!0)),S&&(E?(s=s.add(E),o=M?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{tu:s,iu:r,Cs:c,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let s=e.iu.ya();s.sort((h,p)=>(function(E,A){let M=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return V(20277,{Rt:S})}};return M(E)-M(A)})(h.type,p.type)||this.eu(h.doc,p.doc)),this.ou(r),i=i??!1;let c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,l=u!==this.Za;return this.Za=u,s.length!==0||l?{snapshot:new to(this.query,e.tu,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new bu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=re(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});let t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new Nu(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new Au(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=re();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return to.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},am="SyncEngine",Ng=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Rg=class{constructor(e){this.key=e,this.hu=!1}},Mg=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new _n(c=>VT(c),Uu),this.Iu=new Map,this.Eu=new Set,this.du=new De(B.comparator),this.Au=new Map,this.Ru=new Ls,this.Vu={},this.mu=new Map,this.fu=Os.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function mx(n,e,t=!0){let r=ID(n),i,o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await mD(r,e,t,!0),i}async function yx(n,e){let t=ID(n);await mD(t,e,!0,!1)}async function mD(n,e,t,r){let i=await ex(n.localStore,en(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),c;return r&&(c=await _x(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&cD(n.remoteStore,i),c}async function _x(n,e,t,r,i){n.pu=(p,m,E)=>(async function(M,S,x,F){let G=S.view.ru(x);G.Cs&&(G=await Kw(M.localStore,S.query,!1).then(({documents:T})=>S.view.ru(T,G)));let be=F&&F.targetChanges.get(S.targetId),xe=F&&F.targetMismatches.get(S.targetId)!=null,Se=S.view.applyChanges(G,M.isPrimaryClient,be,xe);return tT(M,S.targetId,Se.au),Se.snapshot})(n,p,m,E);let o=await Kw(n.localStore,e,!0),s=new Ag(e,o.Qs),c=s.ru(o.documents),u=xs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(c,n.isPrimaryClient,u);tT(n,t,l.au);let h=new Ng(e,t,s);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),l.snapshot}async function vx(n,e,t){let r=q(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter(s=>!Uu(s,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await dg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&tm(r.remoteStore,i.targetId),Pg(r,i.targetId)}).catch(ro)):(Pg(r,i.targetId),await dg(r.localStore,i.targetId,!0))}async function Ex(n,e){let t=q(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),tm(t.remoteStore,r.targetId))}async function Ix(n,e,t){let r=Ax(n);try{let i=await(function(s,c){let u=q(s),l=Pe.now(),h=c.reduce((E,A)=>E.add(A.key),re()),p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let A=vn(),M=re();return u.Ns.getEntries(E,h).next(S=>{A=S,A.forEach((x,F)=>{F.isValidDocument()||(M=M.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,A)).next(S=>{p=S;let x=[];for(let F of c){let G=DP(F,p.get(F.key).overlayedDocument);G!=null&&x.push(new En(F.key,G,PT(G.value.mapValue),Br.exists(!0)))}return u.mutationQueue.addMutationBatch(E,l,x,c)}).next(S=>{m=S;let x=S.applyToLocalDocumentSet(p,M);return u.documentOverlayCache.saveOverlays(E,S.batchId,x)})}).then(()=>({batchId:m.batchId,changes:jT(p)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(s,c,u){let l=s.Vu[s.currentUser.toKey()];l||(l=new De(ne)),l=l.insert(c,u),s.Vu[s.currentUser.toKey()]=l})(r,i.batchId,t),await $s(r,i.changes),await zu(r.remoteStore)}catch(i){let o=om(i,"Failed to persist write");t.reject(o)}}async function yD(n,e){let t=q(n);try{let r=await ZP(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Au.get(o);s&&(ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?ue(s.hu,14607):i.removedDocuments.size>0&&(ue(s.hu,42227),s.hu=!1))}),await $s(t,r,e)}catch(r){await ro(r)}}function eT(n,e,t){let r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((o,s)=>{let c=s.view.va(e);c.snapshot&&i.push(c.snapshot)}),(function(s,c){let u=q(s);u.onlineState=c;let l=!1;u.queries.forEach((h,p)=>{for(let m of p.Sa)m.va(c)&&(l=!0)}),l&&sm(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wx(n,e,t){let r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),o=i&&i.key;if(o){let s=new De(B.comparator);s=s.insert(o,Pt.newNoDocument(o,K.min()));let c=re().add(o),u=new fu(K.min(),new Map,new De(ne),s,c);await yD(r,u),r.du=r.du.remove(o),r.Au.delete(e),cm(r)}else await dg(r.localStore,e,!1).then(()=>Pg(r,e,t)).catch(ro)}async function Tx(n,e){let t=q(n),r=e.batch.batchId;try{let i=await YP(t.localStore,e);vD(t,r,null),_D(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await $s(t,i)}catch(i){await ro(i)}}async function Dx(n,e,t){let r=q(n);try{let i=await(function(s,c){let u=q(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return u.mutationQueue.lookupMutationBatch(l,c).next(p=>(ue(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,h,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>u.localDocuments.getDocuments(l,h))})})(r.localStore,e);vD(r,e,t),_D(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await $s(r,i)}catch(i){await ro(i)}}function _D(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function vD(n,e,t){let r=q(n),i=r.Vu[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Pg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||ED(n,r)})}function ED(n,e){n.Eu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(tm(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),cm(n))}function tT(n,e,t){for(let r of t)r instanceof Au?(n.Ru.addReference(r.key,e),Cx(n,r)):r instanceof Nu?(k(am,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||ED(n,r.key)):V(19791,{wu:r})}function Cx(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(k(am,"New document in limbo: "+t),n.Eu.add(r),cm(n))}function cm(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new B(Ce.fromString(e)),r=n.fu.next();n.Au.set(r,new Rg(t)),n.du=n.du.insert(t,r),cD(n.remoteStore,new ks(en(Bu(t.path)),r,"TargetPurposeLimboResolution",zg.ce))}}async function $s(n,e,t){let r=q(n),i=[],o=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{s.push(r.pu(u,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let h=l?!l.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(l){i.push(l);let h=ag.As(u.targetId,l);o.push(h)}}))}),await Promise.all(s),r.Pu.H_(i),await(async function(u,l){let h=q(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>R.forEach(l,m=>R.forEach(m.Es,E=>h.persistence.referenceDelegate.addReference(p,m.targetId,E)).next(()=>R.forEach(m.ds,E=>h.persistence.referenceDelegate.removeReference(p,m.targetId,E)))))}catch(p){if(!io(p))throw p;k(em,"Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let E=h.Ms.get(m),A=E.snapshotVersion,M=E.withLastLimboFreeSnapshotVersion(A);h.Ms=h.Ms.insert(m,M)}}})(r.localStore,o))}async function bx(n,e){let t=q(n);if(!t.currentUser.isEqual(e)){k(am,"User change. New user:",e.toKey());let r=await sD(t.localStore,e);t.currentUser=e,(function(o,s){o.mu.forEach(c=>{c.forEach(u=>{u.reject(new L(N.CANCELLED,s))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $s(t,r.Ls)}}function Sx(n,e){let t=q(n),r=t.Au.get(e);if(r&&r.hu)return re().add(r.key);{let i=re(),o=t.Iu.get(e);if(!o)return i;for(let s of o){let c=t.Tu.get(s);i=i.unionWith(c.view.nu)}return i}}function ID(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=yD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Sx.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wx.bind(null,e),e.Pu.H_=px.bind(null,e.eventManager),e.Pu.yu=gx.bind(null,e.eventManager),e}function Ax(n){let e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Tx.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Dx.bind(null,e),e}var wD=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Hu(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return QP(this.persistence,new ug,t.initialUser,this.serializer)}Cu(t){return new _u(sg.mi,this.serializer)}Du(t){return new fg}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),xg=class extends wD{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ue(this.persistence.referenceDelegate instanceof vu,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Wp(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Et.withCacheSize(this.cacheSizeBytes):Et.DEFAULT;return new _u(r=>vu.mi(r,t),this.serializer)}};var Nx=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>eT(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bx.bind(null,this.syncEngine),await hx(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new bg})()}createDatastore(t){let r=Hu(t.databaseInfo.databaseId),i=(function(s){return new yg(s)})(t.databaseInfo);return(function(s,c,u,l){return new Ig(s,c,u,l)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,o,s,c,u){return new Tg(i,o,s,c,u)})(this.localStore,this.datastore,t.asyncQueue,r=>eT(this.syncEngine,r,0),(function(){return Iu.v()?new Iu:new hg})())}createSyncEngine(t,r){return(function(o,s,c,u,l,h,p){let m=new Mg(o,s,c,u,l,h);return p&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=q(r);k(Wr,"RemoteStore shutting down."),i.Ea.add(5),await Hs(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var Ru=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):gn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var er="FirestoreClient",kg=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ue.UNAUTHENTICATED,this.clientId=As.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async s=>{k(er,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(k(er,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Jt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=om(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function op(n,e){n.asyncQueue.verifyOperationInProgress(),k(er,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await sD(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function nT(n,e){n.asyncQueue.verifyOperationInProgress();let t=await Rx(n);k(er,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Zw(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Zw(e.remoteStore,i)),n._onlineComponents=e}async function Rx(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k(er,"Using user provided OfflineComponentProvider");try{await op(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;zi("Error using user provided cache. Falling back to memory cache: "+t),await op(n,new wD)}}else k(er,"Using default OfflineComponentProvider"),await op(n,new xg(void 0));return n._offlineComponents}async function TD(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(k(er,"Using user provided OnlineComponentProvider"),await nT(n,n._uninitializedComponentsProvider._online)):(k(er,"Using default OnlineComponentProvider"),await nT(n,new Nx))),n._onlineComponents}function Mx(n){return TD(n).then(e=>e.syncEngine)}async function Og(n){let e=await TD(n),t=e.eventManager;return t.onListen=mx.bind(null,e.syncEngine),t.onUnlisten=vx.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=yx.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Ex.bind(null,e.syncEngine),t}function Px(n,e,t={}){let r=new Jt;return n.asyncQueue.enqueueAndForget(async()=>(function(o,s,c,u,l){let h=new Ru({next:m=>{h.Nu(),s.enqueueAndForget(()=>gD(o,p));let E=m.docs.has(c);!E&&m.fromCache?l.reject(new L(N.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&m.fromCache&&u&&u.source==="server"?l.reject(new L(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Su(Bu(c.path),h,{includeMetadataChanges:!0,qa:!0});return pD(o,p)})(await Og(n),n.asyncQueue,e,t,r)),r.promise}function DD(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var rT=new Map;var CD="firestore.googleapis.com",iT=!0,Mu=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new L(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=CD,this.ssl=iT}else this.host=e.host,this.ssl=e.ssl??iT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=oD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<GP)throw new L(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DD(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new L(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new L(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new L(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Fs=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new sp;switch(r.type){case"firstParty":return new lp(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=rT.get(t);r&&(k("ComponentProvider","Removing Datastore"),rT.delete(t),r.terminate())})(this),Promise.resolve()}};function xx(n,e,t,r={}){n=Kn(n,Fs);let i=$n(e),o=n._getSettings(),s=ge(H({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;i&&($c(`https://${c}`),zc("Firestore",!0)),o.host!==CD&&o.host!==c&&zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u=ge(H({},o),{host:c,ssl:i,emulatorOptions:r});if(!Qt(u,s)&&(n._setSettings(u),r.mockUserToken)){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=Ue.MOCK_USER;else{l=QI(r.mockUserToken,n._app?.options.projectId);let p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new L(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ue(p)}n._authCredentials=new ap(new ru(l,h))}}var Pu=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ze=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(js(t,n._jsonSchema))return new n(e,r||null,new B(Ce.fromString(t.referencePath)))}};Ze._jsonSchemaVersion="firestore/documentReference/1.0",Ze._jsonSchema={type:Me("string",Ze._jsonSchemaVersion),referencePath:Me("string")};var Vs=class n extends Pu{constructor(e,t,r){super(e,t,Bu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Zr(n,e,...t){if(n=Qe(n),arguments.length===1&&(e=As.newId()),jM("doc","path",e),n instanceof Fs){let r=Ce.fromString(e,...t);return Dw(r),new Ze(n,null,new B(r))}{if(!(n instanceof Ze||n instanceof Vs))throw new L(N.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ce.fromString(e,...t));return Dw(r),new Ze(n.firestore,n instanceof Vs?n.converter:null,new B(r))}}var oT="AsyncQueue",xu=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new wu(this,"async_queue_retry"),this._c=()=>{let r=ip();r&&k(oT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=ip();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=ip();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Jt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!io(e))throw e;k(oT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,gn("INTERNAL UNHANDLED ERROR: ",sT(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=Dg.createAndSchedule(this,e,t,r,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&V(47125,{Pc:sT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function sT(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function aT(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}var Kr=class extends Fs{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new xu,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xu(e),this._firestoreClient=void 0,await e}}};function bD(n,e){let t=typeof n=="object"?n:Kc(),r=typeof n=="string"?n:e||cu,i=Is(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=KI("firestore");o&&xx(i,...o)}return i}function um(n){if(n._terminated)throw new L(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kx(n),n._firestoreClient}function kx(n){let e=n._freezeSettings(),t=(function(i,o,s,c){return new gp(i,o,s,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,DD(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new kg(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(n._componentsProvider))}var Qn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Je.fromBase64String(e))}catch(t){throw new L(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(js(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Qn._jsonSchemaVersion="firestore/bytes/1.0",Qn._jsonSchema={type:Me("string",Qn._jsonSchemaVersion),bytes:Me("string")};var Bs=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ft(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Us=class{constructor(e){this._methodName=e}};var Yn=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(js(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Yn._jsonSchemaVersion="firestore/geoPoint/1.0",Yn._jsonSchema={type:Me("string",Yn._jsonSchemaVersion),latitude:Me("number"),longitude:Me("number")};var Zn=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(js(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new L(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Zn._jsonSchemaVersion="firestore/vectorValue/1.0",Zn._jsonSchema={type:Me("string",Zn._jsonSchemaVersion),vectorValues:Me("object")};var Ox=/^__.*__$/,Lg=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new En(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gr(e,this.data,t,this.fieldTransforms)}};function SD(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw V(40011,{Ac:n})}}var Fg=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n(H(H({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ku(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(SD(this.Ac)&&Ox.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},Vg=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Hu(e)}Cc(e,t,r,i=!1){return new Fg({Ac:e,methodName:t,Dc:r,path:ft.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Lx(n){let e=n._freezeSettings(),t=Hu(n._databaseId);return new Vg(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Fx(n,e,t,r,i,o={}){let s=n.Cc(o.merge||o.mergeFields?2:0,e,t,i);MD("Data must be an object, but it was:",s,r);let c=ND(r,s),u,l;if(o.merge)u=new Zt(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=Vx(e,p,t);if(!s.contains(m))throw new L(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Ux(h,m)||h.push(m)}u=new Zt(h),l=s.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=s.fieldTransforms;return new Lg(new Mt(c),u,l)}var Bg=class n extends Us{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){let t=new qr(e.serializer,zT(e.serializer,this.Fc));return new Np(e.path,t)}isEqual(e){return e instanceof n&&this.Fc===e.Fc}};function AD(n,e){if(RD(n=Qe(n)))return MD("Unsupported field value:",e,n),ND(n,e);if(n instanceof Us)return(function(r,i){if(!SD(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){let o=[],s=0;for(let c of r){let u=AD(c,i.wc(s));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),s++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return zT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Pe.fromDate(r);return{timestampValue:mu(i.serializer,o)}}if(r instanceof Pe){let o=new Pe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:mu(i.serializer,o)}}if(r instanceof Yn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qn)return{bytesValue:JT(i.serializer,r._byteString)};if(r instanceof Ze){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Xg(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Zn)return(function(s,c){return{mapValue:{fields:{[Wg]:{stringValue:Kg},[Gi]:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw c.Sc("VectorValues must only contain numeric values.");return Jg(c.serializer,l)})}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${$g(r)}`)})(n,e)}function ND(n,e){let t={};return DT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qr(n,(r,i)=>{let o=AD(i,e.mc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function RD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pe||n instanceof Yn||n instanceof Qn||n instanceof Ze||n instanceof Us||n instanceof Zn)}function MD(n,e,t){if(!RD(t)||!uT(t)){let r=$g(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Vx(n,e,t){if((e=Qe(e))instanceof Bs)return e._internalPath;if(typeof e=="string")return PD(n,e);throw ku("Field path arguments must be of type string or ",n,!1,void 0,t)}var Bx=new RegExp("[~\\*/\\[\\]]");function PD(n,e,t){if(e.search(Bx)>=0)throw ku(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Bs(...e.split("."))._internalPath}catch{throw ku(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ku(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(o||s)&&(u+=" (found",o&&(u+=` in field ${r}`),s&&(u+=` in document ${i}`),u+=")"),new L(N.INVALID_ARGUMENT,c+n+u)}function Ux(n,e){return n.some(t=>t.isEqual(e))}var Ou=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ug(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(xD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ug=class extends Ou{data(){return super.data()}};function xD(n,e){return typeof e=="string"?PD(n,e):e instanceof Bs?e._internalPath:e._delegate._internalPath}function jx(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var jg=class{convertValue(e,t="none"){switch(Jn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ve(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw V(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Qr(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){let t=e.fields?.[Gi].arrayValue?.values?.map(r=>ve(r.doubleValue));return new Zn(t)}convertGeoPoint(e){return new Yn(ve(e.latitude),ve(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Vu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ms(e));default:return null}}convertTimestamp(e){let t=mn(e);return new Pe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ce.fromString(e);ue(iD(r),9688,{name:e});let i=new uu(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||gn(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Hx(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Vr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ur=class n extends Ou{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Hi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(xD("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Ur._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ur._jsonSchema={type:Me("string",Ur._jsonSchemaVersion),bundleSource:Me("string","DocumentSnapshot"),bundleName:Me("string"),bundle:Me("string")};var Hi=class extends Ur{data(e={}){return super.data(e)}},$i=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Vr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Hi(this._firestore,this._userDataWriter,r.key,r,new Vr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(c=>{let u=new Hi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Vr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{let u=new Hi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Vr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return c.type!==0&&(l=s.indexOf(c.doc.key),s=s.delete(c.doc.key)),c.type!==1&&(s=s.add(c.doc),h=s.indexOf(c.doc.key)),{type:$x(c.type),doc:u,oldIndex:l,newIndex:h}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=As.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function $x(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return V(61501,{type:n})}}function lm(n){n=Kn(n,Ze);let e=Kn(n.firestore,Kr);return Px(um(e),n._key).then(t=>OD(e,n,t))}$i._jsonSchemaVersion="firestore/querySnapshot/1.0",$i._jsonSchema={type:Me("string",$i._jsonSchemaVersion),bundleSource:Me("string","QuerySnapshot"),bundleName:Me("string"),bundle:Me("string")};var Lu=class extends jg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,t)}};function qu(n,e,t){n=Kn(n,Ze);let r=Kn(n.firestore,Kr),i=Hx(n.converter,e,t);return zx(r,[Fx(Lx(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Br.none())])}function kD(n,...e){n=Qe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||aT(e[r])||(t=e[r++]);let i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(aT(e[r])){let u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let o,s,c;if(n instanceof Ze)s=Kn(n.firestore,Kr),c=Bu(n._key.path),o={next:u=>{e[r]&&e[r](OD(s,n,u))},error:e[r+1],complete:e[r+2]};else{let u=Kn(n,Pu);s=Kn(u.firestore,Kr),c=u._query;let l=new Lu(s);o={next:h=>{e[r]&&e[r](new $i(s,l,u,h))},error:e[r+1],complete:e[r+2]},jx(n._query)}return(function(l,h,p,m){let E=new Ru(m),A=new Su(h,E,p);return l.asyncQueue.enqueueAndForget(async()=>pD(await Og(l),A)),()=>{E.Nu(),l.asyncQueue.enqueueAndForget(async()=>gD(await Og(l),A))}})(um(s),c,i,o)}function zx(n,e){return(function(r,i){let o=new Jt;return r.asyncQueue.enqueueAndForget(async()=>Ix(await Mx(r),i,o)),o.promise})(um(n),e)}function OD(n,e,t){let r=t.docs.get(e._key),i=new Lu(n);return new Ur(n,i,e._key,r,new Vr(t.hasPendingWrites,t.fromCache),e.converter)}function LD(n){return new Bg("increment",n)}(function(e,t=!0){(function(i){no=i})(Wn),Gn(new vt("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),c=new Kr(new cp(r.getProvider("auth-internal")),new dp(s,r.getProvider("app-check-internal")),(function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new L(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new uu(l.options.projectId,h)})(s,i),s);return o=H({useFetchStreams:t},o),c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),Rt(Iw,ww,e),Rt(Iw,ww,"esm2020")})();function JD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var XD=JD,eC=new dn("auth","Firebase",JD());var Zu=new zn("@firebase/auth");function qx(n,...e){Zu.logLevel<=te.WARN&&Zu.warn(`Auth (${Wn}): ${n}`,...e)}function Wu(n,...e){Zu.logLevel<=te.ERROR&&Zu.error(`Auth (${Wn}): ${n}`,...e)}function It(n,...e){throw xm(n,...e)}function xt(n,...e){return xm(n,...e)}function Pm(n,e,t){let r=ge(H({},XD()),{[e]:t});return new dn("auth","Firebase",r).create(e,{appName:n.name})}function Tn(n){return Pm(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Gx(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&It(n,"argument-error"),Pm(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xm(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return eC.create(n,...e)}function j(n,e,...t){if(!n)throw xm(e,...t)}function In(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Wu(e),new Error(e)}function Dn(n,e){n||In(e)}function hm(){return typeof self<"u"&&self.location?.href||""}function Wx(){return FD()==="http:"||FD()==="https:"}function FD(){return typeof self<"u"&&self.location?.protocol||null}function Kx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Wx()||JI()||"connection"in navigator)?navigator.onLine:!0}function Qx(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Jr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Dn(t>e,"Short delay should be less than long delay!"),this.isMobile=YI()||XI()}get(){return Kx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function km(n,e){Dn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ju=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;In("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;In("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;In("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Yx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Zx=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Jx=new Jr(3e4,6e4);function rr(n,e){return n.tenantId&&!e.tenantId?ge(H({},e),{tenantId:n.tenantId}):e}async function ir(n,e,t,r,i={}){return tC(n,i,async()=>{let o={},s={};r&&(e==="GET"?s=r:o={body:JSON.stringify(r)});let c=Pi(H({key:n.config.apiKey},s)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let l=H({method:e,headers:u},o);return ZI()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&$n(n.emulatorConfig.host)&&(l.credentials="include"),Ju.fetch()(await nC(n,n.config.apiHost,t,c),l)})}async function tC(n,e,t){n._canInitEmulator=!1;let r=H(H({},Yx),e);try{let i=new pm(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let s=await o.json();if("needConfirmation"in s)throw Gu(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let c=o.ok?s.errorMessage:s.error.message,[u,l]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gu(n,"credential-already-in-use",s);if(u==="EMAIL_EXISTS")throw Gu(n,"email-already-in-use",s);if(u==="USER_DISABLED")throw Gu(n,"user-disabled",s);let h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Pm(n,h,l);It(n,h)}}catch(i){if(i instanceof dt)throw i;It(n,"network-request-failed",{message:String(i)})}}async function Js(n,e,t,r,i={}){let o=await ir(n,e,t,r,i);return"mfaPendingCredential"in o&&It(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function nC(n,e,t,r){let i=`${e}${t}?${r}`,o=n,s=o.config.emulator?km(n.config,i):`${n.config.apiScheme}://${i}`;return Zx.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}function Xx(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var pm=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(xt(this.auth,"network-request-failed")),Jx.get())})}};function Gu(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=xt(n,e,r);return i.customData._tokenResponse=t,i}function VD(n){return n!==void 0&&n.enterprise!==void 0}var gm=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Xx(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function ek(n,e){return ir(n,"GET","/v2/recaptchaConfig",rr(n,e))}async function tk(n,e){return ir(n,"POST","/v1/accounts:delete",e)}async function Xu(n,e){return ir(n,"POST","/v1/accounts:lookup",e)}function qs(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rC(n,e=!1){let t=Qe(n),r=await t.getIdToken(e),i=Om(r);j(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:r,authTime:qs(dm(i.auth_time)),issuedAtTime:qs(dm(i.iat)),expirationTime:qs(dm(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function dm(n){return Number(n)*1e3}function Om(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Wu("JWT malformed, contained fewer than 3 sections"),null;try{let i=jc(t);return i?JSON.parse(i):(Wu("Failed to decode base64 JWT payload"),null)}catch(i){return Wu("Caught error parsing JWT payload as JSON",i?.toString()),null}}function BD(n){let e=Om(n);return j(e,"internal-error"),j(typeof e.exp<"u","internal-error"),j(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ws(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof dt&&nk(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function nk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var mm=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Ks=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qs(this.lastLoginAt),this.creationTime=qs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function el(n){let e=n.auth,t=await n.getIdToken(),r=await Ws(n,Xu(e,{idToken:t}));j(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let o=i.providerUserInfo?.length?oC(i.providerUserInfo):[],s=rk(n.providerData,o),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!s?.length,l=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ks(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(n,h)}async function iC(n){let e=Qe(n);await el(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rk(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function oC(n){return n.map(r=>{var i=r,{providerId:e}=i,t=ma(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function ik(n,e){let t=await tC(n,{},async()=>{let r=Pi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=await nC(n,i,"/v1/token",`key=${o}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&$n(n.emulatorConfig.host)&&(u.credentials="include"),Ju.fetch()(s,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function ok(n,e){return ir(n,"POST","/v2/accounts:revokeToken",rr(n,e))}var Gs=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){j(e.idToken,"internal-error"),j(typeof e.idToken<"u","internal-error"),j(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):BD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){j(e.length!==0,"internal-error");let t=BD(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:o}=await ik(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new n;return r&&(j(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(j(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(j(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return In("not implemented")}};function tr(n,e){j(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var nr=class n{constructor(o){var s=o,{uid:e,auth:t,stsTokenManager:r}=s,i=ma(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ks(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Ws(this,this.stsTokenManager.getToken(this.auth,e));return j(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return rC(this,e)}reload(){return iC(this)}_assign(e){this!==e&&(j(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>H({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(ge(H({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await el(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rt(this.auth.app))return Promise.reject(Tn(this.auth));let e=await this.getIdToken();return await Ws(this,tk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return ge(H({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>H({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,s=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,l=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:E,providerData:A,stsTokenManager:M}=t;j(p&&M,e,"internal-error");let S=Gs.fromJSON(this.name,M);j(typeof p=="string",e,"internal-error"),tr(r,e.name),tr(i,e.name),j(typeof m=="boolean",e,"internal-error"),j(typeof E=="boolean",e,"internal-error"),tr(o,e.name),tr(s,e.name),tr(c,e.name),tr(u,e.name),tr(l,e.name),tr(h,e.name);let x=new n({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:E,photoURL:s,phoneNumber:o,tenantId:c,stsTokenManager:S,createdAt:l,lastLoginAt:h});return A&&Array.isArray(A)&&(x.providerData=A.map(F=>H({},F))),u&&(x._redirectEventId=u),x}static async _fromIdTokenResponse(e,t,r=!1){let i=new Gs;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await el(o),o}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];j(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?oC(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,c=new Gs;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ks(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(u,l),u}};var UD=new Map;function wn(n){Dn(n instanceof Function,"Expected a class definition");let e=UD.get(n);return e?(Dn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,UD.set(n,e),e)}var sk=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ym=sk;function Ku(n,e,t){return`firebase:${n}:${e}:${t}`}var tl=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Ku(this.userKey,i.apiKey,o),this.fullPersistenceKey=Ku("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Xu(this.auth,{idToken:e}).catch(()=>{});return t?nr._fromGetAccountInfoResponse(this.auth,t,e):null}return nr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(wn(ym),e,r);let i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l),o=i[0]||wn(ym),s=Ku(r,e.config.apiKey,e.name),c=null;for(let l of t)try{let h=await l._get(s);if(h){let p;if(typeof h=="string"){let m=await Xu(e,{idToken:h}).catch(()=>{});if(!m)break;p=await nr._fromGetAccountInfoResponse(e,m,h)}else p=nr._fromJSON(e,h);l!==o&&(c=p),o=l;break}}catch{}let u=i.filter(l=>l._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new n(o,e,r):(o=u[0],c&&await o._set(s,c.toJSON()),await Promise.all(t.map(async l=>{if(l!==o)try{await l._remove(s)}catch{}})),new n(o,e,r))}};function jD(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(dC(e))return"Blackberry";if(fC(e))return"Webos";if(aC(e))return"Safari";if((e.includes("chrome/")||cC(e))&&!e.includes("edge/"))return"Chrome";if(lC(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function sC(n=Be()){return/firefox\//i.test(n)}function aC(n=Be()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cC(n=Be()){return/crios\//i.test(n)}function uC(n=Be()){return/iemobile/i.test(n)}function lC(n=Be()){return/android/i.test(n)}function dC(n=Be()){return/blackberry/i.test(n)}function fC(n=Be()){return/webos/i.test(n)}function Lm(n=Be()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ak(n=Be()){return Lm(n)&&!!window.navigator?.standalone}function ck(){return ew()&&document.documentMode===10}function hC(n=Be()){return Lm(n)||lC(n)||fC(n)||dC(n)||/windows phone/i.test(n)||uC(n)}function pC(n,e=[]){let t;switch(n){case"Browser":t=jD(Be());break;case"Worker":t=`${jD(Be())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wn}/${r}`}var _m=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((s,c)=>{try{let u=e(o);s(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function uk(n,e={}){return ir(n,"GET","/v2/passwordPolicy",rr(n,e))}var lk=6,vm=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??lk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var Em=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nl(this),this.idTokenSubscription=new nl(this),this.beforeStateQueue=new _m(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=eC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wn(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await tl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Xu(this,{idToken:e}),r=await nr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(rt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=this.redirectUser?._redirectEventId,s=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===s)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await el(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Qx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rt(this.app))return Promise.reject(Tn(this));let t=e?Qe(e):null;return t&&j(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&j(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rt(this.app)?Promise.reject(Tn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rt(this.app)?Promise.reject(Tn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await uk(this),t=new vm(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new dn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await ok(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&wn(e)||this._popupRedirectResolver;j(t,this,"argument-error"),this.redirectPersistenceManager=await tl.create(this,[wn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(c,this,"internal-error"),c.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{s=!0,u()}}else{let u=e.addObserver(t);return()=>{s=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(rt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&qx(`Error while retrieving App Check token: ${e.error}`),e?.token}};function or(n){return Qe(n)}var nl=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=iw(t=>this.observer=t)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var dl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dk(n){dl=n}function gC(n){return dl.loadJS(n)}function fk(){return dl.recaptchaEnterpriseScript}function hk(){return dl.gapiScript}function mC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var Im=class{constructor(){this.enterprise=new wm}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},wm=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var pk="recaptcha-enterprise",yC="NO_RECAPTCHA",Tm=class{constructor(e){this.type=pk,this.auth=or(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(s,c)=>{ek(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let l=new gm(u);return o.tenantId==null?o._agentRecaptchaConfig=l:o._tenantRecaptchaConfigs[o.tenantId]=l,s(l.siteKey)}}).catch(u=>{c(u)})})}function i(o,s,c){let u=window.grecaptcha;VD(u)?u.enterprise.ready(()=>{u.enterprise.execute(o,{action:e}).then(l=>{s(l)}).catch(()=>{s(yC)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Im().execute("siteKey",{action:"verify"}):new Promise((o,s)=>{r(this.auth).then(c=>{if(!t&&VD(window.grecaptcha))i(c,o,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let u=fk();u.length!==0&&(u+=c),gC(u).then(()=>{i(c,o,s)}).catch(l=>{s(l)})}}).catch(c=>{s(c)})})}};async function zs(n,e,t,r=!1,i=!1){let o=new Tm(n),s;if(i)s=yC;else try{s=await o.verify(t)}catch{s=await o.verify(t,!0)}let c=H({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let u=c.phoneEnrollmentInfo.phoneNumber,l=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:s}):Object.assign(c,{captchaResponse:s}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Dm(n,e,t,r,i){if(i==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let o=await zs(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let s=await zs(n,e,t,t==="getOobCode");return r(n,s)}else return Promise.reject(o)});else if(i==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let o=await zs(n,e,t);return r(n,o).catch(async s=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(s.code==="auth/missing-recaptcha-token"||s.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let c=await zs(n,e,t,!1,!0);return r(n,c)}return Promise.reject(s)})}else{let o=await zs(n,e,t,!1,!0);return r(n,o)}else return Promise.reject(i+" provider is not supported.")}function _C(n,e){let t=Is(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Qt(o,e??{}))return i;It(i,"already-initialized")}return t.initialize({options:e})}function gk(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(wn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function vC(n,e,t){let r=or(n);j(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=EC(e),{host:s,port:c}=mk(e),u=c===null?"":`:${c}`,l={url:`${o}//${s}${u}/`},h=Object.freeze({host:s,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){j(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),j(Qt(l,r.config.emulator)&&Qt(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,$n(s)?($c(`${o}//${s}${u}`),zc("Auth",!0)):i||yk()}function EC(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mk(n){let e=EC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:HD(r.substr(o.length+1))}}else{let[o,s]=r.split(":");return{host:o,port:HD(s)}}}function HD(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function yk(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var ao=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return In("not implemented")}_getIdTokenResponse(e){return In("not implemented")}_linkToIdToken(e,t){return In("not implemented")}_getReauthenticationResolver(e){return In("not implemented")}};async function _k(n,e){return ir(n,"POST","/v1/accounts:signUp",e)}async function vk(n,e){return Js(n,"POST","/v1/accounts:signInWithPassword",rr(n,e))}async function Ek(n,e){return Js(n,"POST","/v1/accounts:signInWithEmailLink",rr(n,e))}async function Ik(n,e){return Js(n,"POST","/v1/accounts:signInWithEmailLink",rr(n,e))}var Qs=class n extends ao{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dm(e,t,"signInWithPassword",vk,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Ek(e,{email:this._email,oobCode:this._password});default:It(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dm(e,r,"signUpPassword",_k,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Ik(e,{idToken:t,email:this._email,oobCode:this._password});default:It(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function so(n,e){return Js(n,"POST","/v1/accounts:signInWithIdp",rr(n,e))}var wk="http://localhost",rl=class n extends ao{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):It("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let c=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=c,o=ma(c,["providerId","signInMethod"]);if(!r||!i)return null;let s=new n(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return so(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,so(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,so(e,t)}buildRequest(){let e={requestUri:wk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Pi(t)}return e}};function Tk(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Dk(n){let e=xi(ki(n)).link,t=e?xi(ki(e)).deep_link_id:null,r=xi(ki(n)).deep_link_id;return(r?xi(ki(r)).link:null)||r||t||e||n}var il=class n{constructor(e){let t=xi(ki(e)),r=t.apiKey??null,i=t.oobCode??null,o=Tk(t.mode??null);j(r&&i&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t=Dk(e);try{return new n(t)}catch{return null}}};var IC=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Qs._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=il.parseLink(r);return j(i,"argument-error"),Qs._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Ys=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ol=class extends Ys{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Fm=(()=>{class n extends ol{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return rl._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();async function Ck(n,e){return Js(n,"POST","/v1/accounts:signUp",rr(n,e))}var co=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let o=await nr._fromIdTokenResponse(e,r,i),s=$D(r);return new n({user:o,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=$D(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function $D(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Cm=class n extends dt{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function wC(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Cm._fromErrorAndOperation(n,o,e,r):o})}async function bk(n,e,t=!1){let r=await Ws(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return co._forOperation(n,"link",r)}async function Sk(n,e,t=!1){let{auth:r}=n;if(rt(r.app))return Promise.reject(Tn(r));let i="reauthenticate";try{let o=await Ws(n,wC(r,i,e,n),t);j(o.idToken,r,"internal-error");let s=Om(o.idToken);j(s,r,"internal-error");let{sub:c}=s;return j(n.uid===c,r,"user-mismatch"),co._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&It(r,"user-mismatch"),o}}async function TC(n,e,t=!1){if(rt(n.app))return Promise.reject(Tn(n));let r="signIn",i=await wC(n,r,e),o=await co._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function DC(n,e){return TC(or(n),e)}async function CC(n){let e=or(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Vm(n,e,t){if(rt(n.app))return Promise.reject(Tn(n));let r=or(n),s=await Dm(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ck,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&CC(n),u}),c=await co._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(c.user),c}function Bm(n,e,t){return rt(n.app)?Promise.reject(Tn(n)):DC(Qe(n),IC.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&CC(n),r})}function bC(n,e,t,r){return Qe(n).onIdTokenChanged(e,t,r)}function SC(n,e,t){return Qe(n).beforeAuthStateChanged(e,t)}function Um(n,e,t,r){return Qe(n).onAuthStateChanged(e,t,r)}function jm(n){return Qe(n).signOut()}var sl="__sak";var al=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sl,"1"),this.storage.removeItem(sl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var Ak=1e3,Nk=10,Rk=(()=>{class n extends al{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hC(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,u,l)=>{this.notifyListeners(c,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},s=this.storage.getItem(i);ck()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,Nk):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},Ak)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),AC=Rk;var Mk=(()=>{class n extends al{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Hm=Mk;function Pk(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var xk=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:o,data:s}=r.data,c=this.handlersMap[o];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let u=Array.from(c).map(async h=>h(r.origin,s)),l=await Pk(u);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function $m(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var bm=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((c,u)=>{let l=$m("",20);i.port1.start();let h=setTimeout(()=>{u(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(p){let m=p;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(m.data.response);break;default:clearTimeout(h),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}};function on(){return window}function kk(n){on().location.href=n}function NC(){return typeof on().WorkerGlobalScope<"u"&&typeof on().importScripts=="function"}async function Ok(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Lk(){return navigator?.serviceWorker?.controller||null}function Fk(){return NC()?self:null}var RC="firebaseLocalStorageDb",Vk=1,cl="firebaseLocalStorage",MC="fbase_key",Xr=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function fl(n,e){return n.transaction([cl],e?"readwrite":"readonly").objectStore(cl)}function Bk(){let n=indexedDB.deleteDatabase(RC);return new Xr(n).toPromise()}function Sm(){let n=indexedDB.open(RC,Vk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(cl,{keyPath:MC})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(cl)?e(r):(r.close(),await Bk(),e(await Sm()))})})}async function zD(n,e,t){let r=fl(n,!0).put({[MC]:e,value:t});return new Xr(r).toPromise()}async function Uk(n,e){let t=fl(n,!1).get(e),r=await new Xr(t).toPromise();return r===void 0?null:r.value}function qD(n,e){let t=fl(n,!0).delete(e);return new Xr(t).toPromise()}var jk=800,Hk=3,$k=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sm(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>Hk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return NC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xk._getInstance(Fk()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Ok(),!this.activeServiceWorker)return;this.sender=new bm(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||Lk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await Sm();return await zD(t,sl,"1"),await qD(t,sl),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>zD(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>Uk(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>qD(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let s=fl(o,!1).getAll();return new Xr(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),PC=$k;var Z6=mC("rcb"),J6=new Jr(3e4,6e4);function xC(n,e){return e?wn(e):(j(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Zs=class extends ao{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return so(e,this._buildIdpRequest())}_linkToIdToken(e,t){return so(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return so(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function zk(n){return TC(n.auth,new Zs(n),n.bypassAuthState)}function qk(n){let{auth:e,user:t}=n;return j(t,e,"internal-error"),Sk(t,new Zs(n),n.bypassAuthState)}async function Gk(n){let{auth:e,user:t}=n;return j(t,e,"internal-error"),bk(t,new Zs(n),n.bypassAuthState)}var ul=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:c}=e;if(s){this.reject(s);return}let u={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zk;case"linkViaPopup":case"linkViaRedirect":return Gk;case"reauthViaPopup":case"reauthViaRedirect":return qk;default:It(this.auth,"internal-error")}}resolve(e){Dn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Dn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Wk=new Jr(2e3,1e4);async function zm(n,e,t){if(rt(n.app))return Promise.reject(xt(n,"operation-not-supported-in-this-environment"));let r=or(n);Gx(n,e,Ys);let i=xC(r,t);return new Kk(r,"signInViaPopup",e,i).executeNotNull()}var Kk=(()=>{class n extends ul{constructor(t,r,i,o,s){super(t,r,o,s),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return j(t,this.auth,"internal-error"),t}async onExecution(){Dn(this.filter.length===1,"Popup operations only handle one event");let t=$m();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(xt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(xt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Wk.get())};t()}}n.currentPopupAction=null;return n})(),Qk="pendingRedirect",Qu=new Map,Am=class extends ul{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Qu.get(this.auth._key());if(!e){try{let r=await Yk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Qu.set(this.auth._key(),e)}return this.bypassAuthState||Qu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function Yk(n,e){let t=Xk(e),r=Jk(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function Zk(n,e){Qu.set(n._key(),e)}function Jk(n){return wn(n._redirectPersistence)}function Xk(n){return Ku(Qk,n.config.apiKey,n.name)}async function e1(n,e,t=!1){if(rt(n.app))return Promise.reject(Tn(n));let r=or(n),i=xC(r,e),s=await new Am(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}var t1=600*1e3,Nm=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!n1(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!kC(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(xt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=t1&&this.cachedEventUids.clear(),this.cachedEventUids.has(GD(e))}saveEventToCache(e){this.cachedEventUids.add(GD(e)),this.lastProcessedEventTime=Date.now()}};function GD(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function kC({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function n1(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kC(n);default:return!1}}async function r1(n,e={}){return ir(n,"GET","/v1/projects",e)}var i1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o1=/^https?/;async function s1(n){if(n.config.emulator)return;let{authorizedDomains:e}=await r1(n);for(let t of e)try{if(a1(t))return}catch{}It(n,"unauthorized-domain")}function a1(n){let e=hm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!o1.test(t))return!1;if(i1.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var c1=new Jr(3e4,6e4);function WD(){let n=on().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function u1(n){return new Promise((e,t)=>{function r(){WD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{WD(),t(xt(n,"network-request-failed"))},timeout:c1.get()})}if(on().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(on().gapi?.load)r();else{let i=mC("iframefcb");return on()[i]=()=>{gapi.load?r():t(xt(n,"network-request-failed"))},gC(`${hk()}?onload=${i}`).catch(o=>t(o))}}).catch(e=>{throw Yu=null,e})}var Yu=null;function l1(n){return Yu=Yu||u1(n),Yu}var d1=new Jr(5e3,15e3),f1="__/auth/iframe",h1="emulator/auth/iframe",p1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},g1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function m1(n){let e=n.config;j(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?km(e,h1):`https://${n.config.authDomain}/${f1}`,r={apiKey:e.apiKey,appName:n.name,v:Wn},i=g1.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Pi(r).slice(1)}`}async function y1(n){let e=await l1(n),t=on().gapi;return j(t,n,"internal-error"),e.open({where:document.body,url:m1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:p1,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});let s=xt(n,"network-request-failed"),c=on().setTimeout(()=>{o(s)},d1.get());function u(){on().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{o(s)})}))}var _1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},v1=500,E1=600,I1="_blank",w1="http://localhost",ll=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function T1(n,e,t,r=v1,i=E1){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",u=ge(H({},_1),{width:r.toString(),height:i.toString(),top:o,left:s}),l=Be().toLowerCase();t&&(c=cC(l)?I1:t),sC(l)&&(e=e||w1,u.scrollbars="yes");let h=Object.entries(u).reduce((m,[E,A])=>`${m}${E}=${A},`,"");if(ak(l)&&c!=="_self")return D1(e||"",c),new ll(null);let p=window.open(e||"",c,h);j(p,n,"popup-blocked");try{p.focus()}catch{}return new ll(p)}function D1(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var C1="__/auth/handler",b1="emulator/auth/handler",S1=encodeURIComponent("fac");async function KD(n,e,t,r,i,o){j(n.config.authDomain,n,"auth-domain-config-required"),j(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Wn,eventId:i};if(e instanceof Ys){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",rw(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[h,p]of Object.entries(o||{}))s[h]=p}if(e instanceof ol){let h=e.getScopes().filter(p=>p!=="");h.length>0&&(s.scopes=h.join(","))}n.tenantId&&(s.tid=n.tenantId);let c=s;for(let h of Object.keys(c))c[h]===void 0&&delete c[h];let u=await n._getAppCheckToken(),l=u?`#${S1}=${encodeURIComponent(u)}`:"";return`${A1(n)}?${Pi(c).slice(1)}${l}`}function A1({config:n}){return n.emulator?km(n,b1):`https://${n.authDomain}/${C1}`}var fm="webStorageSupport",Rm=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Hm,this._completeRedirectFn=e1,this._overrideRedirectResult=Zk}async _openPopup(e,t,r,i){Dn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let o=await KD(e,t,r,hm(),i);return T1(e,o,$m())}async _openRedirect(e,t,r,i){await this._originValidation(e);let o=await KD(e,t,r,hm(),i);return kk(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Dn(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await y1(e),r=new Nm(e);return t.register("authEvent",i=>(j(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(fm,{type:fm},i=>{let o=i?.[0]?.[fm];o!==void 0&&t(!!o),It(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=s1(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return hC()||aC()||Lm()}},OC=Rm;var QD="@firebase/auth",YD="1.12.0";var Mm=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function N1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function R1(n){Gn(new vt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:c}=r.options;j(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:s,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pC(n)},l=new Em(r,i,o,u);return gk(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Gn(new vt("auth-internal",e=>{let t=or(e.getProvider("auth").getImmediate());return(r=>new Mm(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rt(QD,YD,N1(n)),Rt(QD,YD,"esm2020")}var M1=300,P1=Ph("authIdTokenMaxAge")||M1,ZD=null,x1=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>P1)return;let i=t?.token;ZD!==i&&(ZD=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function qm(n=Kc()){let e=Is(n,"auth");if(e.isInitialized())return e.getImmediate();let t=_C(n,{popupRedirectResolver:OC,persistence:[PC,AC,Hm]}),r=Ph("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let s=x1(o.toString());SC(t,s,()=>s(t.currentUser)),bC(t,c=>s(c))}}let i=Rh("auth");return i&&vC(t,`http://${i}`),t}function k1(){return document.getElementsByTagName("head")?.[0]??document}dk({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=xt("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",k1().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});R1("Browser");var LC={production:!0,firebaseConfig:{apiKey:"AIzaSyB_WSNJbHhEGi6EPYbBKJvlP-MH1nQ846Y",authDomain:"cross-plane-2f5de.firebaseapp.com",projectId:"cross-plane-2f5de",storageBucket:"cross-plane-2f5de.firebasestorage.app",messagingSenderId:"183248187868",appId:"1:183248187868:web:348f43d2a2c5e3e6f0df19"}};var O1=LC.firebaseConfig,sr=class n{constructor(){this.app=Kh(O1);this.db=bD(this.app);this.auth=qm(this.app);this.unsubscribe=null;this.sessionId="shared-grid";this.isSynced=me(!1);this.isLoading=me(!0);this.currentUser=me(null);Um(this.auth,e=>{this.currentUser.set(e)})}async saveCells(e){let t=Array.from(e.values()).filter(i=>i.confirmed),r=Zr(this.db,"grids",this.sessionId);await qu(r,{cells:t,updatedAt:new Date().toISOString()}),this.isSynced.set(!0)}async loadCells(){let e=Zr(this.db,"grids",this.sessionId),t=await lm(e);return t.exists()?t.data().cells||[]:[]}subscribeToChanges(e){let t=Zr(this.db,"grids",this.sessionId);this.unsubscribe=kD(t,r=>{if(r.exists()){let i=r.data();e(i?.cells||[])}})}destroy(){this.unsubscribe&&this.unsubscribe()}async signInWithGoogle(){let e=new Fm;try{await zm(this.auth,e)}catch(t){throw console.error("Error signing in with Google",t),t}}async loginEmail(e,t){await Bm(this.auth,e,t)}async registerEmail(e,t){await Vm(this.auth,e,t)}async signOut(){try{await jm(this.auth)}catch(e){throw console.error("Error signing out",e),e}}async saveUserData(e,t){let r=Zr(this.db,"users",e);await qu(r,t,{merge:!0})}async getUserData(e){let t=Zr(this.db,"users",e),r=await lm(t);return r.exists()?r.data():null}async incrementProfanityCount(){let e=this.currentUser();if(e)try{let t=Zr(this.db,"users",e.uid);await qu(t,{profanityAttempts:LD(1),lastProfanityAttempt:new Date().toISOString()},{merge:!0})}catch(t){console.warn("Failed to track profanity attempt:",t)}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}};var sn=class n{constructor(){this.cellsMap=new Map;this.firebase=W(sr);this.saveTimeout=null;this.isInitialized=!1;this.skipNextSync=!1;this.cells=me(new Map);this.viewportOffset=me({x:0,y:0});this.selectedCell=me(null);this.inputDirection=me("across");this.isLoading=me(!0);this.lastPlacedTime=me(0);this.wordsPlacedCount=me(0);let e=this.getCookie("cross_plane_last_placed");e&&this.lastPlacedTime.set(parseInt(e,10));let t=this.getCookie("cross_plane_words_placed");t&&this.wordsPlacedCount.set(parseInt(t,10)),this.loadFromFirebase(),this.firebase.subscribeToChanges(r=>{this.handleRemoteUpdate(r)}),qt(()=>{let r=this.cells();if(this.isInitialized){if(this.skipNextSync){this.skipNextSync=!1;return}this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.saveToFirebase()},1e3)}}),qt(()=>{let r=this.lastPlacedTime();r>0&&this.setCookie("cross_plane_last_placed",r.toString(),365)}),qt(()=>{let r=this.wordsPlacedCount();this.setCookie("cross_plane_words_placed",r.toString(),365);let i=Qo(()=>this.firebase.currentUser());i&&this.firebase.saveUserData(i.uid,{wordsPlacedCount:r})}),qt(()=>{let r=this.firebase.currentUser();r&&this.syncUserStats(r.uid)})}async syncUserStats(e){if(!this.skipNextSync)try{let t=await this.firebase.getUserData(e),r=this.wordsPlacedCount();if(t&&typeof t.wordsPlacedCount=="number"){let i=t.wordsPlacedCount;i>r?this.wordsPlacedCount.set(i):r>i&&this.firebase.saveUserData(e,{wordsPlacedCount:r})}else r>0&&this.firebase.saveUserData(e,{wordsPlacedCount:r})}catch(t){console.error("Error syncing user stats",t)}}resetUserStats(){this.wordsPlacedCount.set(0),this.setCookie("cross_plane_words_placed","0",365)}setCookie(e,t,r){let i="";if(r){let o=new Date;o.setTime(o.getTime()+r*24*60*60*1e3),i="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+i+"; path=/"}getCookie(e){let t=e+"=",r=document.cookie.split(";");for(let i=0;i<r.length;i++){let o=r[i];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(t)===0)return o.substring(t.length,o.length)}return null}handleRemoteUpdate(e){let t=new Map;e.forEach(r=>{let i=`${r.x},${r.y} `;t.set(i,r)}),(this.cellsMap.size!==t.size||!this.mapsEqual(this.cellsMap,t))&&(this.skipNextSync=!0,this.cellsMap=t,this.cells.set(new Map(this.cellsMap)),console.log("Grid updated from Firebase (real-time sync)"))}mapsEqual(e,t){if(e.size!==t.size)return!1;for(let[r,i]of e){let o=t.get(r);if(!o||i.char!==o.char||i.confirmed!==o.confirmed)return!1}return!0}async loadFromFirebase(){try{let e=await this.firebase.loadCells();e.length>0?(e.forEach(t=>{let r=`${t.x},${t.y} `;this.cellsMap.set(r,t)}),this.cells.set(new Map(this.cellsMap))):this.initializeDefault()}catch(e){console.error("Failed to load from Firebase - Check Firestore Rules in Console!",e),this.initializeDefault()}finally{this.isLoading.set(!1),this.isInitialized=!0}}initializeDefault(){this.setCell(-5,0,"C",!0),this.setCell(-4,0,"R",!0),this.setCell(-3,0,"O",!0),this.setCell(-2,0,"S",!0),this.setCell(-1,0,"S",!0),this.setCell(0,0,".",!0),this.setCell(1,0,"P",!0),this.setCell(2,0,"L",!0),this.setCell(3,0,"A",!0),this.setCell(4,0,"N",!0),this.setCell(5,0,"E",!0)}async saveToFirebase(){try{await this.firebase.saveCells(this.cellsMap),console.log("Grid saved to Firebase")}catch(e){console.error("Failed to save to Firebase - Check Firestore Rules in Console!",e)}}getCell(e,t){return this.cellsMap.get(`${e},${t} `)}setCell(e,t,r,i){let o=`${e},${t} `;this.cellsMap.set(o,{x:e,y:t,char:r.toUpperCase(),confirmed:i}),this.cells.set(new Map(this.cellsMap))}removeCell(e,t){let r=`${e},${t} `;this.cellsMap.has(r)&&(this.cellsMap.delete(r),this.cells.set(new Map(this.cellsMap)))}isBlackSquare(e,t){if(Math.abs(e)<6&&Math.abs(t)<6)return!1;let r=Math.sin(e*12.9898+t*78.233)*43758.5453123%1;return Math.abs(r)>.88}isValidSlot(e,t){return!this.isBlackSquare(e,t)}incrementWordsPlaced(){this.wordsPlacedCount.update(e=>e+1)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}};var hl=class n{constructor(e){this.grid=e;this.ngZone=W(qe);this.animationFrameId=null;this.needsRender=!0;this.CELL_SIZE=40}setCanvas(e){this.canvasElement=e,this.ctx=e.getContext("2d"),this.resizeCanvas()}resizeCanvas(){if(!this.canvasElement)return;let e=window.devicePixelRatio||1,t=window.innerWidth,r=window.innerHeight;this.canvasElement.width=t*e,this.canvasElement.height=r*e,this.canvasElement.style.width=t+"px",this.canvasElement.style.height=r+"px",this.ctx.scale(e,e),this.requestRender()}requestRender(){this.needsRender=!0}startRenderLoop(e){this.ngZone.runOutsideAngular(()=>{let t=()=>{this.needsRender&&(this.renderCanvas(e()),this.needsRender=!1),this.animationFrameId=requestAnimationFrame(t)};t()})}stopRenderLoop(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}renderCanvas(e){if(!this.ctx)return;let t=this.ctx,r=window.innerWidth,i=window.innerHeight,{zoomLevel:o,theme:s,font:c,showText:u,pendingWords:l}=e,h=s.colors;t.clearRect(0,0,r,i),t.fillStyle=h.bg,t.fillRect(0,0,r,i);let p=this.grid.viewportOffset(),m=this.CELL_SIZE*o,E=r/2+p.x,A=i/2+p.y,M=Math.floor(-E/m)-1,S=Math.ceil((r-E)/m)+1,x=Math.floor(-A/m)-1,F=Math.ceil((i-A)/m)+1;t.strokeStyle=h.gridLines,t.lineWidth=1;for(let y=M;y<=S;y++){let _=E+y*m;t.beginPath(),t.moveTo(_,0),t.lineTo(_,i),t.stroke()}for(let y=x;y<=F;y++){let _=A+y*m;t.beginPath(),t.moveTo(0,_),t.lineTo(r,_),t.stroke()}t.fillStyle=h.blackSquare;for(let y=M;y<=S;y++)for(let _=x;_<=F;_++)if(this.grid.isBlackSquare(y,_)){let w=E+y*m,I=A+_*m;t.fillRect(w+.5,I+.5,m-1,m-1)}let G=this.grid.selectedCell(),be=Math.max(8,Math.floor(m*.55));t.font=`bold ${be}px ${c.fontFamily}`,t.textAlign="center",t.textBaseline="middle";let xe=(S-M)*(F-x),Se=this.grid.cells().size;if(xe<Se*2)for(let y=M;y<=S;y++)for(let _=x;_<=F;_++){let w=this.grid.getCell(y,_);w&&this.drawCell(t,w,E,A,m,h,u,G)}else this.grid.cells().forEach(y=>{y.x<M||y.x>S||y.y<x||y.y>F||this.drawCell(t,y,E,A,m,h,u,G)});if(l.forEach(y=>{let _=E+y.x*m,w=A+y.y*m;if(!(_+m<0||_>r||w+m<0||w>i))if(u){let I=G&&G.x===y.x&&G.y===y.y;t.fillStyle=I?h.selectionBg:h.confirmedBg,t.fillRect(_+1,w+1,m-2,m-2),t.strokeStyle=h.pendingBorder,t.lineWidth=1,t.strokeRect(_+1,w+1,m-2,m-2),t.fillStyle=h.pendingText,t.fillText(y.char,_+m/2,w+m/2+1)}else t.fillStyle=h.pendingBg,t.fillRect(_+1,w+1,m-2,m-2)}),G&&u){let y=E+G.x*m-1,_=A+G.y*m-1;t.strokeStyle=h.selectionBorder,t.lineWidth=3,t.strokeRect(y,_,m+2,m+2),t.shadowColor=h.selectionShadow,t.shadowBlur=10,t.strokeRect(y,_,m+2,m+2),t.shadowBlur=0;let w=this.grid.inputDirection()==="across",I=Math.max(12,m*.35);if(t.fillStyle=h.selectionBorder,t.beginPath(),w){let C=y+m+8,v=_+m/2;t.moveTo(C,v-I/2),t.lineTo(C+I,v),t.lineTo(C,v+I/2)}else{let C=y+m/2,v=_+m+8;t.moveTo(C-I/2,v),t.lineTo(C,v+I),t.lineTo(C+I/2,v)}t.fill()}}drawCell(e,t,r,i,o,s,c,u){let l=r+t.x*o,h=i+t.y*o;if(c){let p=u&&u.x===t.x&&u.y===t.y,m=t.y===0&&Math.abs(t.x)<=5&&t.x!==0;p?e.fillStyle=s.selectionBg:m?e.fillStyle=s.startWordBg:e.fillStyle=s.confirmedBg,e.fillRect(l+1,h+1,o-2,o-2),m&&!p?e.strokeStyle=s.startWordBorder:e.strokeStyle=s.confirmedBorder,e.lineWidth=1,e.strokeRect(l+1,h+1,o-2,o-2),e.fillStyle=s.confirmedText,e.fillText(t.char,l+o/2,h+o/2+1)}else e.fillStyle=s.zoomedOutCell,e.fillRect(l,h,o,o)}static{this.\u0275fac=function(t){return new(t||n)(oe(sn))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}};var pl=class n{constructor(e){this.grid=e;this.isPanning=!1;this.startX=0;this.startY=0;this.startOffsetX=0;this.startOffsetY=0;this.zoomLevel=me(1);this.MIN_ZOOM=.03;this.MAX_ZOOM=2;this.isPinching=!1;this.initialPinchDist=0;this.startZoom=1}setZoom(e,t,r,i,o){let s=this.zoomLevel(),c=this.grid.viewportOffset(),u=Math.min(Math.max(e,this.MIN_ZOOM),this.MAX_ZOOM);if(u===s)return;let l=t-i/2,h=r-o/2,p=u/s,m=l-(l-c.x)*p,E=h-(h-c.y)*p;this.grid.viewportOffset.set({x:m,y:E}),this.zoomLevel.set(u)}zoomIn(e,t){this.setZoom(this.zoomLevel()*1.2,e/2,t/2,e,t)}zoomOut(e,t){this.setZoom(this.zoomLevel()/1.2,e/2,t/2,e,t)}handleWheel(e){e.preventDefault();let i=1+-e.deltaY*.001;i>1.15&&(i=1.15),i<.85&&(i=.85);let o=this.zoomLevel()*i;this.setZoom(o,e.clientX,e.clientY,window.innerWidth,window.innerHeight)}startPan(e){e.button===0&&(this.isPanning=!0,this.startX=e.clientX,this.startY=e.clientY,this.startOffsetX=this.grid.viewportOffset().x,this.startOffsetY=this.grid.viewportOffset().y)}startPanTouch(e){if(e.touches.length===2){this.isPinching=!0,this.isPanning=!1,this.initialPinchDist=this.getDist(e.touches),this.startZoom=this.zoomLevel();return}e.touches.length===1&&(this.isPanning=!0,this.isPinching=!1,this.startX=e.touches[0].clientX,this.startY=e.touches[0].clientY,this.startOffsetX=this.grid.viewportOffset().x,this.startOffsetY=this.grid.viewportOffset().y)}handlePan(e){if(!this.isPanning)return;let t=e.clientX-this.startX,r=e.clientY-this.startY;this.grid.viewportOffset.set({x:this.startOffsetX+t,y:this.startOffsetY+r})}handlePanTouch(e){if(this.isPinching&&e.touches.length===2){let r=this.getDist(e.touches)/this.initialPinchDist,i=(e.touches[0].clientX+e.touches[1].clientX)/2,o=(e.touches[0].clientY+e.touches[1].clientY)/2,s=this.startZoom*r;this.setZoom(s,i,o,window.innerWidth,window.innerHeight),e.preventDefault();return}if(this.isPanning&&e.touches.length===1){let t=e.touches[0].clientX-this.startX,r=e.touches[0].clientY-this.startY;this.grid.viewportOffset.set({x:this.startOffsetX+t,y:this.startOffsetY+r}),e.cancelable&&e.preventDefault()}}endPan(){this.isPanning=!1,this.isPinching=!1}getDist(e){let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)}screenToGrid(e,t,r){let i=this.zoomLevel(),o=this.grid.viewportOffset(),s=r*i,c=window.innerWidth/2+o.x,u=window.innerHeight/2+o.y,l=Math.floor((e-c)/s),h=Math.floor((t-u)/s);return{x:l,y:h}}static{this.\u0275fac=function(t){return new(t||n)(oe(sn))}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}};var Wm=[{id:"classic",name:"Classic",buttonColor:"#ffffff",unlockCount:0,colors:{bg:"#ffffff",gridLines:"rgba(100, 100, 100, 0.1)",blackSquare:"#000000",text:"#000000",confirmedBg:"#ffffff",confirmedText:"#000000",confirmedBorder:"rgba(0, 0, 0, 0.1)",startWordBg:"#fef9c3",startWordBorder:"rgba(0, 0, 0, 0.1)",zoomedOutCell:"rgba(0, 0, 0, 0.1)",pendingBg:"#ffffff",pendingText:"#2563eb",pendingBorder:"rgba(13, 0, 56, 0.1)",selectionBg:"#dbeafe",selectionBorder:"#2563eb",selectionShadow:"rgba(0, 0, 255, 0.4)"}},{id:"dark",name:"Dark Mode",buttonColor:"#1f2937",unlockCount:5,colors:{bg:"#1f2937",gridLines:"rgba(100, 100, 100, 0.2)",blackSquare:"#111827",text:"#e5e7eb",confirmedBg:"#1f2937",confirmedText:"#e5e7eb",confirmedBorder:"rgba(100, 100, 100, 0.3)",startWordBg:"#374151",startWordBorder:"#4b5563",zoomedOutCell:"#374151",pendingBg:"#1f2937",pendingText:"#9ca3af",pendingBorder:"#4b5563",selectionBg:"#312e81",selectionBorder:"#6366f1",selectionShadow:"rgba(99, 102, 241, 0.4)"}},{id:"paper",name:"Old Paper",buttonColor:"#f5ebe0",unlockCount:10,colors:{bg:"#f5ebe0",gridLines:"rgba(100, 100, 100, 0.1)",blackSquare:"#4a3b32",text:"#3e2723",confirmedBg:"#f5ebe0",confirmedText:"#3e2723",confirmedBorder:"rgba(100, 100, 100, 0.1)",startWordBg:"#e6ccb2",startWordBorder:"rgba(100, 100, 100, 0.1)",zoomedOutCell:"#e6ccb2",pendingBg:"#f5ebe0",pendingText:"#92400e",pendingBorder:"rgba(100, 100, 100, 0.1)",selectionBg:"#e8d9cc",selectionBorder:"#7f5539",selectionShadow:"rgba(69, 26, 3, 0.2)"}},{id:"midnight",name:"Midnight",buttonColor:"#020617",unlockCount:15,colors:{bg:"#0f172a",gridLines:"rgba(59, 130, 246, 0.1)",blackSquare:"#020617",text:"#97a2b1ff",confirmedBg:"#0f172a",confirmedText:"#cbd5e1",confirmedBorder:"rgba(59, 130, 246, 0.2)",startWordBg:"#1e293b",startWordBorder:"#334155",zoomedOutCell:"rgba(59, 130, 246, 0.2)",pendingBg:"#0f172a",pendingText:"#64748b",pendingBorder:"#1e293b",selectionBg:"#172554",selectionBorder:"#3b82f6",selectionShadow:"rgba(59, 130, 246, 0.4)"}},{id:"matrix",name:"Matrix",buttonColor:"#00ff41",unlockCount:10,colors:{bg:"#000000",gridLines:"#003300",blackSquare:"#00ff41",text:"#00ff41",confirmedBg:"#000000",confirmedText:"#00ff41",confirmedBorder:"#003300",startWordBg:"#001a00",startWordBorder:"#003300",zoomedOutCell:"rgba(0, 255, 65, 0.3)",pendingBg:"#000000",pendingText:"#008f11",pendingBorder:"#003300",selectionBg:"#002200",selectionBorder:"#00ff41",selectionShadow:"rgba(0, 255, 65, 0.2)"}},{id:"blueprint",name:"Blueprint",buttonColor:"#3555a1",unlockCount:20,colors:{bg:"#3555a1",gridLines:"rgba(255, 255, 255, 0.1)",blackSquare:"#25397b",text:"#ffffff",confirmedBg:"#3555a1",confirmedText:"#ffffff",confirmedBorder:"rgba(255, 255, 255, 0.2)",startWordBg:"#476bb4",startWordBorder:"#476bb4",zoomedOutCell:"rgba(255, 255, 255, 0.2)",pendingBg:"#3555a1",pendingText:"#ffffff",pendingBorder:"#ffffff",selectionBg:"#506bae",selectionBorder:"#ffffff",selectionShadow:"rgba(255, 255, 255, 0.3)"}},{id:"neon",name:"Cyberpunk",buttonColor:"#e879f9",unlockCount:100,colors:{bg:"#090014",gridLines:"rgba(217, 70, 239, 0.3)",blackSquare:"#742f80ff",text:"#100f10ff",confirmedBg:"#090014",confirmedText:"#e879f9",confirmedBorder:"rgba(217, 70, 239, 0.3)",startWordBg:"#180024",startWordBorder:"#e879f9",zoomedOutCell:"#e879f9",pendingBg:"#090014",pendingText:"#86198f",pendingBorder:"#e879f9",selectionBg:"#4a044e",selectionBorder:"#f0abfc",selectionShadow:"rgba(217, 70, 239, 0.6)"}}];var Km=[{id:"classic",name:"Classic",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",unlockCount:0},{id:"hand",name:"Hand",fontFamily:'"Patrick Hand", cursive',unlockCount:5},{id:"serif",name:"Serif",fontFamily:'ui-serif, Georgia, Cambria, "Times New Roman", Times, serif',unlockCount:15},{id:"pixel",name:"Pixel",fontFamily:'"Pixelify Sans", monospace',unlockCount:40},{id:"newspaper",name:"Newspaper",fontFamily:'"Playfair Display", serif',unlockCount:30},{id:"marker",name:"Marker",fontFamily:'"Permanent Marker", cursive',unlockCount:75},{id:"gothic",name:"Gothic",fontFamily:'"UnifrakturMaguntia", cursive',unlockCount:100}];var Qm=3e4,uo=class n{constructor(){this.firebaseService=W(sr);this.lastProfanityTime=0;this.profanityCooldownEnd=me(0)}isInProfanityCooldown(){return this.firebaseService.currentUser()?!1:Date.now()<this.lastProfanityTime+Qm}getProfanityCooldownRemaining(){return this.isInProfanityCooldown()?this.lastProfanityTime+Qm-Date.now():0}async validateWord(e){try{if(this.isInProfanityCooldown())return{valid:!1,definition:"",reason:`Please wait ${Math.ceil(this.getProfanityCooldownRemaining()/1e3)}s before trying again`};if(await this.checkProfanity(e))return this.firebaseService.currentUser()?this.firebaseService.incrementProfanityCount():(this.lastProfanityTime=Date.now(),this.profanityCooldownEnd.set(this.lastProfanityTime+Qm)),{valid:!1,definition:"",reason:`"${e.toUpperCase()}" not found in dictionary`};let r=await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${e.toLowerCase()}`);if(r.status===404)return{valid:!1,definition:"",reason:`"${e.toUpperCase()}" not found in dictionary`};if(!r.ok)throw new Error("Dictionary API error");let i=await r.json(),o="No definition found.";if(Array.isArray(i)&&i.length>0){let s=i[0];if(s.meanings&&s.meanings.length>0){let c=s.meanings[0];c.definitions&&c.definitions.length>0&&(o=c.definitions[0].definition)}}return{valid:!0,definition:o}}catch(t){return console.error("Dictionary validation error:",t),{valid:!1,definition:"",reason:"Validation service unavailable"}}}async checkProfanity(e){try{let t=await fetch(`https://www.purgomalum.com/service/containsprofanity?text=${encodeURIComponent(e.toLowerCase())}`);return t.ok?await t.text()==="true":(console.warn("Profanity check failed, allowing word through"),!1)}catch(t){return console.warn("Profanity API unavailable:",t),!1}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}};var F1=["progressPath"];function V1(n,e){n&1&&(O(0,"div",36),we(1,"div",37),U())}function B1(n,e){n&1&&(O(0,"div",38),We(),O(1,"svg",39),we(2,"circle",40)(3,"path",41),U(),zt(),O(4,"span",42),Ae(5,"Validating..."),U()())}function U1(n,e){if(n&1&&(O(0,"div",43),Ae(1),U()),n&2){let t=Te();Ri("text-red-500",t.isError)("text-green-600",!t.isError),le(),us(" ",t.validationMessage," ")}}function j1(n,e){if(n&1){let t=_t();O(0,"button",44),Ee("click",function(){J(t);let i=Te();return X(i.toggleAuthMenu())}),We(),O(1,"svg",25),we(2,"path",45),U()()}}function H1(n,e){if(n&1&&(O(0,"div",62),Ae(1),U()),n&2){let t=Te(2);le(),Hn(t.authError)}}function $1(n,e){if(n&1&&(O(0,"span"),Ae(1),U()),n&2){let t=Te(2);le(),Hn(t.isRegisterMode?"Sign Up":"Log In")}}function z1(n,e){n&1&&(We(),O(0,"svg",63),we(1,"circle",40)(2,"path",41),U())}function q1(n,e){if(n&1){let t=_t();O(0,"span"),Ae(1,"Need an account? "),O(2,"button",64),Ee("click",function(){J(t);let i=Te(2);return i.isRegisterMode=!0,X(i.authError="")}),Ae(3,"Sign up"),U()()}}function G1(n,e){if(n&1){let t=_t();O(0,"span"),Ae(1,"Values account? "),O(2,"button",64),Ee("click",function(){J(t);let i=Te(2);return i.isRegisterMode=!1,X(i.authError="")}),Ae(3,"Log in"),U()()}}function W1(n,e){if(n&1){let t=_t();O(0,"div",46)(1,"h3",47),Ae(2),U(),O(3,"div",48)(4,"input",49,1),Ee("keydown",function(i){return J(t),X(i.stopPropagation())})("keyup.enter",function(){J(t);let i=kr(7);return X(i.focus())}),U(),O(6,"input",50,2),Ee("keydown",function(i){return J(t),X(i.stopPropagation())})("keyup.enter",function(){J(t);let i=kr(5),o=kr(7),s=Te();return X(s.handleAuth(i.value,o.value))}),U(),Ke(8,H1,2,1,"div",51),O(9,"button",52),Ee("click",function(){J(t);let i=kr(5),o=kr(7),s=Te();return X(s.handleAuth(i.value,o.value))}),Ke(10,$1,2,1,"span",53)(11,z1,3,0,"svg",54),U()(),O(12,"div",55),we(13,"div",56),O(14,"span",57),Ae(15,"OR"),U(),we(16,"div",56),U(),O(17,"button",58),Ee("click",function(){J(t);let i=Te();return X(i.signInGoogle())}),We(),O(18,"svg",59),we(19,"path",60),U(),Ae(20," Google "),U(),zt(),O(21,"div",61),Ke(22,q1,4,0,"span",53)(23,G1,4,0,"span",53),U()()}if(n&2){let t=Te();le(2),Hn(t.isRegisterMode?"Create Account":"Welcome Back"),le(6),he("ngIf",t.authError),le(2),he("ngIf",!t.isAuthLoading),le(),he("ngIf",t.isAuthLoading),le(11),he("ngIf",!t.isRegisterMode),le(),he("ngIf",t.isRegisterMode)}}function K1(n,e){if(n&1&&we(0,"img",71),n&2){let t,r=Te(2);he("src",(t=r.currentUser())==null?null:t.photoURL,Bf)}}function Q1(n,e){if(n&1&&(O(0,"span",72),Ae(1),U()),n&2){let t,r=Te(2);le(),Hn(((t=r.currentUser())==null||t.displayName==null?null:t.displayName.charAt(0))||"U")}}function Y1(n,e){if(n&1){let t=_t();O(0,"button",65),Ee("click",function(){J(t);let i=Te();return X(i.signOut())}),Ke(1,K1,1,1,"img",66)(2,Q1,2,1,"span",67),O(3,"div",68),We(),O(4,"svg",69),we(5,"path",70),U()()()}if(n&2){let t,r,i,o=Te();he("title",((t=o.currentUser())==null?null:t.displayName)||"Sign Out"),le(),he("ngIf",(r=o.currentUser())==null?null:r.photoURL),le(),he("ngIf",!((i=o.currentUser())!=null&&i.photoURL))}}function Z1(n,e){n&1&&(We(),O(0,"svg",80),we(1,"path",81),U())}function J1(n,e){if(n&1){let t=_t();O(0,"button",78),Ee("click",function(){let i=J(t).$implicit,o=Te(2);return X(o.selectTheme(i))}),Ke(1,Z1,2,0,"svg",79),U()}if(n&2){let t=e.$implicit,r=Te(2);cs("background-color",t.buttonColor)("border-color",t.colors.confirmedBorder),Ri("ring-2",r.activeTheme.id===t.id)("ring-offset-1",r.activeTheme.id===t.id)("ring-blue-500",r.activeTheme.id===t.id)("opacity-50",r.wordsPlacedCount<t.unlockCount),he("title",r.wordsPlacedCount<t.unlockCount?"Unlock at "+t.unlockCount+" words":t.name),le(),he("ngIf",r.wordsPlacedCount<t.unlockCount)}}function X1(n,e){if(n&1&&(O(0,"span",84),Ae(1,"Ag"),U()),n&2){let t=Te().$implicit;cs("font-family",t.fontFamily)}}function eO(n,e){n&1&&(We(),O(0,"svg",80),we(1,"path",81),U())}function tO(n,e){if(n&1){let t=_t();O(0,"button",82),Ee("click",function(){let i=J(t).$implicit,o=Te(2);return X(o.selectFont(i))}),Ke(1,X1,2,2,"span",83)(2,eO,2,0,"svg",79),U()}if(n&2){let t=e.$implicit,r=Te(2);Ri("ring-2",r.activeFont.id===t.id)("ring-offset-1",r.activeFont.id===t.id)("ring-blue-500",r.activeFont.id===t.id)("opacity-50",r.wordsPlacedCount<t.unlockCount),he("title",r.wordsPlacedCount<t.unlockCount?"Unlock at "+t.unlockCount+" words":t.name),le(),he("ngIf",r.wordsPlacedCount>=t.unlockCount),le(),he("ngIf",r.wordsPlacedCount<t.unlockCount)}}function nO(n,e){if(n&1&&(O(0,"div",73)(1,"div",74),Ke(2,J1,2,14,"button",75),U(),we(3,"div",76),O(4,"div",74),Ke(5,tO,3,11,"button",77),U()()),n&2){let t=Te();le(2),he("ngForOf",t.themes),le(3),he("ngForOf",t.fonts)}}var gl=class n{constructor(){this.lastPlacedTime=0;this.cooldownMs=15e3;this.wordsPlacedCount=0;this.isValidating=!1;this.validationMessage="";this.isError=!1;this.themes=[];this.fonts=[];this.themeSelected=new ze;this.fontSelected=new ze;this.zoomIn=new ze;this.zoomOut=new ze;this.resetView=new ze;this.sharePosition=new ze;this.ngZone=W(qe);this.firebaseService=W(sr);this.gridStore=W(sn);this.dictService=W(uo);this.currentUser=this.firebaseService.currentUser;this.animationFrameId=null;this.cooldownProgress=1;this.isThemeMenuOpen=!1;this.isAuthMenuOpen=!1;this.isRegisterMode=!1;this.isAuthLoading=!1;this.authError=""}toggleAuthMenu(){this.isAuthMenuOpen=!this.isAuthMenuOpen,this.isThemeMenuOpen=!1,this.authError=""}async signInGoogle(){this.isAuthLoading=!0;try{await this.firebaseService.signInWithGoogle(),this.isAuthMenuOpen=!1}catch(e){this.authError=e.message}finally{this.isAuthLoading=!1}}async handleAuth(e,t){if(!e||!t){this.authError="Please enter email and password";return}this.isAuthLoading=!0,this.authError="";try{this.isRegisterMode?await this.firebaseService.registerEmail(e,t):await this.firebaseService.loginEmail(e,t),this.isAuthMenuOpen=!1}catch(r){console.error(r),r.code==="auth/invalid-credential"?this.authError="Invalid email or password.":r.code==="auth/email-already-in-use"?this.authError="Email already in use.":r.code==="auth/weak-password"?this.authError="Password should be at least 6 characters.":this.authError="Error: "+(r.message||"Unknown")}finally{this.isAuthLoading=!1}}async signOut(){await this.firebaseService.signOut(),this.gridStore.resetUserStats()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{let e=()=>{let t=Date.now(),r=this.lastPlacedTime+this.cooldownMs,i=this.dictService.profanityCooldownEnd(),o=Math.max(r,i),s=i>r?3e4:this.cooldownMs,c=o-s,u=t-c,l=1;if(t<o&&(l=u/s),this.progressPath?.nativeElement){let h=(l*100).toFixed(1);this.progressPath.nativeElement.setAttribute("stroke-dasharray",`${h}, 100`)}l>=1&&this.cooldownProgress<1?this.ngZone.run(()=>this.cooldownProgress=1):l<1&&this.cooldownProgress>=1&&this.ngZone.run(()=>this.cooldownProgress=l),this.animationFrameId=requestAnimationFrame(e)};e()})}ngOnDestroy(){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}toggleThemeMenu(){this.isThemeMenuOpen=!this.isThemeMenuOpen,this.isAuthMenuOpen=!1}selectTheme(e){this.wordsPlacedCount>=e.unlockCount&&this.themeSelected.emit(e)}selectFont(e){this.wordsPlacedCount>=e.unlockCount&&this.fontSelected.emit(e)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=ss({type:n,selectors:[["app-top-bar"]],viewQuery:function(t,r){if(t&1&&Si(F1,5),t&2){let i;Ai(i=Ni())&&(r.progressPath=i.first)}},inputs:{lastPlacedTime:"lastPlacedTime",cooldownMs:"cooldownMs",wordsPlacedCount:"wordsPlacedCount",isValidating:"isValidating",validationMessage:"validationMessage",isError:"isError",activeTheme:"activeTheme",themes:"themes",activeFont:"activeFont",fonts:"fonts"},outputs:{themeSelected:"themeSelected",fontSelected:"fontSelected",zoomIn:"zoomIn",zoomOut:"zoomOut",resetView:"resetView",sharePosition:"sharePosition"},decls:45,vars:8,consts:[["progressPath",""],["emailInput",""],["passwordInput",""],[1,"absolute","top-0","left-0","right-0","p-4","pointer-events-none","z-50","flex","justify-center","md:justify-start"],[1,"bg-white/95","backdrop-blur","shadow-lg","border","border-gray-200","px-4","py-3","rounded-xl","pointer-events-auto","max-w-sm","w-full","md:w-auto","text-center","md:text-left"],[1,"flex","items-center","gap-3","mb-1"],[1,"relative","w-6","h-6","flex-shrink-0"],["viewBox","0 0 36 36",1,"transform","-rotate-90","w-full","h-full"],["d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831","fill","none","stroke","currentColor","stroke-width","4",1,"text-gray-200"],["stroke-dasharray","100, 100","d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831","fill","none","stroke","currentColor","stroke-width","4",1,"text-blue-500","transition-[stroke-dasharray]","duration-100","ease-linear"],["class","absolute inset-0 flex items-center justify-center",4,"ngIf"],[1,"text-xl","font-black","tracking-tighter"],[1,"hidden","md:block","text-xs","text-gray-500","mb-2","leading-relaxed"],[1,"flex","items-center","justify-between","mb-3","pt-2","border-t","border-gray-100"],[1,"text-xs","font-bold","text-gray-500","uppercase","tracking-wide"],[1,"text-black","text-sm"],[1,"min-h-[24px]","flex","flex-col","justify-center","items-center","md:items-start"],["class","flex items-center space-x-2 text-blue-600 animate-pulse",4,"ngIf"],["class","text-sm font-medium whitespace-pre-wrap",3,"text-red-500","text-green-600",4,"ngIf"],[1,"absolute","top-4","right-4","flex","flex-col","gap-2","z-50","pointer-events-auto"],[1,"relative"],["class","bg-white shadow-lg border border-gray-200 p-2 rounded-full hover:bg-gray-50 text-gray-700","title","Sign In",3,"click",4,"ngIf"],["class","absolute right-0 top-12 w-72 bg-white/95 backdrop-blur shadow-xl border border-gray-200 p-4 rounded-xl z-50 animate-in fade-in slide-in-from-top-2",4,"ngIf"],["class","bg-white shadow-lg border border-gray-200 p-1 rounded-full hover:bg-gray-50 overflow-hidden w-10 h-10 flex items-center justify-center relative group",3,"title","click",4,"ngIf"],["title","Center View",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["title","Share Position",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"],["title","Themes",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],["class","absolute right-full top-0 mr-2 bg-white/95 backdrop-blur shadow-lg border border-gray-200 p-3 rounded-xl flex flex-col gap-3 min-w-max animate-in fade-in slide-in-from-right-2",4,"ngIf"],["title","Zoom In",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["title","Zoom Out",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 12H4"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"w-2","h-2","bg-blue-500","rounded-full"],[1,"flex","items-center","space-x-2","text-blue-600","animate-pulse"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-sm","font-semibold"],[1,"text-sm","font-medium","whitespace-pre-wrap"],["title","Sign In",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"],[1,"absolute","right-0","top-12","w-72","bg-white/95","backdrop-blur","shadow-xl","border","border-gray-200","p-4","rounded-xl","z-50","animate-in","fade-in","slide-in-from-top-2"],[1,"font-bold","text-lg","mb-3"],[1,"space-y-2","mb-4"],["type","email","placeholder","Email",1,"w-full","px-3","py-2","border","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","bg-white/50",3,"keydown","keyup.enter"],["type","password","placeholder","Password",1,"w-full","px-3","py-2","border","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","bg-white/50",3,"keydown","keyup.enter"],["class","text-xs text-red-500 font-medium",4,"ngIf"],[1,"w-full","bg-blue-600","hover:bg-blue-700","text-white","font-bold","py-2","rounded-lg","transition-colors","flex","justify-center","items-center",3,"click"],[4,"ngIf"],["class","animate-spin h-5 w-5 text-white","fill","none","viewBox","0 0 24 24",4,"ngIf"],[1,"relative","flex","py-2","items-center"],[1,"flex-grow","border-t","border-gray-300"],[1,"flex-shrink-0","mx-2","text-gray-400","text-xs"],[1,"w-full","bg-white","border","border-gray-300","hover:bg-gray-50","text-gray-700","font-bold","py-2","rounded-lg","transition-colors","flex","items-center","justify-center","gap-2","mb-3",3,"click"],["viewBox","0 0 24 24","fill","currentColor",1,"w-4","h-4"],["d","M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"],[1,"text-center","text-xs","text-gray-500"],[1,"text-xs","text-red-500","font-medium"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],[1,"text-blue-600","hover:underline",3,"click"],[1,"bg-white","shadow-lg","border","border-gray-200","p-1","rounded-full","hover:bg-gray-50","overflow-hidden","w-10","h-10","flex","items-center","justify-center","relative","group",3,"click","title"],["class","w-full h-full object-cover rounded-full",3,"src",4,"ngIf"],["class","text-xs font-bold",4,"ngIf"],[1,"absolute","inset-0","bg-black/50","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"],[1,"w-full","h-full","object-cover","rounded-full",3,"src"],[1,"text-xs","font-bold"],[1,"absolute","right-full","top-0","mr-2","bg-white/95","backdrop-blur","shadow-lg","border","border-gray-200","p-3","rounded-xl","flex","flex-col","gap-3","min-w-max","animate-in","fade-in","slide-in-from-right-2"],[1,"flex","gap-2"],["class","w-10 h-10 rounded-full border transition-all relative flex items-center justify-center group shadow-sm",3,"ring-2","ring-offset-1","ring-blue-500","opacity-50","background-color","border-color","title","click",4,"ngFor","ngForOf"],[1,"h-px","bg-gray-200","w-full"],["class","w-10 h-10 rounded-lg border transition-all relative flex items-center justify-center group shadow-sm bg-white hover:bg-gray-50",3,"ring-2","ring-offset-1","ring-blue-500","opacity-50","title","click",4,"ngFor","ngForOf"],[1,"w-10","h-10","rounded-full","border","transition-all","relative","flex","items-center","justify-center","group","shadow-sm",3,"click","title"],["class","w-4 h-4 text-gray-400","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],[1,"w-10","h-10","rounded-lg","border","transition-all","relative","flex","items-center","justify-center","group","shadow-sm","bg-white","hover:bg-gray-50",3,"click","title"],["class","text-lg",3,"font-family",4,"ngIf"],[1,"text-lg"]],template:function(t,r){if(t&1){let i=_t();O(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6),We(),O(4,"svg",7),we(5,"path",8)(6,"path",9,0),U(),Ke(8,V1,2,0,"div",10),U(),zt(),O(9,"h1",11),Ae(10,"Cross.plane"),U()(),O(11,"p",12),Ae(12," Infinite, procedural, collaborative crossword. "),we(13,"br"),Ae(14," Click to select. Space to rotate. Type to type. "),U(),O(15,"div",13)(16,"div",14),Ae(17," Words placed: "),O(18,"span",15),Ae(19),U()()(),O(20,"div",16),Ke(21,B1,6,0,"div",17)(22,U1,2,5,"div",18),U()()(),O(23,"div",19)(24,"div",20),Ke(25,j1,3,0,"button",21)(26,W1,24,6,"div",22),U(),Ke(27,Y1,6,3,"button",23),O(28,"button",24),Ee("click",function(){return J(i),X(r.resetView.emit())}),We(),O(29,"svg",25),we(30,"path",26),U()(),zt(),O(31,"button",27),Ee("click",function(){return J(i),X(r.sharePosition.emit())}),We(),O(32,"svg",25),we(33,"path",28),U()(),zt(),O(34,"div",20)(35,"button",29),Ee("click",function(){return J(i),X(r.toggleThemeMenu())}),We(),O(36,"svg",25),we(37,"path",30),U()(),Ke(38,nO,6,2,"div",31),U(),zt(),O(39,"button",32),Ee("click",function(){return J(i),X(r.zoomIn.emit())}),We(),O(40,"svg",25),we(41,"path",33),U()(),zt(),O(42,"button",34),Ee("click",function(){return J(i),X(r.zoomOut.emit())}),We(),O(43,"svg",25),we(44,"path",35),U()()()}t&2&&(le(8),he("ngIf",r.cooldownProgress>=1),le(11),Hn(r.wordsPlacedCount),le(2),he("ngIf",r.isValidating),le(),he("ngIf",!r.isValidating&&r.validationMessage),le(3),he("ngIf",!r.currentUser()),le(),he("ngIf",r.isAuthMenuOpen&&!r.currentUser()),le(),he("ngIf",r.currentUser()),le(11),he("ngIf",r.isThemeMenuOpen))},dependencies:[Mi,kc,yh],encapsulation:2})}};var rO=["hiddenInput"],iO=["gridCanvas"],ml=class n{constructor(e,t){this.grid=e;this.dictionary=t;this.renderer=W(hl);this.inputManager=W(pl);this.activeTheme=me(Wm[0]);this.themes=Wm;this.activeFont=me(Km[0]);this.fonts=Km;this.pendingWordCoords=me([]);this.isValidating=me(!1);this.validationMessage=me("");this.isError=me(!1);this.entryStart=me(null);this.COOLDOWN_MS=5e3;qt(()=>{this.inputManager.zoomLevel(),this.grid.viewportOffset(),this.grid.cells(),this.grid.selectedCell(),this.grid.inputDirection(),this.pendingWordCoords(),this.activeTheme(),this.activeFont(),this.renderer.requestRender()}),this.loadPreferences(),qt(()=>{let r=this.activeTheme();document.body.style.backgroundColor=r.colors.bg,this.grid.setCookie("cross_plane_theme",r.id,365)}),qt(()=>{let r=this.activeFont();this.grid.setCookie("cross_plane_font",r.id,365)})}ngOnInit(){this.handleUrlParams()}ngAfterViewInit(){this.renderer.setCanvas(this.gridCanvas.nativeElement),this.renderer.startRenderLoop(()=>({zoomLevel:this.inputManager.zoomLevel(),theme:this.activeTheme(),font:this.activeFont(),showText:this.inputManager.zoomLevel()>.35,pendingWords:this.pendingWordCoords()})),window.addEventListener("resize",()=>this.renderer.resizeCanvas())}startPan(e){this.inputManager.startPan(e)}startPanTouch(e){this.inputManager.startPanTouch(e)}pan(e){this.inputManager.handlePan(e)}panTouch(e){this.inputManager.handlePanTouch(e)}endPan(){this.inputManager.endPan()}onWheel(e){this.inputManager.handleWheel(e)}zoomIn(){this.inputManager.zoomIn(window.innerWidth,window.innerHeight)}zoomOut(){this.inputManager.zoomOut(window.innerWidth,window.innerHeight)}resetView(){this.grid.viewportOffset.set({x:0,y:0}),this.inputManager.zoomLevel.set(1)}onCanvasClick(e){if(this.inputManager.isPanning)return;let t=this.inputManager.screenToGrid(e.clientX,e.clientY,this.renderer.CELL_SIZE);this.grid.isBlackSquare(t.x,t.y)||this.selectCell(t.x,t.y)}onCanvasTouch(e){if(e.touches.length>1)return;let t=e.touches[0],r=this.inputManager.screenToGrid(t.clientX,t.clientY,this.renderer.CELL_SIZE);this.grid.isBlackSquare(r.x,r.y)||setTimeout(()=>{!this.inputManager.isPanning&&!this.inputManager.isPinching&&this.selectCell(r.x,r.y)},100)}onGlobalKeyDown(e){if(this.grid.selectedCell()){if(e.key==="ArrowLeft"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x-1,y:r.y}:null);return}if(e.key==="ArrowRight"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x+1,y:r.y}:null);return}if(e.key==="ArrowUp"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x,y:r.y-1}:null);return}if(e.key==="ArrowDown"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x,y:r.y+1}:null);return}if(e.key==="Enter"){e.preventDefault(),this.submitWord();return}if(e.key===" "){e.preventDefault(),this.grid.inputDirection.update(r=>r==="across"?"down":"across");return}if(e.key==="Backspace"){this.handleBackspace();return}if(e.key==="Escape"){this.clearPending();return}if(e.key.length===1&&e.key.match(/[a-zA-Z]/)){if(document.activeElement===this.hiddenInput?.nativeElement)return;e.preventDefault(),this.processCharInput(e.key.toUpperCase())}}}selectCell(e,t){let r=this.grid.selectedCell();if(r&&r.x===e&&r.y===t){this.grid.inputDirection.update(o=>o==="across"?"down":"across");return}this.pendingWordCoords().some(o=>o.x===e&&o.y===t)||this.clearPending(),this.grid.selectedCell.set({x:e,y:t}),this.entryStart.set({x:e,y:t}),this.validationMessage.set(""),this.focusInput()}focusInput(){this.hiddenInput?.nativeElement?.focus()}onInput(e){let t=e.target,r=t.value.slice(-1).toUpperCase();t.value="",r.match(/[A-Z]/)&&this.processCharInput(r)}processCharInput(e){let t=this.grid.selectedCell();if(!t||this.grid.isBlackSquare(t.x,t.y))return;let r=this.grid.getCell(t.x,t.y);if(r&&r.confirmed){r.char===e?this.moveCursor(1):this.showError("Cannot change existing letters!");return}this.addPendingChar(t.x,t.y,e),this.moveCursor(1),this.focusInput()}handleBackspace(){let e=this.grid.selectedCell(),t=this.entryStart();if(!e||!t)return;if(this.pendingWordCoords().some(l=>l.x===e.x&&l.y===e.y)){this.removePendingAt(e.x,e.y);return}if(e.x===t.x&&e.y===t.y)return;let i=this.grid.inputDirection()==="across",o=i?-1:0,s=i?0:-1,c=e.x+o,u=e.y+s;this.grid.isBlackSquare(c,u)||(this.grid.selectedCell.set({x:c,y:u}),this.pendingWordCoords().some(l=>l.x===c&&l.y===u)&&this.removePendingAt(c,u))}moveCursor(e){let t=this.grid.selectedCell();if(!t)return;let r=this.grid.inputDirection()==="across"?e:0,i=this.grid.inputDirection()==="down"?e:0,o=t.x+r,s=t.y+i;this.grid.isBlackSquare(o,s)||this.grid.selectedCell.set({x:o,y:s})}addPendingChar(e,t,r){this.pendingWordCoords.update(i=>[...i.filter(s=>!(s.x===e&&s.y===t)),{x:e,y:t,char:r}]),this.validationMessage.set("")}removePendingAt(e,t){this.pendingWordCoords.update(r=>r.filter(i=>!(i.x===e&&i.y===t)))}async submitWord(){if(this.pendingWordCoords().length===0)return;let t=Date.now()-this.grid.lastPlacedTime();if(t<this.COOLDOWN_MS){let S=Math.ceil((this.COOLDOWN_MS-t)/1e3);this.showError(`Wait ${S}s to place next word.`);return}this.isValidating.set(!0),this.validationMessage.set(""),this.isError.set(!1);let i=this.grid.inputDirection()==="across",o=[...this.pendingWordCoords()].sort((S,x)=>i?S.x-x.x:S.y-x.y),s=o[0],c=o[o.length-1],u=s.x,l=s.y;for(;!this.grid.isBlackSquare(i?u-1:u,i?l:l-1);){let S=i?u-1:u,x=i?l:l-1;if(this.grid.getCell(S,x)||this.pendingWordCoords().find(F=>F.x===S&&F.y===x))u=S,l=x;else break}let h=u,p=l;for(u=c.x,l=c.y;!this.grid.isBlackSquare(i?u+1:u,i?l:l+1);){let S=i?u+1:u,x=i?l:l+1;if(this.grid.getCell(S,x)||this.pendingWordCoords().find(F=>F.x===S&&F.y===x))u=S,l=x;else break}let m=i?u-h+1:l-p+1,E="",A=!1;for(let S=0;S<m;S++){let x=i?h+S:h,F=i?p:p+S,G=this.grid.getCell(x,F),be=this.pendingWordCoords().find(xe=>xe.x===x&&xe.y===F);if(G&&G.confirmed)E+=G.char,A=!0;else if(be)E+=be.char;else{this.showError("Word has gaps!"),this.isValidating.set(!1);return}}if(!A&&this.grid.cells().size>0){this.showError("Must connect to existing words!"),this.isValidating.set(!1);return}let M=await this.dictionary.validateWord(E);if(M.valid){for(let S=0;S<m;S++){let x=i?h+S:h,F=i?p:p+S;this.grid.getCell(x,F)||this.grid.setCell(x,F,E[S],!0)}this.grid.lastPlacedTime.set(Date.now()),this.grid.incrementWordsPlaced(),this.clearPending(),this.validationMessage.set(`Placed: "${E}"
${M.definition}`)}else this.showError(M.reason||`"${E}" not found.`);this.isValidating.set(!1)}clearPending(){this.pendingWordCoords.set([]),this.validationMessage.set(""),this.hiddenInput?.nativeElement&&(this.hiddenInput.nativeElement.value="");let e=this.grid.selectedCell();e&&this.entryStart.set(e)}showError(e){this.validationMessage.set(e),this.isError.set(!0)}sharePosition(){let e=this.inputManager.screenToGrid(window.innerWidth/2,window.innerHeight/2,this.renderer.CELL_SIZE),t=new URL(window.location.href);t.searchParams.set("x",e.x.toString()),t.searchParams.set("y",e.y.toString()),navigator.clipboard.writeText(t.toString()).then(()=>{this.validationMessage.set("Link copied to clipboard!"),this.isError.set(!1),setTimeout(()=>{this.validationMessage()==="Link copied to clipboard!"&&this.validationMessage.set("")},3e3)})}loadPreferences(){let e=this.grid.getCookie("cross_plane_theme");if(e){let r=this.themes.find(i=>i.id===e);r&&this.activeTheme.set(r)}let t=this.grid.getCookie("cross_plane_font");if(t){let r=this.fonts.find(i=>i.id===t);r&&this.activeFont.set(r)}}handleUrlParams(){let e=new URLSearchParams(window.location.search),t=e.get("x"),r=e.get("y");if(t&&r){let i=parseInt(t,10),o=parseInt(r,10);if(!isNaN(i)&&!isNaN(o)){let s=this.renderer.CELL_SIZE*this.inputManager.zoomLevel();this.grid.viewportOffset.set({x:-i*s,y:-o*s})}}}static{this.\u0275fac=function(t){return new(t||n)(Nt(sn),Nt(uo))}}static{this.\u0275cmp=ss({type:n,selectors:[["app-root"]],viewQuery:function(t,r){if(t&1&&Si(rO,5)(iO,5),t&2){let i;Ai(i=Ni())&&(r.hiddenInput=i.first),Ai(i=Ni())&&(r.gridCanvas=i.first)}},decls:6,vars:10,consts:[["gridCanvas",""],["hiddenInput",""],[1,"relative","w-full","h-full","overflow-hidden","bg-white","select-none","cursor-grab","active:cursor-grabbing","font-mono",3,"mousedown","touchstart","mousemove","touchmove","mouseup","touchend","keydown","wheel"],[1,"absolute","inset-0","w-full","h-full",3,"click","touchstart"],[3,"themeSelected","fontSelected","zoomIn","zoomOut","resetView","sharePosition","lastPlacedTime","cooldownMs","wordsPlacedCount","isValidating","validationMessage","isError","activeTheme","themes","activeFont","fonts"],["type","text","inputmode","text","autocomplete","off","autocorrect","off","autocapitalize","characters",1,"absolute","opacity-0","top-0","left-0","w-px","h-px","overflow-hidden","-z-10",3,"input"]],template:function(t,r){if(t&1){let i=_t();O(0,"div",2),Ee("mousedown",function(s){return J(i),X(r.startPan(s))})("touchstart",function(s){return J(i),X(r.startPanTouch(s))})("mousemove",function(s){return J(i),X(r.pan(s))},Pr)("touchmove",function(s){return J(i),X(r.panTouch(s))},Pr)("mouseup",function(){return J(i),X(r.endPan())},Pr)("touchend",function(){return J(i),X(r.endPan())},Pr)("keydown",function(s){return J(i),X(r.onGlobalKeyDown(s))},Pr)("wheel",function(s){return J(i),X(r.onWheel(s))}),O(1,"canvas",3,0),Ee("click",function(s){return J(i),X(r.onCanvasClick(s))})("touchstart",function(s){return J(i),X(r.onCanvasTouch(s))}),U(),O(3,"app-top-bar",4),Ee("themeSelected",function(s){return J(i),X(r.activeTheme.set(s))})("fontSelected",function(s){return J(i),X(r.activeFont.set(s))})("zoomIn",function(){return J(i),X(r.zoomIn())})("zoomOut",function(){return J(i),X(r.zoomOut())})("resetView",function(){return J(i),X(r.resetView())})("sharePosition",function(){return J(i),X(r.sharePosition())}),U(),O(4,"input",5,1),Ee("input",function(s){return J(i),X(r.onInput(s))}),U()()}t&2&&(le(3),he("lastPlacedTime",r.grid.lastPlacedTime())("cooldownMs",r.COOLDOWN_MS)("wordsPlacedCount",r.grid.wordsPlacedCount())("isValidating",r.isValidating())("validationMessage",r.validationMessage())("isError",r.isError())("activeTheme",r.activeTheme())("themes",r.themes)("activeFont",r.activeFont())("fonts",r.fonts))},dependencies:[Mi,gl],encapsulation:2})}};bh(ml,{providers:[ch()]}).catch(n=>console.error(n));
