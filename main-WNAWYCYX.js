var db=Object.defineProperty,fb=Object.defineProperties;var hb=Object.getOwnPropertyDescriptors;var ga=Object.getOwnPropertySymbols;var e_=Object.prototype.hasOwnProperty,t_=Object.prototype.propertyIsEnumerable;var Xy=(n,e,t)=>e in n?db(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,j=(n,e)=>{for(var t in e||={})e_.call(e,t)&&Xy(n,t,e[t]);if(ga)for(var t of ga(e))t_.call(e,t)&&Xy(n,t,e[t]);return n},_e=(n,e)=>fb(n,hb(e));var ma=(n,e)=>{var t={};for(var r in n)e_.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ga)for(var r of ga(n))e.indexOf(r)<0&&t_.call(n,r)&&(t[r]=n[r]);return t};var $e=null,ya=!1,zl=1,pb=null,ht=Symbol("SIGNAL");function G(n){let e=$e;return $e=n,e}function va(){return $e}var Xr={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Gl(n){if(ya)throw new Error("");if($e===null)return;$e.consumerOnSignalRead(n);let e=$e.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=$e.recomputing;if(r&&(t=e!==void 0?e.nextProducer:$e.producers,t!==void 0&&t.producer===n)){$e.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===$e&&(!r||mb(i,$e)))return;let s=ti($e),o={producer:n,consumer:$e,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};$e.producersTail=o,e!==void 0?e.nextProducer=o:$e.producers=o,s&&s_(n,o)}function n_(){zl++}function Wl(n){if(!(ti(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===zl)){if(!n.producerMustRecompute(n)&&!Ia(n)){ql(n);return}n.producerRecomputeValue(n),ql(n)}}function Kl(n){if(n.consumers===void 0)return;let e=ya;ya=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||gb(r)}}finally{ya=e}}function Ql(){return $e?.consumerAllowSignalWrites!==!1}function gb(n){n.dirty=!0,Kl(n),n.consumerMarkedDirty?.(n)}function ql(n){n.dirty=!1,n.lastCleanEpoch=zl}function bs(n){return n&&r_(n),G(n)}function r_(n){n.producersTail=void 0,n.recomputing=!0}function Ea(n,e){G(e),n&&i_(n)}function i_(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(ti(n))do t=Yl(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Ia(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(Wl(t),r!==t.version))return!0}return!1}function ei(n){if(ti(n)){let e=n.producers;for(;e!==void 0;)e=Yl(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function s_(n,e){let t=n.consumersTail,r=ti(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)s_(i.producer,i)}function Yl(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!ti(e)){let s=e.producers;for(;s!==void 0;)s=Yl(s)}return t}function ti(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function Zl(n){pb?.(n)}function mb(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function Jl(n,e){return Object.is(n,e)}function wa(n,e){let t=Object.create(yb);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(Wl(t),Gl(t),t.value===_a)throw t.error;return t.value};return r[ht]=t,Zl(t),r}var Hl=Symbol("UNSET"),$l=Symbol("COMPUTING"),_a=Symbol("ERRORED"),yb=_e(j({},Xr),{value:Hl,dirty:!0,error:null,equal:Jl,kind:"computed",producerMustRecompute(n){return n.value===Hl||n.value===$l},producerRecomputeValue(n){if(n.value===$l)throw new Error("");let e=n.value;n.value=$l;let t=bs(n),r,i=!1;try{r=n.computation(),G(null),i=e!==Hl&&e!==_a&&r!==_a&&n.equal(e,r)}catch(s){r=_a,n.error=s}finally{Ea(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function _b(){throw new Error}var o_=_b;function a_(n){o_(n)}function Xl(n){o_=n}var vb=null;function ed(n,e){let t=Object.create(l_);t.value=n,e!==void 0&&(t.equal=e);let r=()=>c_(t);return r[ht]=t,Zl(t),[r,o=>td(t,o),o=>u_(t,o)]}function c_(n){return Gl(n),n.value}function td(n,e){Ql()||a_(n),n.equal(n.value,e)||(n.value=e,Eb(n))}function u_(n,e){Ql()||a_(n),td(n,e(n.value))}var l_=_e(j({},Xr),{equal:Jl,value:void 0,kind:"signal"});function Eb(n){n.version++,n_(),Kl(n),vb?.(n)}function nd(n){let e=G(null);try{return n()}finally{G(e)}}var rd=_e(j({},Xr),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function id(n){if(n.dirty=!1,n.version>0&&!Ia(n))return;n.version++;let e=bs(n);try{n.cleanup(),n.fn()}finally{Ea(n,e)}}function st(n){return typeof n=="function"}function Ta(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Da=Ta(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ss(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var tt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(st(r))try{r()}catch(s){e=s instanceof Da?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{d_(s)}catch(o){e=e??[],o instanceof Da?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Da(e)}}add(e){var t;if(e&&e!==this)if(this.closed)d_(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ss(t,e)}remove(e){let{_finalizers:t}=this;t&&Ss(t,e),e instanceof n&&e._removeParent(this)}};tt.EMPTY=(()=>{let n=new tt;return n.closed=!0,n})();var sd=tt.EMPTY;function Ca(n){return n instanceof tt||n&&"closed"in n&&st(n.remove)&&st(n.add)&&st(n.unsubscribe)}function d_(n){st(n)?n():n.unsubscribe()}var Tt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ni={setTimeout(n,e,...t){let{delegate:r}=ni;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=ni;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function f_(n){ni.setTimeout(()=>{let{onUnhandledError:e}=Tt;if(e)e(n);else throw n})}function od(){}var h_=ad("C",void 0,void 0);function p_(n){return ad("E",void 0,n)}function g_(n){return ad("N",n,void 0)}function ad(n,e,t){return{kind:n,value:e,error:t}}var lr=null;function ri(n){if(Tt.useDeprecatedSynchronousErrorHandling){let e=!lr;if(e&&(lr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=lr;if(lr=null,t)throw r}}else n()}function m_(n){Tt.useDeprecatedSynchronousErrorHandling&&lr&&(lr.errorThrown=!0,lr.error=n)}var dr=class extends tt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ca(e)&&e.add(this)):this.destination=Tb}static create(e,t,r){return new ii(e,t,r)}next(e){this.isStopped?ud(g_(e),this):this._next(e)}error(e){this.isStopped?ud(p_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ud(h_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Ib=Function.prototype.bind;function cd(n,e){return Ib.call(n,e)}var ld=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){ba(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){ba(r)}else ba(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ba(t)}}},ii=class extends dr{constructor(e,t,r){super();let i;if(st(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Tt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&cd(e.next,s),error:e.error&&cd(e.error,s),complete:e.complete&&cd(e.complete,s)}):i=e}this.destination=new ld(i)}};function ba(n){Tt.useDeprecatedSynchronousErrorHandling?m_(n):f_(n)}function wb(n){throw n}function ud(n,e){let{onStoppedNotification:t}=Tt;t&&ni.setTimeout(()=>t(n,e))}var Tb={closed:!0,next:od,error:wb,complete:od};var y_=typeof Symbol=="function"&&Symbol.observable||"@@observable";function __(n){return n}function v_(n){return n.length===0?__:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var si=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=Cb(t)?t:new ii(t,r,i);return ri(()=>{let{operator:o,source:c}=this;s.add(o?o.call(s,c):c?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=E_(r),new r((i,s)=>{let o=new ii({next:c=>{try{t(c)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[y_](){return this}pipe(...t){return v_(t)(this)}toPromise(t){return t=E_(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function E_(n){var e;return(e=n??Tt.Promise)!==null&&e!==void 0?e:Promise}function Db(n){return n&&st(n.next)&&st(n.error)&&st(n.complete)}function Cb(n){return n&&n instanceof dr||Db(n)&&Ca(n)}function bb(n){return st(n?.lift)}function I_(n){return e=>{if(bb(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function w_(n,e,t,r,i){return new dd(n,e,t,r,i)}var dd=class extends dr{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(c){try{t(c)}catch(u){e.error(u)}}:super._next,this._error=i?function(c){try{i(c)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var T_=Ta(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var sn=(()=>{class n extends si{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Sa(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new T_}next(t){ri(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){ri(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ri(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?sd:(this.currentObservers=null,s.push(t),new tt(()=>{this.currentObservers=null,Ss(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new si;return t.source=this,t}}return n.create=(e,t)=>new Sa(e,t),n})(),Sa=class extends sn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:sd}};var As=class extends sn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};function fd(n,e){return I_((t,r)=>{let i=0;t.subscribe(w_(r,s=>{r.next(n.call(e,s,i++))}))})}var hd;function Aa(){return hd}function Ft(n){let e=hd;return hd=n,e}var D_=Symbol("NotFound");function oi(n){return n===D_||n?.name==="\u0275NotFound"}var La="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ee=class extends Error{code;constructor(e,t){super(Fa(e,t)),this.code=e}};function Sb(n){return`NG0${Math.abs(n)}`}function Fa(n,e){return`${Sb(n)}${e?": "+e:""}`}function he(n){for(let e in n)if(n[e]===he)return e;throw Error("")}function Rn(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Rn).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Sd(n,e){return n?e?`${n} ${e}`:n:e||""}var Ab=he({__forward_ref__:he});function Va(n){return n.__forward_ref__=Va,n.toString=function(){return Rn(this())},n}function ut(n){return N_(n)?n():n}function N_(n){return typeof n=="function"&&n.hasOwnProperty(Ab)&&n.__forward_ref__===Va}function pe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ks(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ba(n){return Nb(n,ja)}function Nb(n,e){return n.hasOwnProperty(e)&&n[e]||null}function Rb(n){let e=n?.[ja]??null;return e||null}function gd(n){return n&&n.hasOwnProperty(Ra)?n[Ra]:null}var ja=he({\u0275prov:he}),Ra=he({\u0275inj:he}),ce=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Ad(n){return n&&!!n.\u0275providers}var Nd=he({\u0275cmp:he}),Rd=he({\u0275dir:he}),Md=he({\u0275pipe:he});var md=he({\u0275fac:he}),mr=he({__NG_ELEMENT_ID__:he}),C_=he({__NG_ENV_ID__:he});function yr(n){return Pd(n,"@Component"),n[Nd]||null}function xd(n){return Pd(n,"@Directive"),n[Rd]||null}function R_(n){return Pd(n,"@Pipe"),n[Md]||null}function Pd(n,e){if(n==null)throw new ee(-919,!1)}function Ua(n){return typeof n=="string"?n:n==null?"":String(n)}function M_(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ua(n)}var x_=he({ngErrorCode:he}),Mb=he({ngErrorMessage:he}),xb=he({ngTokenPath:he});function kd(n,e){return P_("",-200,e)}function Ha(n,e){throw new ee(-201,!1)}function P_(n,e,t){let r=new ee(e,n);return r[x_]=e,r[Mb]=n,t&&(r[xb]=t),r}function Pb(n){return n[x_]}var yd;function k_(){return yd}function ct(n){let e=yd;return yd=n,e}function Od(n,e,t){let r=Ba(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;Ha(n,"")}var kb={},fr=kb,Ob="__NG_DI_FLAG__",_d=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=hr(t)||0;try{return this.injector.get(e,r&8?null:fr,r)}catch(i){if(oi(i))return i;throw i}}};function Lb(n,e=0){let t=Aa();if(t===void 0)throw new ee(-203,!1);if(t===null)return Od(n,void 0,e);{let r=Fb(e),i=t.retrieve(n,r);if(oi(i)){if(r.optional)return null;throw i}return i}}function de(n,e=0){return(k_()||Lb)(ut(n),e)}function te(n,e){return de(n,hr(e))}function hr(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Fb(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function vd(n){let e=[];for(let t=0;t<n.length;t++){let r=ut(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ee(900,!1);let i,s=0;for(let o=0;o<r.length;o++){let c=r[o],u=Vb(c);typeof u=="number"?u===-1?i=c.token:s|=u:i=c}e.push(de(i,s))}else e.push(de(r))}return e}function Vb(n){return n[Ob]}function ci(n,e){let t=n.hasOwnProperty(md);return t?n[md]:null}function O_(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],s=e[r];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}function L_(n){return n.flat(Number.POSITIVE_INFINITY)}function $a(n,e){n.forEach(t=>Array.isArray(t)?$a(t,e):e(t))}function Ld(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Os(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function F_(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function V_(n,e,t){let r=ui(n,e);return r>=0?n[r|1]=t:(r=~r,F_(n,r,e,t)),r}function qa(n,e){let t=ui(n,e);if(t>=0)return n[t|1]}function ui(n,e){return Bb(n,e,1)}function Bb(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var _r={},pt=[],Ls=new ce(""),Fd=new ce("",-1),Vd=new ce(""),Rs=class{get(e,t=fr){if(t===fr){let i=P_("",-201);throw i.name="\u0275NotFound",i}return t}};function Bd(n){return{\u0275providers:n}}function B_(...n){return{\u0275providers:jd(!0,n),\u0275fromNgModule:!0}}function jd(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return $a(e,o=>{let c=o;Ma(c,s,[],r)&&(i||=[],i.push(c))}),i!==void 0&&j_(i,s),t}function j_(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Ud(i,s=>{e(s,r)})}}function Ma(n,e,t,r){if(n=ut(n),!n)return!1;let i=null,s=gd(n),o=!s&&yr(n);if(!s&&!o){let u=n.ngModule;if(s=gd(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=n}let c=r.has(i);if(o){if(c)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of u)Ma(l,e,t,r)}}else if(s){if(s.imports!=null&&!c){r.add(i);let l;try{$a(s.imports,h=>{Ma(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&j_(l,e)}if(!c){let l=ci(i)||(()=>new i);e({provide:i,useFactory:l,deps:pt},i),e({provide:Vd,useValue:i,multi:!0},i),e({provide:Ls,useValue:()=>de(i),multi:!0},i)}let u=s.providers;if(u!=null&&!c){let l=n;Ud(u,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Ud(n,e){for(let t of n)Ad(t)&&(t=t.\u0275providers),Array.isArray(t)?Ud(t,e):e(t)}var jb=he({provide:String,useValue:he});function U_(n){return n!==null&&typeof n=="object"&&jb in n}function Ub(n){return!!(n&&n.useExisting)}function Hb(n){return!!(n&&n.useFactory)}function xa(n){return typeof n=="function"}var Fs=new ce(""),Na={},b_={},pd;function Vs(){return pd===void 0&&(pd=new Rs),pd}var gt=class{},pr=class extends gt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,Id(e,o=>this.processProvider(o)),this.records.set(Fd,ai(void 0,this)),i.has("environment")&&this.records.set(gt,ai(void 0,this));let s=this.records.get(Fs);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Vd,pt,{self:!0}))}retrieve(e,t){let r=hr(t)||0;try{return this.get(e,fr,r)}catch(i){if(oi(i))return i;throw i}}destroy(){Ns(this),this._destroyed=!0;let e=G(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),G(e)}}onDestroy(e){return Ns(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Ns(this);let t=Ft(this),r=ct(void 0),i;try{return e()}finally{Ft(t),ct(r)}}get(e,t=fr,r){if(Ns(this),e.hasOwnProperty(C_))return e[C_](this);let i=hr(r),s,o=Ft(this),c=ct(void 0);try{if(!(i&4)){let l=this.records.get(e);if(l===void 0){let h=Wb(e)&&Ba(e);h&&this.injectableDefInScope(h)?l=ai(Ed(e),Na):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,i)}let u=i&2?Vs():this.parent;return t=i&8&&t===fr?null:t,u.get(e,t)}catch(u){let l=Pb(u);throw l===-200||l===-201?new ee(l,null):u}finally{ct(c),Ft(o)}}resolveInjectorInitializers(){let e=G(null),t=Ft(this),r=ct(void 0),i;try{let s=this.get(Ls,pt,{self:!0});for(let o of s)o()}finally{Ft(t),ct(r),G(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Rn(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=ut(e);let t=xa(e)?e:ut(e&&e.provide),r=qb(e);if(!xa(e)&&e.multi===!0){let i=this.records.get(t);i||(i=ai(void 0,Na,!0),i.factory=()=>vd(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=G(null);try{if(t.value===b_)throw kd(Rn(e));return t.value===Na&&(t.value=b_,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&Gb(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{G(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=ut(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Ed(n){let e=Ba(n),t=e!==null?e.factory:ci(n);if(t!==null)return t;if(n instanceof ce)throw new ee(204,!1);if(n instanceof Function)return $b(n);throw new ee(204,!1)}function $b(n){if(n.length>0)throw new ee(204,!1);let t=Rb(n);return t!==null?()=>t.factory(n):()=>new n}function qb(n){if(U_(n))return ai(void 0,n.useValue);{let e=H_(n);return ai(e,Na)}}function H_(n,e,t){let r;if(xa(n)){let i=ut(n);return ci(i)||Ed(i)}else if(U_(n))r=()=>ut(n.useValue);else if(Hb(n))r=()=>n.useFactory(...vd(n.deps||[]));else if(Ub(n))r=(i,s)=>de(ut(n.useExisting),s!==void 0&&s&8?8:void 0);else{let i=ut(n&&(n.useClass||n.provide));if(zb(n))r=()=>new i(...vd(n.deps));else return ci(i)||Ed(i)}return r}function Ns(n){if(n.destroyed)throw new ee(205,!1)}function ai(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function zb(n){return!!n.deps}function Gb(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Wb(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Id(n,e){for(let t of n)Array.isArray(t)?Id(t,e):t&&Ad(t)?Id(t.\u0275providers,e):e(t)}function za(n,e){let t;n instanceof pr?(Ns(n),t=n):t=new _d(n);let r,i=Ft(t),s=ct(void 0);try{return e()}finally{Ft(i),ct(s)}}function $_(){return k_()!==void 0||Aa()!=null}var Dt=0,q=1,$=2,Fe=3,mt=4,yt=5,Bs=6,li=7,Ge=8,kn=9,Vt=10,Ve=11,di=12,Hd=13,vr=14,Ct=15,On=16,Er=17,Bt=18,js=19,$d=20,on=21,Ga=22,Mn=23,lt=24,Wa=25,Us=26,ot=27,q_=1;var Ln=7,Hs=8,Ir=9,nt=10;function cn(n){return Array.isArray(n)&&typeof n[q_]=="object"}function bt(n){return Array.isArray(n)&&n[q_]===!0}function qd(n){return(n.flags&4)!==0}function wr(n){return n.componentOffset>-1}function $s(n){return(n.flags&1)===1}function Tr(n){return!!n.template}function fi(n){return(n[$]&512)!==0}function Dr(n){return(n[$]&256)===256}var zd="svg",z_="math";function _t(n){for(;Array.isArray(n);)n=n[Dt];return n}function Gd(n,e){return _t(e[n])}function jt(n,e){return _t(e[n.index])}function Ka(n,e){return n.data[e]}function G_(n,e){return n[e]}function Ut(n,e){let t=e[n];return cn(t)?t:t[Dt]}function W_(n){return(n[$]&4)===4}function Qa(n){return(n[$]&128)===128}function K_(n){return bt(n[Fe])}function qs(n,e){return e==null?null:n[e]}function Wd(n){n[Er]=0}function Kd(n){n[$]&1024||(n[$]|=1024,Qa(n)&&hi(n))}function Q_(n,e){for(;n>0;)e=e[vr],n--;return e}function zs(n){return!!(n[$]&9216||n[lt]?.dirty)}function Ya(n){n[Vt].changeDetectionScheduler?.notify(8),n[$]&64&&(n[$]|=1024),zs(n)&&hi(n)}function hi(n){n[Vt].changeDetectionScheduler?.notify(0);let e=xn(n);for(;e!==null&&!(e[$]&8192||(e[$]|=8192,!Qa(e)));)e=xn(e)}function Qd(n,e){if(Dr(n))throw new ee(911,!1);n[on]===null&&(n[on]=[]),n[on].push(e)}function Y_(n,e){if(n[on]===null)return;let t=n[on].indexOf(e);t!==-1&&n[on].splice(t,1)}function xn(n){let e=n[Fe];return bt(e)?e[Fe]:e}function Yd(n){return n[li]??=[]}function Zd(n){return n.cleanup??=[]}function Z_(n,e,t,r){let i=Yd(e);i.push(t),n.firstCreatePass&&Zd(n).push(r,i.length-1)}var Y={lFrame:pv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var wd=!1;function J_(){return Y.lFrame.elementDepthCount}function X_(){Y.lFrame.elementDepthCount++}function ev(){Y.lFrame.elementDepthCount--}function Jd(){return Y.bindingsEnabled}function tv(){return Y.skipHydrationRootTNode!==null}function nv(n){return Y.skipHydrationRootTNode===n}function rv(){Y.skipHydrationRootTNode=null}function Ee(){return Y.lFrame.lView}function Ht(){return Y.lFrame.tView}function J(n){return Y.lFrame.contextLView=n,n[Ge]}function X(n){return Y.lFrame.contextLView=null,n}function $t(){let n=Xd();for(;n!==null&&n.type===64;)n=n.parent;return n}function Xd(){return Y.lFrame.currentTNode}function iv(){let n=Y.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function pi(n,e){let t=Y.lFrame;t.currentTNode=n,t.isParent=e}function ef(){return Y.lFrame.isParent}function sv(){Y.lFrame.isParent=!1}function ov(){return Y.lFrame.contextLView}function tf(){return wd}function Ms(n){let e=wd;return wd=n,e}function av(n){return Y.lFrame.bindingIndex=n}function nf(){return Y.lFrame.bindingIndex++}function cv(n){let e=Y.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function uv(){return Y.lFrame.inI18n}function lv(n,e){let t=Y.lFrame;t.bindingIndex=t.bindingRootIndex=n,Za(e)}function dv(){return Y.lFrame.currentDirectiveIndex}function Za(n){Y.lFrame.currentDirectiveIndex=n}function fv(n){let e=Y.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function rf(){return Y.lFrame.currentQueryIndex}function Ja(n){Y.lFrame.currentQueryIndex=n}function Kb(n){let e=n[q];return e.type===2?e.declTNode:e.type===1?n[yt]:null}function sf(n,e,t){if(t&4){let i=e,s=n;for(;i=i.parent,i===null&&!(t&1);)if(i=Kb(s),i===null||(s=s[vr],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Y.lFrame=hv();return r.currentTNode=e,r.lView=n,!0}function Xa(n){let e=hv(),t=n[q];Y.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function hv(){let n=Y.lFrame,e=n===null?null:n.child;return e===null?pv(n):e}function pv(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function gv(){let n=Y.lFrame;return Y.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var of=gv;function ec(){let n=gv();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function mv(n){return(Y.lFrame.contextLView=Q_(n,Y.lFrame.contextLView))[Ge]}function Cr(){return Y.lFrame.selectedIndex}function Fn(n){Y.lFrame.selectedIndex=n}function yv(){let n=Y.lFrame;return Ka(n.tView,n.selectedIndex)}function We(){Y.lFrame.currentNamespace=zd}function qt(){Qb()}function Qb(){Y.lFrame.currentNamespace=null}function _v(){return Y.lFrame.currentNamespace}var vv=!0;function tc(){return vv}function nc(n){vv=n}function Td(n,e=null,t=null,r){let i=Ev(n,e,t,r);return i.resolveInjectorInitializers(),i}function Ev(n,e=null,t=null,r,i=new Set){let s=[t||pt,B_(n)];return r=r||(typeof n=="object"?void 0:Rn(n)),new pr(s,e||Vs(),r||null,i)}var Pn=class n{static THROW_IF_NOT_FOUND=fr;static NULL=new Rs;static create(e,t){if(Array.isArray(e))return Td({name:""},t,e,"");{let r=e.name??"";return Td({name:r},e.parent,e.providers,r)}}static \u0275prov=pe({token:n,providedIn:"any",factory:()=>de(Fd)});static __NG_ELEMENT_ID__=-1},St=new ce(""),Gs=(()=>{class n{static __NG_ELEMENT_ID__=Yb;static __NG_ENV_ID__=t=>t}return n})(),Pa=class extends Gs{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Dr(this._lView)}onDestroy(e){let t=this._lView;return Qd(t,e),()=>Y_(t,e)}};function Yb(){return new Pa(Ee())}var Iv=!1,gi=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new As(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new si(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})(),Dd=class extends sn{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,$_()&&(this.destroyRef=te(Gs,{optional:!0})??void 0,this.pendingTasks=te(gi,{optional:!0})??void 0)}emit(e){let t=G(null);try{super.next(e)}finally{G(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let c=super.subscribe({next:i,error:s,complete:o});return e instanceof tt&&e.add(c),c}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},qe=Dd;function ka(...n){}function af(n){let e,t;function r(){n=ka;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function cf(n){return queueMicrotask(()=>n()),()=>{n=ka}}var uf="isAngularZone",xs=uf+"_ID",Zb=0,ze=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new qe(!1);onMicrotaskEmpty=new qe(!1);onStable=new qe(!1);onError=new qe(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=Iv}=e;if(typeof Zone>"u")throw new ee(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,eS(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(uf)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ee(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ee(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,Jb,ka,ka);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},Jb={};function lf(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Xb(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){af(()=>{n.callbackScheduled=!1,Cd(n),n.isCheckStableRunning=!0,lf(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Cd(n)}function eS(n){let e=()=>{Xb(n)},t=Zb++;n._inner=n._inner.fork({name:"angular",properties:{[uf]:!0,[xs]:t,[xs+t]:!0},onInvokeTask:(r,i,s,o,c,u)=>{if(tS(u))return r.invokeTask(s,o,c,u);try{return S_(n),r.invokeTask(s,o,c,u)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),A_(n)}},onInvoke:(r,i,s,o,c,u,l)=>{try{return S_(n),r.invoke(s,o,c,u,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!nS(u)&&e(),A_(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,Cd(n),lf(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function Cd(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function S_(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function A_(n){n._nesting--,lf(n)}var Ps=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new qe;onMicrotaskEmpty=new qe;onStable=new qe;onError=new qe;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function tS(n){return wv(n,"__ignore_ng_zone__")}function nS(n){return wv(n,"__scheduler_tick__")}function wv(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var an=class{_console=console;handleError(e){this._console.error("ERROR",e)}},br=new ce("",{factory:()=>{let n=te(ze),e=te(gt),t;return r=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw r}):(t??=e.get(an),t.handleError(r))})}}}),Tv={provide:Ls,useValue:()=>{let n=te(an,{optional:!0})},multi:!0};function we(n,e){let[t,r,i]=ed(n,e?.equal),s=t,o=s[ht];return s.set=r,s.update=i,s.asReadonly=Dv.bind(s),s}function Dv(){let n=this[ht];if(n.readonlyFn===void 0){let e=()=>this();e[ht]=n,n.readonlyFn=e}return n.readonlyFn}var rc=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=rS}return n})();function rS(){return new rc(Ee(),$t())}var gr=class{},Ws=new ce("",{factory:()=>!0});var df=new ce("");var ic=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new bd})}return n})(),bd=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},Oa=class{[ht];constructor(e){this[ht]=e}destroy(){this[ht].destroy()}};function zt(n,e){let t=e?.injector??te(Pn),r=e?.manualCleanup!==!0?t.get(Gs):null,i,s=t.get(rc,null,{optional:!0}),o=t.get(gr);return s!==null?(i=oS(s.view,o,n),r instanceof Pa&&r._lView===s.view&&(r=null)):i=aS(n,t.get(ic),o),i.injector=t,r!==null&&(i.onDestroyFns=[r.onDestroy(()=>i.destroy())]),new Oa(i)}var Cv=_e(j({},rd),{cleanupFns:void 0,zone:null,onDestroyFns:null,run(){let n=Ms(!1);try{id(this)}finally{Ms(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=G(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],G(n)}}}),iS=_e(j({},Cv),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){if(ei(this),this.onDestroyFns!==null)for(let n of this.onDestroyFns)n();this.cleanup(),this.scheduler.remove(this)}}),sS=_e(j({},Cv),{consumerMarkedDirty(){this.view[$]|=8192,hi(this.view),this.notifier.notify(13)},destroy(){if(ei(this),this.onDestroyFns!==null)for(let n of this.onDestroyFns)n();this.cleanup(),this.view[Mn]?.delete(this)}});function oS(n,e,t){let r=Object.create(sS);return r.view=n,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=bv(r,t),n[Mn]??=new Set,n[Mn].add(r),r.consumerMarkedDirty(r),r}function aS(n,e,t){let r=Object.create(iS);return r.fn=bv(r,n),r.scheduler=e,r.notifier=t,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}function bv(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}function Ks(n){return nd(n)}function vc(n){return{toString:n}.toString()}function yS(n){return typeof n=="function"}function tE(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var lc=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function _S(n){return n.type.prototype.ngOnChanges&&(n.setInput=ES),vS}function vS(){let n=rE(this),e=n?.current;if(e){let t=n.previous;if(t===_r)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function ES(n,e,t,r,i){let s=this.declaredInputs[r],o=rE(n)||IS(n,{previous:_r,current:null}),c=o.current||(o.current={}),u=o.previous,l=u[s];c[s]=new lc(l&&l.currentValue,t,u===_r),tE(n,e,i,t)}var nE="__ngSimpleChanges__";function rE(n){return n[nE]||null}function IS(n,e){return n[nE]=e}var Sv=[];var ge=function(n,e=null,t){for(let r=0;r<Sv.length;r++){let i=Sv[r];i(n,e,t)}},ue=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(ue||{});function wS(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=_S(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function iE(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:h}=s;o&&(n.contentHooks??=[]).push(-t,o),c&&((n.contentHooks??=[]).push(t,c),(n.contentCheckHooks??=[]).push(t,c)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function oc(n,e,t){sE(n,e,3,t)}function ac(n,e,t,r){(n[$]&3)===t&&sE(n,e,t,r)}function ff(n,e){let t=n[$];(t&3)===e&&(t&=16383,t+=1,n[$]=t)}function sE(n,e,t,r){let i=r!==void 0?n[Er]&65535:0,s=r??-1,o=e.length-1,c=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(c=e[u],r!=null&&c>=r)break}else e[u]<0&&(n[Er]+=65536),(c<s||s==-1)&&(TS(n,t,e,u),n[Er]=(n[Er]&4294901760)+u+2),u++}function Av(n,e){ge(ue.LifecycleHookStart,n,e);let t=G(null);try{e.call(n)}finally{G(t),ge(ue.LifecycleHookEnd,n,e)}}function TS(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],c=n[o];i?n[$]>>14<n[Er]>>16&&(n[$]&3)===e&&(n[$]+=16384,Av(c,s)):Av(c,s)}var yi=-1,Zs=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function DS(n){return(n.flags&8)!==0}function CS(n){return(n.flags&16)!==0}function bS(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],c=t[r++];n.setAttribute(e,o,c,s)}else{let s=i,o=t[++r];AS(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function SS(n){return n===3||n===4||n===6}function AS(n){return n.charCodeAt(0)===64}function Vf(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Nv(n,t,i,null,e[++r]):Nv(n,t,i,null,null))}}return n}function Nv(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let c=n[s++];if(typeof c=="number"){if(c===e){o=-1;break}else if(c>e){o=s-1;break}}}for(;s<n.length;){let c=n[s];if(typeof c=="number")break;if(c===t){i!==null&&(n[s+1]=i);return}s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),i!==null&&n.splice(s++,0,i)}function oE(n){return n!==yi}function dc(n){return n&32767}function NS(n){return n>>16}function fc(n,e){let t=NS(n),r=e;for(;t>0;)r=r[vr],t--;return r}var vf=!0;function Rv(n){let e=vf;return vf=n,e}var RS=256,aE=RS-1,cE=5,MS=0,Gt={};function xS(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(mr)&&(r=t[mr]),r==null&&(r=t[mr]=MS++);let i=r&aE,s=1<<i;e.data[n+(i>>cE)]|=s}function uE(n,e){let t=lE(n,e);if(t!==-1)return t;let r=e[q];r.firstCreatePass&&(n.injectorIndex=e.length,hf(r.data,n),hf(e,null),hf(r.blueprint,null));let i=Bf(n,e),s=n.injectorIndex;if(oE(i)){let o=dc(i),c=fc(i,e),u=c[q].data;for(let l=0;l<8;l++)e[s+l]=c[o+l]|u[o+l]}return e[s+8]=i,s}function hf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function lE(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Bf(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=gE(i),r===null)return yi;if(t++,i=i[vr],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return yi}function PS(n,e,t){xS(n,e,t)}function dE(n,e,t){if(t&8||n!==void 0)return n;Ha(e,"NodeInjector")}function fE(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[kn],s=ct(void 0);try{return i?i.get(e,r,t&8):Od(e,r,t&8)}finally{ct(s)}}return dE(r,e,t)}function hE(n,e,t,r=0,i){if(n!==null){if(e[$]&2048&&!(r&2)){let o=FS(n,e,t,r,Gt);if(o!==Gt)return o}let s=pE(n,e,t,r,Gt);if(s!==Gt)return s}return fE(e,t,r,i)}function pE(n,e,t,r,i){let s=OS(t);if(typeof s=="function"){if(!sf(e,n,r))return r&1?dE(i,t,r):fE(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&8))Ha(t);else return o}finally{of()}}else if(typeof s=="number"){let o=null,c=lE(n,e),u=yi,l=r&1?e[Ct][yt]:null;for((c===-1||r&4)&&(u=c===-1?Bf(n,e):e[c+8],u===yi||!xv(r,!1)?c=-1:(o=e[q],c=dc(u),e=fc(u,e)));c!==-1;){let h=e[q];if(Mv(s,c,h.data)){let p=kS(c,e,t,o,r,l);if(p!==Gt)return p}u=e[c+8],u!==yi&&xv(r,e[q].data[c+8]===l)&&Mv(s,c,e)?(o=h,c=dc(u),e=fc(u,e)):c=-1}}return i}function kS(n,e,t,r,i,s){let o=e[q],c=o.data[n+8],u=r==null?wr(c)&&vf:r!=o&&(c.type&3)!==0,l=i&1&&s===c,h=cc(c,o,t,u,l);return h!==null?hc(e,o,h,c,i):Gt}function cc(n,e,t,r,i){let s=n.providerIndexes,o=e.data,c=s&1048575,u=n.directiveStart,l=n.directiveEnd,h=s>>20,p=r?c:c+h,m=i?c+h:l;for(let I=p;I<m;I++){let S=o[I];if(I<u&&t===S||I>=u&&S.type===t)return I}if(i){let I=o[u];if(I&&Tr(I)&&I.type===t)return u}return null}function hc(n,e,t,r,i){let s=n[t],o=e.data;if(s instanceof Zs){let c=s;if(c.resolving){let I=M_(o[t]);throw kd(I)}let u=Rv(c.canSeeViewProviders);c.resolving=!0;let l=o[t].type||o[t],h,p=c.injectImpl?ct(c.injectImpl):null,m=sf(n,r,0);try{s=n[t]=c.factory(void 0,i,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&wS(t,o[t],e)}finally{p!==null&&ct(p),Rv(u),c.resolving=!1,of()}}return s}function OS(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(mr)?n[mr]:void 0;return typeof e=="number"?e>=0?e&aE:LS:e}function Mv(n,e,t){let r=1<<n;return!!(t[e+(n>>cE)]&r)}function xv(n,e){return!(n&2)&&!(n&1&&e)}var Sr=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return hE(this._tNode,this._lView,e,hr(r),t)}};function LS(){return new Sr($t(),Ee())}function FS(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[$]&2048&&!fi(o);){let c=pE(s,o,t,r|2,Gt);if(c!==Gt)return c;let u=s.parent;if(!u){let l=o[$d];if(l){let h=l.get(t,Gt,r);if(h!==Gt)return h}u=gE(o),o=o[vr]}s=u}return i}function gE(n){let e=n[q],t=e.type;return t===2?e.declTNode:t===1?n[yt]:null}function VS(){return wi($t(),Ee())}function wi(n,e){return new Ti(jt(n,e))}var Ti=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=VS}return n})();function BS(n){return n instanceof Ti?n.nativeElement:n}function jS(){return this._results[Symbol.iterator]()}var pc=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new sn}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let r=L_(e);(this._changesDetected=!O_(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=jS};function mE(n){return(n.flags&128)===128}var jf=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(jf||{}),yE=new Map,US=0;function HS(){return US++}function $S(n){yE.set(n[js],n)}function Ef(n){yE.delete(n[js])}var Pv="__ngContext__";function _i(n,e){cn(e)?(n[Pv]=e[js],$S(e)):n[Pv]=e}function _E(n){return EE(n[di])}function vE(n){return EE(n[mt])}function EE(n){for(;n!==null&&!bt(n);)n=n[mt];return n}var qS;function Uf(n){qS=n}var Ec=new ce("",{factory:()=>zS}),zS="ng";var Ic=new ce(""),ro=new ce("",{providedIn:"platform",factory:()=>"unknown"});var wc=new ce("",{factory:()=>te(St).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var IE=!1,wE=new ce("",{factory:()=>IE});var GS=(n,e,t,r)=>{};function WS(n,e,t,r){GS(n,e,t,r)}function Hf(n){return(n.flags&32)===32}var KS=()=>null;function TE(n,e,t=!1){return KS(n,e,t)}function DE(n,e){let t=n.contentQueries;if(t!==null){let r=G(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let c=n.data[o];Ja(s),c.contentQueries(2,e[o],o)}}}finally{G(r)}}}function If(n,e,t){Ja(0);let r=G(null);try{e(n,t)}finally{G(r)}}function CE(n,e,t){if(qd(e)){let r=G(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let c=n.data[o];if(c.contentQueries){let u=t[o];c.contentQueries(1,u,o)}}}finally{G(r)}}}var Nt=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Nt||{});var gc=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${La})`}};function $f(n){return n instanceof gc?n.changingThisBreaksApplicationSecurity:n}function bE(n,e){let t=SE(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${La})`)}return t===e}function SE(n){return n instanceof gc&&n.getTypeName()||null}var QS=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function AE(n){return n=String(n),n.match(QS)?n:"unsafe:"+n}function YS(n,e){return n.createText(e)}function ZS(n,e,t){n.setValue(e,t)}function NE(n,e,t){return n.createElement(e,t)}function mc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function RE(n,e,t){n.appendChild(e,t)}function kv(n,e,t,r,i){r!==null?mc(n,e,t,r,i):RE(n,e,t)}function JS(n,e,t,r){n.removeChild(null,e,t,r)}function XS(n,e,t){n.setAttribute(e,"style",t)}function e0(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function ME(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&bS(n,e,r),i!==null&&e0(n,e,i),s!==null&&XS(n,e,s)}var qf=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(qf||{});function zf(n){let e=t0();return e?e.sanitize(qf.URL,n)||"":bE(n,"URL")?$f(n):AE(Ua(n))}function t0(){let n=Ee();return n&&n[Vt].sanitizer}function Rr(n){return n.ownerDocument.defaultView}function n0(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}var xE="ng-template";function r0(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&n0(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Gf(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Gf(n){return n.type===4&&n.value!==xE}function i0(n,e,t){let r=n.type===4&&!t?xE:n.value;return e===r}function s0(n,e,t){let r=4,i=n.attrs,s=i!==null?c0(i):0,o=!1;for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="number"){if(!o&&!At(r)&&!At(u))return!1;if(o&&At(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!i0(n,u,t)||u===""&&e.length===1){if(At(r))return!1;o=!0}}else if(r&8){if(i===null||!r0(n,i,u,t)){if(At(r))return!1;o=!0}}else{let l=e[++c],h=o0(u,i,Gf(n),t);if(h===-1){if(At(r))return!1;o=!0;continue}if(l!==""){let p;if(h>s?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(At(r))return!1;o=!0}}}}return At(r)||o}function At(n){return(n&1)===0}function o0(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let c=e[++i];for(;typeof c=="string";)c=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return u0(e,n)}function a0(n,e,t=!1){for(let r=0;r<e.length;r++)if(s0(n,e[r],t))return!0;return!1}function c0(n){for(let e=0;e<n.length;e++){let t=n[e];if(SS(t))return e}return n.length}function u0(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Ov(n,e){return n?":not("+e.trim()+")":e}function l0(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let c=n[++t];i+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!At(o)&&(e+=Ov(s,i),i=""),r=o,s=s||!At(r);t++}return i!==""&&(e+=Ov(s,i)),e}function d0(n){return n.map(l0).join(",")}function f0(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!At(i))break;i=s}r++}return t.length&&e.push(1,...t),e}var Bn={};function Wf(n,e,t,r,i,s,o,c,u,l,h){let p=ot+r,m=p+i,I=h0(p,m),S=typeof l=="function"?l():l;return I[q]={type:n,blueprint:I,template:t,queries:null,viewQuery:c,declTNode:e,data:I.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:S,incompleteFirstPass:!1,ssrId:h}}function h0(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Bn);return t}function p0(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Wf(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Kf(n,e,t,r,i,s,o,c,u,l,h){let p=e.blueprint.slice();return p[Dt]=i,p[$]=r|4|128|8|64|1024,(l!==null||n&&n[$]&2048)&&(p[$]|=2048),Wd(p),p[Fe]=p[vr]=n,p[Ge]=t,p[Vt]=o||n&&n[Vt],p[Ve]=c||n&&n[Ve],p[kn]=u||n&&n[kn]||null,p[yt]=s,p[js]=HS(),p[Bs]=h,p[$d]=l,p[Ct]=e.type==2?n[Ct]:p,p}function g0(n,e,t){let r=jt(e,n),i=p0(t),s=n[Vt].rendererFactory,o=Qf(n,Kf(n,i,null,PE(t),r,e,null,s.createRenderer(r,t),null,null,null));return n[e.index]=o}function PE(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function kE(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Qf(n,e){return n[di]?n[Hd][mt]=e:n[di]=e,n[Hd]=e,e}function fe(n=1){OE(Ht(),Ee(),Cr()+n,!1)}function OE(n,e,t,r){if(!r)if((e[$]&3)===3){let s=n.preOrderCheckHooks;s!==null&&oc(e,s,t)}else{let s=n.preOrderHooks;s!==null&&ac(e,s,0,t)}Fn(t)}var Tc=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Tc||{});function wf(n,e,t,r){let i=G(null);try{let[s,o,c]=n.inputs[t],u=null;(o&Tc.SignalBased)!==0&&(u=e[s][ht]),u!==null&&u.transformFn!==void 0?r=u.transformFn(r):c!==null&&(r=c.call(e,r)),n.setInput!==null?n.setInput(e,u,r,t,s):tE(e,u,s,r)}finally{G(i)}}var Wt=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Wt||{}),m0;function Yf(n,e){return m0(n,e)}var vi=new Set,Zf=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Zf||{}),io=new ce(""),Lv=new Set;function Jf(n){Lv.has(n)||(Lv.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var LE=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=pe({token:n,providedIn:"root",factory:()=>new n})}return n})();var y0=new ce("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:te(gt)})});function FE(n,e,t){let r=n.get(y0);if(Array.isArray(e))for(let i of e)r.queue.add(i),t?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function _0(n,e){for(let[t,r]of e)FE(n,r.animateFns)}function Fv(n,e,t,r){let i=n?.[Us]?.enter;e!==null&&i&&i.has(t.index)&&_0(r,i)}function mi(n,e,t,r,i,s,o,c){if(i!=null){let u,l=!1;bt(i)?u=i:cn(i)&&(l=!0,i=i[Dt]);let h=_t(i);n===0&&r!==null?(Fv(c,r,s,t),o==null?RE(e,r,h):mc(e,r,h,o||null,!0)):n===1&&r!==null?(Fv(c,r,s,t),mc(e,r,h,o||null,!0)):n===2?Vv(c,s,t,p=>{JS(e,h,l,p)}):n===3&&Vv(c,s,t,()=>{e.destroyNode(h)}),u!=null&&M0(e,n,t,u,s,r,o)}}function v0(n,e){VE(n,e),e[Dt]=null,e[yt]=null}function E0(n,e,t,r,i,s){r[Dt]=i,r[yt]=e,Dc(n,r,t,1,i,s)}function VE(n,e){e[Vt].changeDetectionScheduler?.notify(9),Dc(n,e,e[Ve],2,null,null)}function I0(n){let e=n[di];if(!e)return pf(n[q],n);for(;e;){let t=null;if(cn(e))t=e[di];else{let r=e[nt];r&&(t=r)}if(!t){for(;e&&!e[mt]&&e!==n;)cn(e)&&pf(e[q],e),e=e[Fe];e===null&&(e=n),cn(e)&&pf(e[q],e),t=e&&e[mt]}e=t}}function Xf(n,e){let t=n[Ir],r=t.indexOf(e);t.splice(r,1)}function BE(n,e){if(Dr(e))return;let t=e[Ve];t.destroyNode&&Dc(n,e,t,3,null,null),I0(e)}function pf(n,e){if(Dr(e))return;let t=G(null);try{e[$]&=-129,e[$]|=256,e[lt]&&ei(e[lt]),D0(n,e),T0(n,e),e[q].type===1&&e[Ve].destroy();let r=e[On];if(r!==null&&bt(e[Fe])){r!==e[Fe]&&Xf(r,e);let i=e[Bt];i!==null&&i.detachView(n)}Ef(e)}finally{G(t)}}function Vv(n,e,t,r){let i=n?.[Us];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);n&&vi.add(n),FE(t,()=>{if(i.leave&&i.leave.has(e.index)){let o=i.leave.get(e.index),c=[];if(o){for(let u=0;u<o.animateFns.length;u++){let l=o.animateFns[u],{promise:h}=l();c.push(h)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(c),w0(n,r)}else n&&vi.delete(n),r(!1)},i)}function w0(n,e){let t=n[Us]?.running;if(t){t.then(()=>{n[Us].running=void 0,vi.delete(n),e(!0)});return}e(!1)}function T0(n,e){let t=n.cleanup,r=e[li];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let c=t[o+3];c>=0?r[c]():r[-c].unsubscribe(),o+=2}else{let c=r[t[o+1]];t[o].call(c)}r!==null&&(e[li]=null);let i=e[on];if(i!==null){e[on]=null;for(let o=0;o<i.length;o++){let c=i[o];c()}}let s=e[Mn];if(s!==null){e[Mn]=null;for(let o of s)o.destroy()}}function D0(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Zs)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let c=i[s[o]],u=s[o+1];ge(ue.LifecycleHookStart,c,u);try{u.call(c)}finally{ge(ue.LifecycleHookEnd,c,u)}}else{ge(ue.LifecycleHookStart,i,s);try{s.call(i)}finally{ge(ue.LifecycleHookEnd,i,s)}}}}}function C0(n,e,t){return b0(n,e.parent,t)}function b0(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Dt];if(wr(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Nt.None||i===Nt.Emulated)return null}return jt(r,t)}function S0(n,e,t){return N0(n,e,t)}function A0(n,e,t){return n.type&40?jt(n,t):null}var N0=A0,Bv;function eh(n,e,t,r){let i=C0(n,r,e),s=e[Ve],o=r.parent||e[yt],c=S0(o,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)kv(s,i,t[u],c,!1);else kv(s,i,t,c,!1);Bv!==void 0&&Bv(s,r,e,t,i)}function Qs(n,e){if(e!==null){let t=e.type;if(t&3)return jt(e,n);if(t&4)return Tf(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Qs(n,r);{let i=n[e.index];return bt(i)?Tf(-1,i):_t(i)}}else{if(t&128)return Qs(n,e.next);if(t&32)return Yf(e,n)()||_t(n[e.index]);{let r=jE(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=xn(n[Ct]);return Qs(i,r)}else return Qs(n,e.next)}}}return null}function jE(n,e){if(e!==null){let r=n[Ct][yt],i=e.projection;return r.projection[i]}return null}function Tf(n,e){let t=nt+n+1;if(t<e.length){let r=e[t],i=r[q].firstChild;if(i!==null)return Qs(r,i)}return e[Ln]}function th(n,e,t,r,i,s,o){for(;t!=null;){let c=r[kn];if(t.type===128){t=t.next;continue}let u=r[t.index],l=t.type;if(o&&e===0&&(u&&_i(_t(u),r),t.flags|=2),!Hf(t))if(l&8)th(n,e,t.child,r,i,s,!1),mi(e,n,c,i,u,t,s,r);else if(l&32){let h=Yf(t,r),p;for(;p=h();)mi(e,n,c,i,p,t,s,r);mi(e,n,c,i,u,t,s,r)}else l&16?R0(n,e,r,t,i,s):mi(e,n,c,i,u,t,s,r);t=o?t.projectionNext:t.next}}function Dc(n,e,t,r,i,s){th(t,r,n.firstChild,e,i,s,!1)}function R0(n,e,t,r,i,s){let o=t[Ct],u=o[yt].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let h=u[l];mi(e,n,t[kn],i,h,r,s,t)}else{let l=u,h=o[Fe];mE(r)&&(l.flags|=128),th(n,e,l,h,i,s,!0)}}function M0(n,e,t,r,i,s,o){let c=r[Ln],u=_t(r);c!==u&&mi(e,n,t,s,c,i,o);for(let l=nt;l<r.length;l++){let h=r[l];Dc(h[q],h,n,e,s,c)}}function x0(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Wt.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Wt.Important),n.setStyle(t,r,i,s))}}function UE(n,e,t,r,i){let s=Cr(),o=r&2;try{Fn(-1),o&&e.length>ot&&OE(n,e,ot,!1);let c=o?ue.TemplateUpdateStart:ue.TemplateCreateStart;ge(c,i,t),t(r,i)}finally{Fn(s);let c=o?ue.TemplateUpdateEnd:ue.TemplateCreateEnd;ge(c,i,t)}}function nh(n,e,t){j0(n,e,t),(t.flags&64)===64&&U0(n,e,t)}function HE(n,e,t=jt){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],c=o===-1?t(e,n):n[o];n[i++]=c}}}function P0(n,e,t,r){let s=r.get(wE,IE)||t===Nt.ShadowDom||t===Nt.ExperimentalIsolatedShadowDom,o=n.selectRootElement(e,s);return k0(o),o}function k0(n){O0(n)}var O0=()=>null;function L0(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function F0(n,e,t,r,i,s){let o=e[q];if(rh(n,o,e,t,r)){wr(n)&&B0(e,n.index);return}n.type&3&&(t=L0(t)),V0(n,e,t,r,i,s)}function V0(n,e,t,r,i,s){if(n.type&3){let o=jt(n,e);r=s!=null?s(r,n.value||"",t):r,i.setProperty(o,t,r)}else n.type&12}function B0(n,e){let t=Ut(e,n);t[$]&16||(t[$]|=64)}function j0(n,e,t){let r=t.directiveStart,i=t.directiveEnd;wr(t)&&g0(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||uE(t,e);let s=t.initialInputs;for(let o=r;o<i;o++){let c=n.data[o],u=hc(e,n,o,t);if(_i(u,e),s!==null&&$0(e,o-r,u,c,t,s),Tr(c)){let l=Ut(t.index,e);l[Ge]=hc(e,n,o,t)}}}function U0(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=dv();try{Fn(s);for(let c=r;c<i;c++){let u=n.data[c],l=e[c];Za(c),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&H0(u,l)}}finally{Fn(-1),Za(o)}}function H0(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function $E(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let s=t[i];a0(e,s.selectors,!1)&&(r??=[],Tr(s)?r.unshift(s):r.push(s))}return r}function $0(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let c=0;c<o.length;c+=2){let u=o[c],l=o[c+1];wf(r,t,u,l)}}function q0(n,e,t,r,i){let s=ot+t,o=e[q],c=i(o,e,n,r,t);e[s]=c,pi(n,!0);let u=n.type===2;return u?(ME(e[Ve],c,n),(J_()===0||$s(n))&&_i(c,e),X_()):_i(c,e),tc()&&(!u||!Hf(n))&&eh(o,e,c,n),n}function z0(n){let e=n;return ef()?sv():(e=e.parent,pi(e,!1)),e}function G0(n,e){let t=n[kn];if(!t)return;let r;try{r=t.get(br,null)}catch{r=null}r?.(e)}function rh(n,e,t,r,i){let s=n.inputs?.[r],o=n.hostDirectiveInputs?.[r],c=!1;if(o)for(let u=0;u<o.length;u+=2){let l=o[u],h=o[u+1],p=e.data[l];wf(p,t[l],h,i),c=!0}if(s)for(let u of s){let l=t[u],h=e.data[u];wf(h,l,r,i),c=!0}return c}function W0(n,e){let t=Ut(e,n),r=t[q];K0(r,t);let i=t[Dt];i!==null&&t[Bs]===null&&(t[Bs]=TE(i,t[kn])),ge(ue.ComponentStart);try{ih(r,t,t[Ge])}finally{ge(ue.ComponentEnd,t[Ge])}}function K0(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ih(n,e,t){Xa(e);try{let r=n.viewQuery;r!==null&&If(1,r,t);let i=n.template;i!==null&&UE(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Bt]?.finishViewCreation(n),n.staticContentQueries&&DE(n,e),n.staticViewQueries&&If(2,n.viewQuery,t);let s=n.components;s!==null&&Q0(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[$]&=-5,ec()}}function Q0(n,e){for(let t=0;t<e.length;t++)W0(n,e[t])}function Y0(n,e,t,r){let i=G(null);try{let s=e.tView,c=n[$]&4096?4096:16,u=Kf(n,s,t,c,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[On]=l;let h=n[Bt];return h!==null&&(u[Bt]=h.createEmbeddedView(s)),ih(s,u,t),u}finally{G(i)}}function jv(n,e){return!e||e.firstChild===null||mE(n)}function Js(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(_t(s)),bt(s)&&qE(s,r);let o=t.type;if(o&8)Js(n,e,t.child,r);else if(o&32){let c=Yf(t,e),u;for(;u=c();)r.push(u)}else if(o&16){let c=jE(e,t);if(Array.isArray(c))r.push(...c);else{let u=xn(e[Ct]);Js(u[q],u,c,r,!0)}}t=i?t.projectionNext:t.next}return r}function qE(n,e){for(let t=nt;t<n.length;t++){let r=n[t],i=r[q].firstChild;i!==null&&Js(r[q],r,i,e)}n[Ln]!==n[Dt]&&e.push(n[Ln])}function zE(n){if(n[Wa]!==null){for(let e of n[Wa])e.impl.addSequence(e);n[Wa].length=0}}var GE=[];function Z0(n){return n[lt]??J0(n)}function J0(n){let e=GE.pop()??Object.create(eA);return e.lView=n,e}function X0(n){n.lView[lt]!==n&&(n.lView=null,GE.push(n))}var eA=_e(j({},Xr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{hi(n.lView)},consumerOnSignalRead(){this.lView[lt]=this}});function tA(n){let e=n[lt]??Object.create(nA);return e.lView=n,e}var nA=_e(j({},Xr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=xn(n.lView);for(;e&&!WE(e[q]);)e=xn(e);e&&Kd(e)},consumerOnSignalRead(){this.lView[lt]=this}});function WE(n){return n.type!==2}function KE(n){if(n[Mn]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[Mn])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[$]&8192)}}var rA=100;function QE(n,e=0){let r=n[Vt].rendererFactory,i=!1;i||r.begin?.();try{iA(n,e)}finally{i||r.end?.()}}function iA(n,e){let t=tf();try{Ms(!0),Df(n,e);let r=0;for(;zs(n);){if(r===rA)throw new ee(103,!1);r++,Df(n,1)}}finally{Ms(t)}}function sA(n,e,t,r){if(Dr(e))return;let i=e[$],s=!1,o=!1;Xa(e);let c=!0,u=null,l=null;s||(WE(n)?(l=Z0(e),u=bs(l)):va()===null?(c=!1,l=tA(e),u=bs(l)):e[lt]&&(ei(e[lt]),e[lt]=null));try{Wd(e),av(n.bindingStartIndex),t!==null&&UE(n,e,t,2,r);let h=(i&3)===3;if(!s)if(h){let I=n.preOrderCheckHooks;I!==null&&oc(e,I,null)}else{let I=n.preOrderHooks;I!==null&&ac(e,I,0,null),ff(e,0)}if(o||oA(e),KE(e),YE(e,0),n.contentQueries!==null&&DE(n,e),!s)if(h){let I=n.contentCheckHooks;I!==null&&oc(e,I)}else{let I=n.contentHooks;I!==null&&ac(e,I,1),ff(e,1)}cA(n,e);let p=n.components;p!==null&&JE(e,p,0);let m=n.viewQuery;if(m!==null&&If(2,m,r),!s)if(h){let I=n.viewCheckHooks;I!==null&&oc(e,I)}else{let I=n.viewHooks;I!==null&&ac(e,I,2),ff(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Ga]){for(let I of e[Ga])I();e[Ga]=null}s||(zE(e),e[$]&=-73)}catch(h){throw s||hi(e),h}finally{l!==null&&(Ea(l,u),c&&X0(l)),ec()}}function YE(n,e){for(let t=_E(n);t!==null;t=vE(t))for(let r=nt;r<t.length;r++){let i=t[r];ZE(i,e)}}function oA(n){for(let e=_E(n);e!==null;e=vE(e)){if(!(e[$]&2))continue;let t=e[Ir];for(let r=0;r<t.length;r++){let i=t[r];Kd(i)}}}function aA(n,e,t){ge(ue.ComponentStart);let r=Ut(e,n);try{ZE(r,t)}finally{ge(ue.ComponentEnd,r[Ge])}}function ZE(n,e){Qa(n)&&Df(n,e)}function Df(n,e){let r=n[q],i=n[$],s=n[lt],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Ia(s)),o||=!1,s&&(s.dirty=!1),n[$]&=-9217,o)sA(r,n,r.template,n[Ge]);else if(i&8192){let c=G(null);try{KE(n),YE(n,1);let u=r.components;u!==null&&JE(n,u,1),zE(n)}finally{G(c)}}}function JE(n,e,t){for(let r=0;r<e.length;r++)aA(n,e[r],t)}function cA(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Fn(~i);else{let s=i,o=t[++r],c=t[++r];lv(o,s);let u=e[s];ge(ue.HostBindingsUpdateStart,u);try{c(2,u)}finally{ge(ue.HostBindingsUpdateEnd,u)}}}}finally{Fn(-1)}}function sh(n,e){let t=tf()?64:1088;for(n[Vt].changeDetectionScheduler?.notify(e);n;){n[$]|=t;let r=xn(n);if(fi(n)&&!r)return n;n=r}return null}function XE(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function uA(n,e,t,r=!0){let i=e[q];if(lA(i,e,n,t),r){let o=Tf(t,n),c=e[Ve],u=c.parentNode(n[Ln]);u!==null&&E0(i,n[yt],c,e,u,o)}let s=e[Bs];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Cf(n,e){if(n.length<=nt)return;let t=nt+e,r=n[t];if(r){let i=r[On];i!==null&&i!==n&&Xf(i,r),e>0&&(n[t-1][mt]=r[mt]);let s=Os(n,nt+e);v0(r[q],r);let o=s[Bt];o!==null&&o.detachView(s[q]),r[Fe]=null,r[mt]=null,r[$]&=-129}return r}function lA(n,e,t,r){let i=nt+r,s=t.length;r>0&&(t[i-1][mt]=e),r<s-nt?(e[mt]=t[i],Ld(t,nt+r,e)):(t.push(e),e[mt]=null),e[Fe]=t;let o=e[On];o!==null&&t!==o&&eI(o,e);let c=e[Bt];c!==null&&c.insertView(n),Ya(e),e[$]|=128}function eI(n,e){let t=n[Ir],r=e[Fe];if(cn(r))n[$]|=2;else{let i=r[Fe][Ct];e[Ct]!==i&&(n[$]|=2)}t===null?n[Ir]=[e]:t.push(e)}var Ei=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[q];return Js(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Ge]}set context(e){this._lView[Ge]=e}get destroyed(){return Dr(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Fe];if(bt(e)){let t=e[Hs],r=t?t.indexOf(this):-1;r>-1&&(Cf(e,r),Os(t,r))}this._attachedToViewContainer=!1}BE(this._lView[q],this._lView)}onDestroy(e){Qd(this._lView,e)}markForCheck(){sh(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[$]&=-129}reattach(){Ya(this._lView),this._lView[$]|=128}detectChanges(){this._lView[$]|=1024,QE(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ee(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=fi(this._lView),t=this._lView[On];t!==null&&!e&&Xf(t,this._lView),VE(this._lView[q],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ee(902,!1);this._appRef=e;let t=fi(this._lView),r=this._lView[On];r!==null&&!t&&eI(r,this._lView),Ya(this._lView)}};var Vn=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=dA;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let s=Y0(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new Ei(s)}}return n})();function dA(){return oh($t(),Ee())}function oh(n,e){return n.type&4?new Vn(e,n,wi(n,e)):null}function ah(n,e,t,r,i){let s=n.data[e];if(s===null)s=fA(n,e,t,r,i),uv()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=iv();s.injectorIndex=o===null?-1:o.injectorIndex}return pi(s,!0),s}function fA(n,e,t,r,i){let s=Xd(),o=ef(),c=o?s:s&&s.parent,u=n.data[e]=pA(n,c,t,e,r,i);return hA(n,u,s,o),u}function hA(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function pA(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,c=0;return tv()&&(c|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:c,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var gA=()=>null;function Uv(n,e){return gA(n,e)}var tI=class{},Cc=class{},bf=class{resolveComponentFactory(e){throw new ee(917,!1)}},bc=class{static NULL=new bf},Ar=class{};var nI=(()=>{class n{static \u0275prov=pe({token:n,providedIn:"root",factory:()=>null})}return n})();var uc={},Sf=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,uc,r);return i!==uc||t===uc?i:this.parentInjector.get(e,t,r)}};function Hv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let c=e[o];if(typeof c=="number")s=c;else if(s==1)i=Sd(i,c);else if(s==2){let u=c,l=e[++o];r=Sd(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function Rt(n,e=0){let t=Ee();if(t===null)return de(n,e);let r=$t();return hE(r,t,ut(n),e)}function rI(n,e,t,r,i){let s=r===null?null:{"":-1},o=i(n,t);if(o!==null){let c=o,u=null,l=null;for(let h of o)if(h.resolveHostDirectives!==null){[c,u,l]=h.resolveHostDirectives(o);break}_A(n,e,t,c,s,u,l)}s!==null&&r!==null&&mA(t,r,s)}function mA(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new ee(-301,!1);r.push(e[i],s)}}function yA(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function _A(n,e,t,r,i,s,o){let c=r.length,u=null;for(let m=0;m<c;m++){let I=r[m];u===null&&Tr(I)&&(u=I,yA(n,t,m)),PS(uE(t,e),n,I.type)}DA(t,n.data.length,c),u?.viewProvidersResolver&&u.viewProvidersResolver(u);for(let m=0;m<c;m++){let I=r[m];I.providersResolver&&I.providersResolver(I)}let l=!1,h=!1,p=kE(n,e,c,null);c>0&&(t.directiveToIndex=new Map);for(let m=0;m<c;m++){let I=r[m];if(t.mergedAttrs=Vf(t.mergedAttrs,I.hostAttrs),EA(n,t,e,p,I),TA(p,I,i),o!==null&&o.has(I)){let[M,R]=o.get(I);t.directiveToIndex.set(I.type,[p,M+t.directiveStart,R+t.directiveStart])}else(s===null||!s.has(I))&&t.directiveToIndex.set(I.type,p);I.contentQueries!==null&&(t.flags|=4),(I.hostBindings!==null||I.hostAttrs!==null||I.hostVars!==0)&&(t.flags|=64);let S=I.type.prototype;!l&&(S.ngOnChanges||S.ngOnInit||S.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!h&&(S.ngOnChanges||S.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),h=!0),p++}vA(n,t,s)}function vA(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))$v(0,e,i,r),$v(1,e,i,r),zv(e,r,!1);else{let s=t.get(i);qv(0,e,s,r),qv(1,e,s,r),zv(e,r,!0)}}}function $v(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o;n===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(r),iI(e,s)}}function qv(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o=i[s],c;n===0?c=e.hostDirectiveInputs??={}:c=e.hostDirectiveOutputs??={},c[o]??=[],c[o].push(r,s),iI(e,o)}}function iI(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function zv(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:s}=n;if(r===null||!t&&i===null||t&&s===null||Gf(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let o=null,c=0;for(;c<r.length;){let u=r[c];if(u===0){c+=4;continue}else if(u===5){c+=2;continue}else if(typeof u=="number")break;if(!t&&i.hasOwnProperty(u)){let l=i[u];for(let h of l)if(h===e){o??=[],o.push(u,r[c+1]);break}}else if(t&&s.hasOwnProperty(u)){let l=s[u];for(let h=0;h<l.length;h+=2)if(l[h]===e){o??=[],o.push(l[h+1],r[c+1]);break}}c+=2}n.initialInputs??=[],n.initialInputs.push(o)}function EA(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=ci(i.type,!0)),o=new Zs(s,Tr(i),Rt,null);n.blueprint[r]=o,t[r]=o,IA(n,e,r,kE(n,t,i.hostVars,Bn),i)}function IA(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let c=~e.index;wA(o)!=c&&o.push(c),o.push(t,r,s)}}function wA(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function TA(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Tr(e)&&(t[""]=n)}}function DA(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function sI(n,e,t,r,i,s,o,c){let u=e[q],l=u.consts,h=qs(l,o),p=ah(u,n,t,r,h);return s&&rI(u,e,p,qs(l,c),i),p.mergedAttrs=Vf(p.mergedAttrs,p.attrs),p.attrs!==null&&Hv(p,p.attrs,!1),p.mergedAttrs!==null&&Hv(p,p.mergedAttrs,!0),u.queries!==null&&u.queries.elementStart(u,p),p}function oI(n,e){iE(n,e),qd(e)&&n.queries.elementEnd(e)}function ch(n){return cI(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function aI(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function cI(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function uh(n,e,t){if(t===Bn)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function gf(n,e,t){return function r(i){let s=wr(n)?Ut(n.index,e):e;sh(s,5);let o=e[Ge],c=Gv(e,o,t,i),u=r.__ngNextListenerFn__;for(;u;)c=Gv(e,o,u,i)&&c,u=u.__ngNextListenerFn__;return c}}function Gv(n,e,t,r){let i=G(null);try{return ge(ue.OutputStart,e,t),t(r)!==!1}catch(s){return G0(n,s),!1}finally{ge(ue.OutputEnd,e,t),G(i)}}function CA(n,e,t,r,i,s,o,c){let u=$s(n),l=!1,h=null;if(!r&&u&&(h=SA(e,t,s,n.index)),h!==null){let p=h.__ngLastListenerFn__||h;p.__ngNextListenerFn__=o,h.__ngLastListenerFn__=o,l=!0}else{let p=jt(n,t),m=r?r(p):p;WS(t,m,s,c);let I=i.listen(m,s,c);if(!bA(s)){let S=r?M=>r(_t(M[n.index])):n.index;uI(S,e,t,s,c,I,!1)}}return l}function bA(n){return n.startsWith("animation")||n.startsWith("transition")}function SA(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let c=e[li],u=i[s+2];return c&&c.length>u?c[u]:null}typeof o=="string"&&(s+=2)}return null}function uI(n,e,t,r,i,s,o){let c=e.firstCreatePass?Zd(e):null,u=Yd(t),l=u.length;u.push(i,s),c&&c.push(r,n,l,(l+1)*(o?-1:1))}function Wv(n,e,t,r,i,s){let o=e[t],c=e[q],l=c.data[t].outputs[r],p=o[l].subscribe(s);uI(n.index,c,e,i,s,p,!0)}var Af=Symbol("BINDING");var Nf=class extends bc{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=yr(e);return new Xs(t,this.ngModule)}};function AA(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],s={propName:t,templateName:e,isSignal:(r&Tc.SignalBased)!==0};return i&&(s.transform=i),s})}function NA(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function RA(n,e,t){let r=e instanceof gt?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new Sf(t,r):t}function MA(n){let e=n.get(Ar,null);if(e===null)throw new ee(407,!1);let t=n.get(nI,null),r=n.get(gr,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function xA(n,e){let t=lI(n);return NE(e,t,t==="svg"?zd:t==="math"?z_:null)}function lI(n){return(n.selectors[0][0]||"div").toLowerCase()}var Xs=class extends Cc{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=AA(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=NA(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=d0(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,s,o){ge(ue.DynamicComponentStart);let c=G(null);try{let u=this.componentDef,l=PA(r,u,o,s),h=RA(u,i||this.ngModule,e),p=MA(h),m=p.rendererFactory.createRenderer(null,u),I=r?P0(m,r,u.encapsulation,h):xA(u,m),S=o?.some(Kv)||s?.some(F=>typeof F!="function"&&F.bindings.some(Kv)),M=Kf(null,l,null,512|PE(u),null,null,p,m,h,null,TE(I,h,!0));M[ot]=I,Xa(M);let R=null;try{let F=sI(ot,M,2,"#host",()=>l.directiveRegistry,!0,0);ME(m,I,F),_i(I,M),nh(l,M,F),CE(l,F,M),oI(l,F),t!==void 0&&OA(F,this.ngContentSelectors,t),R=Ut(F.index,M),M[Ge]=R[Ge],ih(l,M,null)}catch(F){throw R!==null&&Ef(R),Ef(M),F}finally{ge(ue.DynamicComponentEnd),ec()}return new yc(this.componentType,M,!!S)}finally{G(c)}}};function PA(n,e,t,r){let i=n?["ng-version","21.0.6"]:f0(e.selectors[0]),s=null,o=null,c=0;if(t)for(let h of t)c+=h[Af].requiredVars,h.create&&(h.targetIdx=0,(s??=[]).push(h)),h.update&&(h.targetIdx=0,(o??=[]).push(h));if(r)for(let h=0;h<r.length;h++){let p=r[h];if(typeof p!="function")for(let m of p.bindings){c+=m[Af].requiredVars;let I=h+1;m.create&&(m.targetIdx=I,(s??=[]).push(m)),m.update&&(m.targetIdx=I,(o??=[]).push(m))}}let u=[e];if(r)for(let h of r){let p=typeof h=="function"?h:h.type,m=xd(p);u.push(m)}return Wf(0,null,kA(s,o),1,c,u,null,null,null,[i],null)}function kA(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function Kv(n){let e=n[Af].kind;return e==="input"||e==="twoWay"}var yc=class extends tI{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=Ka(t[q],ot),this.location=wi(this._tNode,t),this.instance=Ut(this._tNode.index,t)[Ge],this.hostView=this.changeDetectorRef=new Ei(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,s=rh(r,i[q],i,e,t);this.previousInputValues.set(e,t);let o=Ut(r.index,i);sh(o,1)}get injector(){return new Sr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function OA(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null&&s.length?Array.from(s):null)}}var Mr=(()=>{class n{static __NG_ELEMENT_ID__=LA}return n})();function LA(){let n=$t();return fI(n,Ee())}var FA=Mr,dI=class extends FA{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return wi(this._hostTNode,this._hostLView)}get injector(){return new Sr(this._hostTNode,this._hostLView)}get parentInjector(){let e=Bf(this._hostTNode,this._hostLView);if(oE(e)){let t=fc(e,this._hostLView),r=dc(e),i=t[q].data[r+8];return new Sr(i,t)}else return new Sr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Qv(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-nt}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Uv(this._lContainer,e.ssrId),c=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(c,i,jv(this._hostTNode,o)),c}createComponent(e,t,r,i,s,o,c){let u=e&&!yS(e),l;if(u)l=t;else{let R=t||{};l=R.index,r=R.injector,i=R.projectableNodes,s=R.environmentInjector||R.ngModuleRef,o=R.directives,c=R.bindings}let h=u?e:new Xs(yr(e)),p=r||this.parentInjector;if(!s&&h.ngModule==null){let F=(u?p:this.parentInjector).get(gt,null);F&&(s=F)}let m=yr(h.componentType??{}),I=Uv(this._lContainer,m?.id??null),S=I?.firstChild??null,M=h.create(p,i,S,s,o,c);return this.insertImpl(M.hostView,l,jv(this._hostTNode,I)),M}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(K_(i)){let c=this.indexOf(e);if(c!==-1)this.detach(c);else{let u=i[Fe],l=new dI(u,u[yt],u[Fe]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return uA(o,i,s,r),e.attachToViewContainerRef(),Ld(mf(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Qv(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Cf(this._lContainer,t);r&&(Os(mf(this._lContainer),t),BE(r[q],r))}detach(e){let t=this._adjustIndex(e,-1),r=Cf(this._lContainer,t);return r&&Os(mf(this._lContainer),t)!=null?new Ei(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function Qv(n){return n[Hs]}function mf(n){return n[Hs]||(n[Hs]=[])}function fI(n,e){let t,r=e[n.index];return bt(r)?t=r:(t=XE(r,e,null,n),e[n.index]=t,Qf(e,t)),BA(t,e,n,r),new dI(t,n,e)}function VA(n,e){let t=n[Ve],r=t.createComment(""),i=jt(e,n),s=t.parentNode(i);return mc(t,s,r,t.nextSibling(i),!1),r}var BA=HA,jA=()=>!1;function UA(n,e,t){return jA(n,e,t)}function HA(n,e,t,r){if(n[Ln])return;let i;t.type&8?i=_t(r):i=VA(e,t),n[Ln]=i}var Rf=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Mf=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let r=e.contentQueries!==null?e.contentQueries[0]:t.length,i=[];for(let s=0;s<r;s++){let o=t.getByIndex(s),c=this.queries[o.indexInDeclarationView];i.push(c.clone())}return new n(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)lh(e,t).matches!==null&&this.queries[t].setDirty()}},xf=class{flags;read;predicate;constructor(e,t,r=null){this.flags=t,this.read=r,typeof e=="string"?this.predicate=YA(e):this.predicate=e}},Pf=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,t!==null?t.push(s):t=[s])}return t!==null?new n(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},kf=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let s=r[i];this.matchTNodeWithReadOption(e,t,$A(t,s)),this.matchTNodeWithReadOption(e,t,cc(t,e,s,!1,!1))}else r===Vn?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,cc(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===Ti||i===Mr||i===Vn&&t.type&4)this.addMatch(t.index,-2);else{let s=cc(t,e,i,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,r)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function $A(n,e){let t=n.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1]}return null}function qA(n,e){return n.type&11?wi(n,e):n.type&4?oh(n,e):null}function zA(n,e,t,r){return t===-1?qA(e,n):t===-2?GA(n,e,r):hc(n,n[q],t,e)}function GA(n,e,t){if(t===Ti)return wi(e,n);if(t===Vn)return oh(e,n);if(t===Mr)return fI(e,n)}function hI(n,e,t,r){let i=e[Bt].queries[r];if(i.matches===null){let s=n.data,o=t.matches,c=[];for(let u=0;o!==null&&u<o.length;u+=2){let l=o[u];if(l<0)c.push(null);else{let h=s[l];c.push(zA(e,h,o[u+1],t.metadata.read))}}i.matches=c}return i.matches}function Of(n,e,t,r){let i=n.queries.getByIndex(t),s=i.matches;if(s!==null){let o=hI(n,e,i,t);for(let c=0;c<s.length;c+=2){let u=s[c];if(u>0)r.push(o[c/2]);else{let l=s[c+1],h=e[-u];for(let p=nt;p<h.length;p++){let m=h[p];m[On]===m[Fe]&&Of(m[q],m,l,r)}if(h[Ir]!==null){let p=h[Ir];for(let m=0;m<p.length;m++){let I=p[m];Of(I[q],I,l,r)}}}}}return r}function WA(n,e){return n[Bt].queries[e].queryList}function KA(n,e,t){let r=new pc((t&4)===4);return Z_(n,e,r,r.destroy),(e[Bt]??=new Mf).queries.push(new Rf(r))-1}function QA(n,e,t){let r=Ht();return r.firstCreatePass&&(ZA(r,new xf(n,e,t),-1),(e&2)===2&&(r.staticViewQueries=!0)),KA(r,Ee(),e)}function YA(n){return n.split(",").map(e=>e.trim())}function ZA(n,e,t){n.queries===null&&(n.queries=new Pf),n.queries.track(new kf(e,t))}function lh(n,e){return n.queries.getByIndex(e)}function JA(n,e){let t=n[q],r=lh(t,e);return r.crossesNgTemplate?Of(t,n,e,[]):hI(t,n,r,e)}var eo=class{};var to=class extends eo{injector;componentFactoryResolver=new Nf(this);instance=null;constructor(e){super();let t=new pr([...e.providers,{provide:eo,useValue:this},{provide:bc,useValue:this.componentFactoryResolver}],e.parent||Vs(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function pI(n,e,t=null){return new to({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var XA=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=jd(!1,t.type),i=r.length>0?pI([r],this._injector,""):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=pe({token:n,providedIn:"environment",factory:()=>new n(de(gt))})}return n})();function so(n){return vc(()=>{let e=gI(n),t=_e(j({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===jf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(XA).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Nt.Emulated,styles:n.styles||pt,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Jf("NgStandalone"),mI(t);let r=n.dependencies;return t.directiveDefs=Yv(r,eN),t.pipeDefs=Yv(r,R_),t.id=rN(t),t})}function eN(n){return yr(n)||xd(n)}function Sc(n){return vc(()=>({type:n.type,bootstrap:n.bootstrap||pt,declarations:n.declarations||pt,imports:n.imports||pt,exports:n.exports||pt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function tN(n,e){if(n==null)return _r;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,c,u;Array.isArray(i)?(c=i[0],s=i[1],o=i[2]??s,u=i[3]||null):(s=i,o=i,c=Tc.None,u=null),t[s]=[r,c,u],e[s]=o}return t}function nN(n){if(n==null)return _r;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Ac(n){return vc(()=>{let e=gI(n);return mI(e),e})}function gI(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||_r,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||pt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:tN(n.inputs,e),outputs:nN(n.outputs),debugInfo:null}}function mI(n){n.features?.forEach(e=>e(n))}function Yv(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let s=e(i);s!==null&&r.push(s)}return r}:null}function rN(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function iN(n,e,t,r,i,s,o,c){if(t.firstCreatePass){n.mergedAttrs=Vf(n.mergedAttrs,n.attrs);let h=n.tView=Wf(2,n,i,s,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),h.queries=t.queries.embeddedTView(n))}c&&(n.flags|=c),pi(n,!1);let u=oN(t,e,n,r);tc()&&eh(t,e,u,n),_i(u,e);let l=XE(u,e,u,n);e[r+ot]=l,Qf(e,l),UA(l,n,e)}function sN(n,e,t,r,i,s,o,c,u,l,h){let p=t+ot,m;return e.firstCreatePass?(m=ah(e,p,4,o||null,c||null),Jd()&&rI(e,n,m,qs(e.consts,l),$E),iE(e,m)):m=e.data[p],iN(m,n,e,t,r,i,s,u),$s(m)&&nh(e,n,m),l!=null&&HE(n,m,h),m}function Ke(n,e,t,r,i,s,o,c){let u=Ee(),l=Ht(),h=qs(l.consts,s);return sN(u,l,n,e,t,r,i,h,void 0,o,c),Ke}var oN=aN;function aN(n,e,t,r){return nc(!0),e[Ve].createComment("")}var dh=new ce("");function Nc(n){return!!n&&typeof n.then=="function"}function fh(n){return!!n&&typeof n.subscribe=="function"}var yI=new ce("");var hh=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=te(yI,{optional:!0})??[];injector=te(Pn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=za(this.injector,i);if(Nc(s))t.push(s);else if(fh(s)){let o=new Promise((c,u)=>{s.subscribe({complete:c,error:u})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_I=new ce("");function vI(){Xl(()=>{let n="";throw new ee(600,n)})}function EI(n){return n.isBoundToModule}var cN=10;var Rc=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=te(br);afterRenderManager=te(LE);zonelessEnabled=te(Ws);rootEffectScheduler=te(ic);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new sn;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=te(gi);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(fd(t=>!t))}constructor(){te(io,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=te(gt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=Pn.NULL){return this._injector.get(ze).run(()=>{ge(ue.BootstrapComponentStart);let o=t instanceof Cc;if(!this._injector.get(hh).done){let S="";throw new ee(405,S)}let u;o?u=t:u=this._injector.get(bc).resolveComponentFactory(t),this.componentTypes.push(u.componentType);let l=EI(u)?void 0:this._injector.get(eo),h=r||u.selector,p=u.create(i,[],h,l),m=p.location.nativeElement,I=p.injector.get(dh,null);return I?.registerApplication(m),p.onDestroy(()=>{this.detachView(p.hostView),Ys(this.components,p),I?.unregisterApplication(m)}),this._loadComponent(p),ge(ue.BootstrapComponentEnd,p),p})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){ge(ue.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(Zf.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw ge(ue.ChangeDetectionEnd),new ee(101,!1);let t=G(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,G(t),this.afterTick.next(),ge(ue.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Ar,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<cN;){ge(ue.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{ge(ue.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!zs(i))continue;let s=r&&!this.zonelessEnabled?0:1;QE(i,s),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>zs(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Ys(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(_I,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ys(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ee(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ys(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var aV=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function me(n,e,t){let r=Ee(),i=nf();if(uh(r,i,e)){let s=Ht(),o=yv();F0(o,r,n,e,r[Ve],t)}return me}function Zv(n,e,t,r,i){rh(e,n,t,i?"class":"style",r)}function O(n,e,t,r){let i=Ee(),s=i[q],o=n+ot,c=s.firstCreatePass?sI(o,i,2,e,$E,Jd(),t,r):s.data[o];if(q0(c,i,n,e,uN),$s(c)){let u=i[q];nh(u,i,c),CE(u,c,i)}return r!=null&&HE(i,c),O}function U(){let n=Ht(),e=$t(),t=z0(e);return n.firstCreatePass&&oI(n,t),nv(t)&&rv(),ev(),t.classesWithoutHost!=null&&DS(t)&&Zv(n,t,Ee(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&CS(t)&&Zv(n,t,Ee(),t.stylesWithoutHost,!1),U}function Ce(n,e,t,r){return O(n,e,t,r),U(),Ce}var uN=(n,e,t,r,i)=>(nc(!0),NE(e[Ve],r,_v()));function vt(){return Ee()}var oo="en-US";var lN=oo;function II(n){typeof n=="string"&&(lN=n.toLowerCase().replace(/_/g,"-"))}function Te(n,e,t){let r=Ee(),i=Ht(),s=$t();return dN(i,r,r[Ve],s,n,e,t),Te}function dN(n,e,t,r,i,s,o){let c=!0,u=null;if((r.type&3||o)&&(u??=gf(r,e,s),CA(r,n,e,o,t,i,s,u)&&(c=!1)),c){let l=r.outputs?.[i],h=r.hostDirectiveOutputs?.[i];if(h&&h.length)for(let p=0;p<h.length;p+=2){let m=h[p],I=h[p+1];u??=gf(r,e,s),Wv(r,e,m,I,i,u)}if(l&&l.length)for(let p of l)u??=gf(r,e,s),Wv(r,e,p,i,i,u)}}function be(n=1){return mv(n)}function Di(n,e,t){return QA(n,e,t),Di}function Ci(n){let e=Ee(),t=Ht(),r=rf();Ja(r+1);let i=lh(t,r);if(n.dirty&&W_(e)===((i.metadata.flags&2)===2)){if(i.matches===null)n.reset([]);else{let s=JA(e,r);n.reset(s,BS),n.notifyOnChanges()}return!0}return!1}function bi(){return WA(Ee(),rf())}function xr(n){let e=ov();return G_(e,ot+n)}function sc(n,e){return n<<17|e<<2}function Nr(n){return n>>17&32767}function fN(n){return(n&2)==2}function hN(n,e){return n&131071|e<<17}function Lf(n){return n|2}function Ii(n){return(n&131068)>>2}function yf(n,e){return n&-131069|e<<2}function pN(n){return(n&1)===1}function Ff(n){return n|1}function gN(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,c=Nr(o),u=Ii(o);n[r]=t;let l=!1,h;if(Array.isArray(t)){let p=t;h=p[1],(h===null||ui(p,h)>0)&&(l=!0)}else h=t;if(i)if(u!==0){let m=Nr(n[c+1]);n[r+1]=sc(m,c),m!==0&&(n[m+1]=yf(n[m+1],r)),n[c+1]=hN(n[c+1],r)}else n[r+1]=sc(c,0),c!==0&&(n[c+1]=yf(n[c+1],r)),c=r;else n[r+1]=sc(u,0),c===0?c=r:n[u+1]=yf(n[u+1],r),u=r;l&&(n[r+1]=Lf(n[r+1])),Jv(n,h,r,!0),Jv(n,h,r,!1),mN(e,h,n,r,s),o=sc(c,u),s?e.classBindings=o:e.styleBindings=o}function mN(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&ui(s,e)>=0&&(t[r+1]=Ff(t[r+1]))}function Jv(n,e,t,r){let i=n[t+1],s=e===null,o=r?Nr(i):Ii(i),c=!1;for(;o!==0&&(c===!1||s);){let u=n[o],l=n[o+1];yN(u,e)&&(c=!0,n[o+1]=r?Ff(l):Lf(l)),o=r?Nr(l):Ii(l)}c&&(n[t+1]=r?Lf(i):Ff(i))}function yN(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?ui(n,e)>=0:!1}function ao(n,e,t){return wI(n,e,t,!1),ao}function Si(n,e){return wI(n,e,null,!0),Si}function wI(n,e,t,r){let i=Ee(),s=Ht(),o=cv(2);if(s.firstUpdatePass&&vN(s,n,o,r),e!==Bn&&uh(i,o,e)){let c=s.data[Cr()];DN(s,c,i,i[Ve],n,i[o+1]=CN(e,t),r,o)}}function _N(n,e){return e>=n.expandoStartIndex}function vN(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[Cr()],o=_N(n,t);bN(s,r)&&e===null&&!o&&(e=!1),e=EN(i,s,e,r),gN(i,s,e,t,o,r)}}function EN(n,e,t,r){let i=fv(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=_f(null,n,e,t,r),t=no(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=_f(i,n,e,t,r),s===null){let u=IN(n,e,r);u!==void 0&&Array.isArray(u)&&(u=_f(null,n,e,u[1],r),u=no(u,e.attrs,r),wN(n,e,r,u))}else s=TN(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function IN(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Ii(r)!==0)return n[Nr(r)]}function wN(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Nr(i)]=r}function TN(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=no(r,o,t)}return no(r,e.attrs,t)}function _f(n,e,t,r,i){let s=null,o=t.directiveEnd,c=t.directiveStylingLast;for(c===-1?c=t.directiveStart:c++;c<o&&(s=e[c],r=no(r,s.hostAttrs,i),s!==n);)c++;return n!==null&&(t.directiveStylingLast=c),r}function no(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),V_(n,o,t?!0:e[++s]))}return n===void 0?null:n}function DN(n,e,t,r,i,s,o,c){if(!(e.type&3))return;let u=n.data,l=u[c+1],h=pN(l)?Xv(u,e,t,i,Ii(l),o):void 0;if(!_c(h)){_c(s)||fN(l)&&(s=Xv(u,null,t,i,c,o));let p=Gd(Cr(),t);x0(r,o,p,i,s)}}function Xv(n,e,t,r,i,s){let o=e===null,c;for(;i>0;){let u=n[i],l=Array.isArray(u),h=l?u[1]:u,p=h===null,m=t[i+1];m===Bn&&(m=p?pt:void 0);let I=p?qa(m,r):h===r?m:void 0;if(l&&!_c(I)&&(I=qa(u,r)),_c(I)&&(c=I,o))return c;let S=n[i+1];i=o?Nr(S):Ii(S)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(c=qa(u,r))}return c}function _c(n){return n!==void 0}function CN(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Rn($f(n)))),n}function bN(n,e){return(n.flags&(e?8:16))!==0}function Ne(n,e=""){let t=Ee(),r=Ht(),i=n+ot,s=r.firstCreatePass?ah(r,i,1,e,null):r.data[i],o=SN(r,t,s,e,n);t[i]=o,tc()&&eh(r,t,o,s),pi(s,!1)}var SN=(n,e,t,r,i)=>(nc(!0),YS(e[Ve],r));function AN(n,e,t,r=""){return uh(n,nf(),t)?e+Ua(t)+r:Bn}function jn(n){return co("",n),jn}function co(n,e,t){let r=Ee(),i=AN(r,n,e,t);return i!==Bn&&NN(r,Cr(),i),co}function NN(n,e,t){let r=Gd(e,n);ZS(n[Ve],r,t)}var TI=(()=>{class n{applicationErrorHandler=te(br);appRef=te(Rc);taskService=te(gi);ngZone=te(ze);zonelessEnabled=te(Ws);tracing=te(io,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new tt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(xs):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(te(df,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?cf:af;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(xs+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,cf(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ph(){return Jf("NgZoneless"),Bd([...gh(),[]])}function gh(){return[{provide:gr,useExisting:TI},{provide:ze,useClass:Ps},{provide:Ws,useValue:!0}]}function RN(){return typeof $localize<"u"&&$localize.locale||oo}var Mc=new ce("",{factory:()=>te(Mc,{optional:!0,skipSelf:!0})||RN()});function uo(n,e){return wa(n,e?.equal)}var mh=new ce(""),zN=new ce("");function lo(n){return!n.moduleRef}function GN(n){let e=lo(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ze);return t.run(()=>{lo(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(br),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),lo(n)){let s=()=>e.destroy(),o=n.platformInjector.get(mh);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(mh);o.add(s),n.moduleRef.onDestroy(()=>{Ys(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return KN(r,t,()=>{let s=e.get(gi),o=s.add(),c=e.get(hh);return c.runInitializers(),c.donePromise.then(()=>{let u=e.get(Mc,oo);if(II(u||oo),!e.get(zN,!0))return lo(n)?e.get(Rc):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(lo(n)){let h=e.get(Rc);return n.rootComponent!==void 0&&h.bootstrap(n.rootComponent),h}else return WN?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void s.remove(o))})})}var WN;function KN(n,e,t){try{let r=t();return Nc(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var xc=null;function QN(n=[],e){return Pn.create({name:e,providers:[{provide:Fs,useValue:"platform"},{provide:mh,useValue:new Set([()=>xc=null])},...n]})}function YN(n=[]){if(xc)return xc;let e=QN(n);return xc=e,vI(),ZN(e),e}function ZN(n){let e=n.get(Ic,null);za(n,()=>{e?.forEach(t=>t())})}var yh=class{constructor(){}supports(e){return ch(e)}create(e){return new _h(e)}},JN=(n,e)=>e,_h=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||JN}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<DI(r,i,s)?t:r,c=DI(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=c-i,h=u-i;if(l!=h){for(let m=0;m<l;m++){let I=m<s.length?s[m]:s[m]=0,S=I+m;h<=S&&S<l&&(s[m]=I+1)}let p=o.previousIndex;s[p]=h-l}}c!==u&&e(o,c,u)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!ch(e))throw new ee(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let c=0;c<this.length;c++)s=e[c],o=this._trackByFn(c,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,c),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,c)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,aI(e,c=>{o=this._trackByFn(i,c),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,c,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,c,o,i)),Object.is(t.item,c)||this._addIdentityChange(t,c)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new vh(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Pc),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Pc),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},vh=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Eh=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Pc=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Eh,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function DI(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function CI(){return new Ih([new yh])}var Ih=(()=>{class n{factories;static \u0275prov=pe({token:n,providedIn:"root",factory:CI});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=te(n,{optional:!0,skipSelf:!0});return n.create(t,r||CI())}}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new ee(901,!1)}}return n})();function SI(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;ge(ue.BootstrapApplicationStart);try{let s=i?.injector??YN(r),o=[gh(),Tv,...t||[]],c=new to({providers:o,parent:s,debugName:"",runEnvironmentInitializers:!1});return GN({r3Injector:c.injector,platformInjector:s,rootComponent:e})}catch(s){return Promise.reject(s)}finally{ge(ue.BootstrapApplicationEnd)}}var AI=null;function ho(){return AI}function wh(n){AI??=n}var fo=class{};var kc=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Lc=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new kc(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let c=r.get(s);r.move(c,o),NI(c,i)}});for(let i=0,s=r.length;i<s;i++){let c=r.get(i).context;c.index=i,c.count=s,c.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);NI(s,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Rt(Mr),Rt(Vn),Rt(Ih))};static \u0275dir=Ac({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function NI(n,e){n.context.$implicit=e.item}var Th=(()=>{class n{_viewContainer;_context=new Oc;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){RI(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){RI(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(Rt(Mr),Rt(Vn))};static \u0275dir=Ac({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Oc=class{$implicit=null;ngIf=null};function RI(n,e){if(n&&!n.createEmbeddedView)throw new ee(2020,!1)}var Ai=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Sc({type:n});static \u0275inj=ks({})}return n})();function Dh(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var po=class{};var MI="browser";var go=class{_doc;constructor(e){this._doc=e}manager},Fc=(()=>{class n extends go{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(de(St))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),jc=new ce(""),Ah=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(o=>{o.manager=this});let i=t.filter(o=>!(o instanceof Fc));this._plugins=i.slice().reverse();let s=t.find(o=>o instanceof Fc);s&&this._plugins.push(s)}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new ee(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(de(jc),de(ze))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),Ch="ng-app-id";function xI(n){for(let e of n)e.remove()}function PI(n,e){let t=e.createElement("style");return t.textContent=n,t}function eR(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Ch}="${e}"],link[${Ch}="${e}"]`);if(i)for(let s of i)s.removeAttribute(Ch),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function Sh(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Nh=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,eR(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,PI);r?.forEach(i=>this.addUsage(i,this.external,Sh))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(xI(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])xI(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,PI(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,Sh(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(de(St),de(Ec),de(wc,8),de(ro))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),bh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Rh=/%COMP%/g;var OI="%COMP%",tR=`_nghost-${OI}`,nR=`_ngcontent-${OI}`,rR=!0,iR=new ce("",{factory:()=>rR});function sR(n){return nR.replace(Rh,n)}function oR(n){return tR.replace(Rh,n)}function LI(n,e){return e.map(t=>t.replace(Rh,n))}var Mh=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,r,i,s,o,c,u=null,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=c,this.nonce=u,this.tracingService=l,this.defaultRenderer=new mo(t,o,c,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof Bc?i.applyToHost(t):i instanceof yo&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.tracingService;switch(r.encapsulation){case Nt.Emulated:s=new Bc(u,l,r,this.appId,h,o,c,p);break;case Nt.ShadowDom:return new Vc(u,t,r,o,c,this.nonce,p,l);case Nt.ExperimentalIsolatedShadowDom:return new Vc(u,t,r,o,c,this.nonce,p);default:s=new yo(u,l,r,h,o,c,p);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(de(Ah),de(Nh),de(Ec),de(iR),de(St),de(ze),de(wc),de(io,8))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),mo=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(bh[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(kI(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(kI(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ee(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=bh[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=bh[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Wt.DashCase|Wt.Important)?e.style.setProperty(t,r,i&Wt.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Wt.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=ho().getGlobalEventTarget(this.doc,e),!e))throw new ee(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function kI(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Vc=class extends mo{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,s,o,c,u){super(e,i,s,c),this.hostEl=t,this.sharedStylesHost=u,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let l=r.styles;l=LI(r.id,l);for(let p of l){let m=document.createElement("style");o&&m.setAttribute("nonce",o),m.textContent=p,this.shadowRoot.appendChild(m)}let h=r.getExternalStyles?.();if(h)for(let p of h){let m=Sh(p,i);o&&m.setAttribute("nonce",o),this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},yo=class extends mo{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,c,u){super(e,s,o,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let l=r.styles;this.styles=u?LI(u,l):l,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&vi.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Bc=class extends yo{contentAttr;hostAttr;constructor(e,t,r,i,s,o,c,u){let l=i+"-"+r.id;super(e,t,r,s,o,c,u,l),this.contentAttr=sR(l),this.hostAttr=oR(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var Uc=class n extends fo{supportsDOMEvents=!0;static makeCurrent(){wh(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=aR();return t==null?null:cR(t)}resetBaseElement(){_o=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Dh(document.cookie,e)}},_o=null;function aR(){return _o=_o||document.head.querySelector("base"),_o?_o.getAttribute("href"):null}function cR(n){return new URL(n,document.baseURI).pathname}var uR=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})(),FI=["alt","control","meta","shift"],lR={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},dR={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},VI=(()=>{class n extends go{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),c=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ho().onAndCancel(t,o.domEventName,c,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),FI.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let i=lR[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),FI.forEach(o=>{if(o!==i){let c=dR[o];c(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(de(St))};static \u0275prov=pe({token:n,factory:n.\u0275fac})}return n})();function xh(n,e,t){let r=j({rootComponent:n,platformRef:t?.platformRef},fR(e));return SI(r)}function fR(n){return{appProviders:[...yR,...n?.providers??[]],platformProviders:mR}}function hR(){Uc.makeCurrent()}function pR(){return new an}function gR(){return Uf(document),document}var mR=[{provide:ro,useValue:MI},{provide:Ic,useValue:hR,multi:!0},{provide:St,useFactory:gR}];var yR=[{provide:Fs,useValue:"root"},{provide:an,useFactory:pR},{provide:jc,useClass:Fc,multi:!0},{provide:jc,useClass:VI,multi:!0},Mh,Nh,Ah,{provide:Ar,useExisting:Mh},{provide:po,useClass:uR},[]];var BI=()=>{};var HI=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},_R=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},$I={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,h=s>>2,p=(s&3)<<4|c>>4,m=(c&15)<<2|l>>6,I=l&63;u||(I=64,o||(m=64)),r.push(t[h],t[p],t[m],t[I])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(HI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_R(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||l==null||p==null)throw new kh;let m=s<<2|c>>4;if(r.push(m),l!==64){let I=c<<4&240|l>>2;if(r.push(I),p!==64){let S=l<<6&192|p;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},kh=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},vR=function(n){let e=HI(n);return $I.encodeByteArray(e,!0)},Eo=function(n){return vR(n).replace(/\./g,"")},$c=function(n){try{return $I.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function qI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var ER=()=>qI().__FIREBASE_DEFAULTS__,IR=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&$c(n[1]);return e&&JSON.parse(e)},qc=()=>{try{return BI()||ER()||IR()||wR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Lh=n=>qc()?.emulatorHosts?.[n],zI=n=>{let e=Lh(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Fh=()=>qc()?.config,Vh=n=>qc()?.[`_${n}`];var Hc=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Hn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zc(n){return(await fetch(n,{credentials:"include"})).ok}function GI(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=j({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Eo(JSON.stringify(t)),Eo(JSON.stringify(o)),""].join(".")}var vo={};function TR(){let n={prod:[],emulator:[]};for(let e of Object.keys(vo))vo[e]?n.emulator.push(e):n.prod.push(e);return n}function DR(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var jI=!1;function Gc(n,e){if(typeof window>"u"||typeof document>"u"||!Hn(window.location.host)||vo[n]===e||vo[n]||jI)return;vo[n]=e;function t(m){return`__firebase__banner__${m}`}let r="__firebase__banner",s=TR().prod.length>0;function o(){let m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,I){m.setAttribute("width","24"),m.setAttribute("id",I),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){let m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{jI=!0,o()},m}function h(m,I){m.setAttribute("id",I),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){let m=DR(r),I=t("text"),S=document.getElementById(I)||document.createElement("span"),M=t("learnmore"),R=document.getElementById(M)||document.createElement("a"),F=t("preprendIcon"),Z=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){let re=m.element;c(re),h(R,M);let K=l();u(Z,F),re.append(Z,S,R,K),document.body.appendChild(re)}s?(S.innerText="Preview backend disconnected.",Z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function Be(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function WI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Be())}function CR(){let n=qc()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function KI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function QI(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function YI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ZI(){let n=Be();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function JI(){return!CR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Bh(){try{return typeof indexedDB=="object"}catch{return!1}}function XI(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var bR="FirebaseError",dt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=bR,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,un.prototype.create)}},un=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?SR(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new dt(i,c,r)}};function SR(n,e){return n.replace(AR,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var AR=/\{\$([^}]+)}/g;function ew(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Kt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(UI(s)&&UI(o)){if(!Kt(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function UI(n){return n!==null&&typeof n=="object"}function Ni(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ri(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Mi(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function tw(n,e){let t=new Oh(n,e);return t.subscribe.bind(t)}var Oh=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");NR(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ph),i.error===void 0&&(i.error=Ph),i.complete===void 0&&(i.complete=Ph);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function NR(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ph(){}var c6=14400*1e3;function Qe(n){return n&&n._delegate?n._delegate:n}var Et=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Pr="[DEFAULT]";var jh=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Hc;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(MR(e))try{this.getOrInitializeService({instanceIdentifier:Pr})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Pr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pr){return this.instances.has(e)}getOptions(e=Pr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:RR(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Pr){return this.component?this.component.multipleInstances?e:Pr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function RR(n){return n===Pr?void 0:n}function MR(n){return n.instantiationMode==="EAGER"}var Wc=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new jh(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var xR=[],ne=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(ne||{}),PR={debug:ne.DEBUG,verbose:ne.VERBOSE,info:ne.INFO,warn:ne.WARN,error:ne.ERROR,silent:ne.SILENT},kR=ne.INFO,OR={[ne.DEBUG]:"log",[ne.VERBOSE]:"log",[ne.INFO]:"info",[ne.WARN]:"warn",[ne.ERROR]:"error"},LR=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=OR[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},$n=class{constructor(e){this.name=e,this._logLevel=kR,this._logHandler=LR,this._userLogHandler=null,xR.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ne.DEBUG,...e),this._logHandler(this,ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ne.VERBOSE,...e),this._logHandler(this,ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ne.INFO,...e),this._logHandler(this,ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ne.WARN,...e),this._logHandler(this,ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ne.ERROR,...e),this._logHandler(this,ne.ERROR,...e)}};var FR=(n,e)=>e.some(t=>n instanceof t),nw,rw;function VR(){return nw||(nw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BR(){return rw||(rw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var iw=new WeakMap,Hh=new WeakMap,sw=new WeakMap,Uh=new WeakMap,qh=new WeakMap;function jR(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Qt(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&iw.set(t,n)}).catch(()=>{}),qh.set(e,n),e}function UR(n){if(Hh.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Hh.set(n,e)}var $h={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Hh.get(n);if(e==="objectStoreNames")return n.objectStoreNames||sw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ow(n){$h=n($h)}function HR(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Kc(this),e,...t);return sw.set(r,e.sort?e.sort():[e]),Qt(r)}:BR().includes(n)?function(...e){return n.apply(Kc(this),e),Qt(iw.get(this))}:function(...e){return Qt(n.apply(Kc(this),e))}}function $R(n){return typeof n=="function"?HR(n):(n instanceof IDBTransaction&&UR(n),FR(n,VR())?new Proxy(n,$h):n)}function Qt(n){if(n instanceof IDBRequest)return jR(n);if(Uh.has(n))return Uh.get(n);let e=$R(n);return e!==n&&(Uh.set(n,e),qh.set(e,n)),e}var Kc=n=>qh.get(n);function cw(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),c=Qt(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Qt(o.result),u.oldVersion,u.newVersion,Qt(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}var qR=["get","getKey","getAll","getAllKeys","count"],zR=["put","add","delete","clear"],zh=new Map;function aw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(zh.get(e))return zh.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=zR.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||qR.includes(t)))return;let s=async function(o,...c){let u=this.transaction(o,i?"readwrite":"readonly"),l=u.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[t](...c),i&&u.done]))[0]};return zh.set(e,s),s}ow(n=>_e(j({},n),{get:(e,t,r)=>aw(e,t)||n.get(e,t,r),has:(e,t)=>!!aw(e,t)||n.has(e,t)}));var Wh=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(GR(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function GR(n){return n.getComponent()?.type==="VERSION"}var Kh="@firebase/app",uw="0.14.6";var ln=new $n("@firebase/app"),WR="@firebase/app-compat",KR="@firebase/analytics-compat",QR="@firebase/analytics",YR="@firebase/app-check-compat",ZR="@firebase/app-check",JR="@firebase/auth",XR="@firebase/auth-compat",eM="@firebase/database",tM="@firebase/data-connect",nM="@firebase/database-compat",rM="@firebase/functions",iM="@firebase/functions-compat",sM="@firebase/installations",oM="@firebase/installations-compat",aM="@firebase/messaging",cM="@firebase/messaging-compat",uM="@firebase/performance",lM="@firebase/performance-compat",dM="@firebase/remote-config",fM="@firebase/remote-config-compat",hM="@firebase/storage",pM="@firebase/storage-compat",gM="@firebase/firestore",mM="@firebase/ai",yM="@firebase/firestore-compat",_M="firebase",vM="12.6.0";var Qh="[DEFAULT]",EM={[Kh]:"fire-core",[WR]:"fire-core-compat",[QR]:"fire-analytics",[KR]:"fire-analytics-compat",[ZR]:"fire-app-check",[YR]:"fire-app-check-compat",[JR]:"fire-auth",[XR]:"fire-auth-compat",[eM]:"fire-rtdb",[tM]:"fire-data-connect",[nM]:"fire-rtdb-compat",[rM]:"fire-fn",[iM]:"fire-fn-compat",[sM]:"fire-iid",[oM]:"fire-iid-compat",[aM]:"fire-fcm",[cM]:"fire-fcm-compat",[uM]:"fire-perf",[lM]:"fire-perf-compat",[dM]:"fire-rc",[fM]:"fire-rc-compat",[hM]:"fire-gcs",[pM]:"fire-gcs-compat",[gM]:"fire-fst",[yM]:"fire-fst-compat",[mM]:"fire-vertex","fire-js":"fire-js",[_M]:"fire-js-all"};var Qc=new Map,IM=new Map,Yh=new Map;function lw(n,e){try{n.container.addComponent(e)}catch(t){ln.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function zn(n){let e=n.name;if(Yh.has(e))return ln.debug(`There were multiple attempts to register component ${e}.`),!1;Yh.set(e,n);for(let t of Qc.values())lw(t,n);for(let t of IM.values())lw(t,n);return!0}function wo(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function rt(n){return n==null?!1:n.settings!==void 0}var wM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qn=new un("app","Firebase",wM);var Zh=class{constructor(e,t,r){this._isDeleted=!1,this._options=j({},e),this._config=j({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Et("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qn.create("app-deleted",{appName:this._name})}};var Gn=vM;function ep(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=j({name:Qh,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw qn.create("bad-app-name",{appName:String(i)});if(t||(t=Fh()),!t)throw qn.create("no-options");let s=Qc.get(i);if(s){if(Kt(t,s.options)&&Kt(r,s.config))return s;throw qn.create("duplicate-app",{appName:i})}let o=new Wc(i);for(let u of Yh.values())o.addComponent(u);let c=new Zh(t,r,o);return Qc.set(i,c),c}function Yc(n=Qh){let e=Qc.get(n);if(!e&&n===Qh&&Fh())return ep();if(!e)throw qn.create("no-app",{appName:n});return e}function Mt(n,e,t){let r=EM[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ln.warn(o.join(" "));return}zn(new Et(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var TM="firebase-heartbeat-database",DM=1,Io="firebase-heartbeat-store",Gh=null;function pw(){return Gh||(Gh=cw(TM,DM,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Io)}catch(t){console.warn(t)}}}}).catch(n=>{throw qn.create("idb-open",{originalErrorMessage:n.message})})),Gh}async function CM(n){try{let t=(await pw()).transaction(Io),r=await t.objectStore(Io).get(gw(n));return await t.done,r}catch(e){if(e instanceof dt)ln.warn(e.message);else{let t=qn.create("idb-get",{originalErrorMessage:e?.message});ln.warn(t.message)}}}async function dw(n,e){try{let r=(await pw()).transaction(Io,"readwrite");await r.objectStore(Io).put(e,gw(n)),await r.done}catch(t){if(t instanceof dt)ln.warn(t.message);else{let r=qn.create("idb-set",{originalErrorMessage:t?.message});ln.warn(r.message)}}}function gw(n){return`${n.name}!${n.options.appId}`}var bM=1024,SM=30,Jh=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Xh(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=fw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>SM){let i=NM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ln.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=fw(),{heartbeatsToSend:t,unsentEntries:r}=AM(this._heartbeatsCache.heartbeats),i=Eo(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ln.warn(e),""}}};function fw(){return new Date().toISOString().substring(0,10)}function AM(n,e=bM){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),hw(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),hw(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Xh=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Bh()?XI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await CM(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return dw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return dw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function hw(n){return Eo(JSON.stringify({version:2,heartbeats:n})).length}function NM(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function RM(n){zn(new Et("platform-logger",e=>new Wh(e),"PRIVATE")),zn(new Et("heartbeat",e=>new Jh(e),"PRIVATE")),Mt(Kh,uw,n),Mt(Kh,uw,"esm2020"),Mt("fire-js","")}RM("");var MM="firebase",xM="12.7.0";Mt(MM,xM,"app");var mw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yw={};var dn,tp;(function(){var n;function e(E,y){function _(){}_.prototype=y.prototype,E.F=y.prototype,E.prototype=new _,E.prototype.constructor=E,E.D=function(T,w,C){for(var v=Array(arguments.length-2),it=2;it<arguments.length;it++)v[it-2]=arguments[it];return y.prototype[w].apply(T,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,y,_){_||(_=0);let T=Array(16);if(typeof y=="string")for(var w=0;w<16;++w)T[w]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(w=0;w<16;++w)T[w]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=E.g[0],_=E.g[1],w=E.g[2];let C=E.g[3],v;v=y+(C^_&(w^C))+T[0]+3614090360&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(w^y&(_^w))+T[1]+3905402710&4294967295,C=y+(v<<12&4294967295|v>>>20),v=w+(_^C&(y^_))+T[2]+606105819&4294967295,w=C+(v<<17&4294967295|v>>>15),v=_+(y^w&(C^y))+T[3]+3250441966&4294967295,_=w+(v<<22&4294967295|v>>>10),v=y+(C^_&(w^C))+T[4]+4118548399&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(w^y&(_^w))+T[5]+1200080426&4294967295,C=y+(v<<12&4294967295|v>>>20),v=w+(_^C&(y^_))+T[6]+2821735955&4294967295,w=C+(v<<17&4294967295|v>>>15),v=_+(y^w&(C^y))+T[7]+4249261313&4294967295,_=w+(v<<22&4294967295|v>>>10),v=y+(C^_&(w^C))+T[8]+1770035416&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(w^y&(_^w))+T[9]+2336552879&4294967295,C=y+(v<<12&4294967295|v>>>20),v=w+(_^C&(y^_))+T[10]+4294925233&4294967295,w=C+(v<<17&4294967295|v>>>15),v=_+(y^w&(C^y))+T[11]+2304563134&4294967295,_=w+(v<<22&4294967295|v>>>10),v=y+(C^_&(w^C))+T[12]+1804603682&4294967295,y=_+(v<<7&4294967295|v>>>25),v=C+(w^y&(_^w))+T[13]+4254626195&4294967295,C=y+(v<<12&4294967295|v>>>20),v=w+(_^C&(y^_))+T[14]+2792965006&4294967295,w=C+(v<<17&4294967295|v>>>15),v=_+(y^w&(C^y))+T[15]+1236535329&4294967295,_=w+(v<<22&4294967295|v>>>10),v=y+(w^C&(_^w))+T[1]+4129170786&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^w&(y^_))+T[6]+3225465664&4294967295,C=y+(v<<9&4294967295|v>>>23),v=w+(y^_&(C^y))+T[11]+643717713&4294967295,w=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(w^C))+T[0]+3921069994&4294967295,_=w+(v<<20&4294967295|v>>>12),v=y+(w^C&(_^w))+T[5]+3593408605&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^w&(y^_))+T[10]+38016083&4294967295,C=y+(v<<9&4294967295|v>>>23),v=w+(y^_&(C^y))+T[15]+3634488961&4294967295,w=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(w^C))+T[4]+3889429448&4294967295,_=w+(v<<20&4294967295|v>>>12),v=y+(w^C&(_^w))+T[9]+568446438&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^w&(y^_))+T[14]+3275163606&4294967295,C=y+(v<<9&4294967295|v>>>23),v=w+(y^_&(C^y))+T[3]+4107603335&4294967295,w=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(w^C))+T[8]+1163531501&4294967295,_=w+(v<<20&4294967295|v>>>12),v=y+(w^C&(_^w))+T[13]+2850285829&4294967295,y=_+(v<<5&4294967295|v>>>27),v=C+(_^w&(y^_))+T[2]+4243563512&4294967295,C=y+(v<<9&4294967295|v>>>23),v=w+(y^_&(C^y))+T[7]+1735328473&4294967295,w=C+(v<<14&4294967295|v>>>18),v=_+(C^y&(w^C))+T[12]+2368359562&4294967295,_=w+(v<<20&4294967295|v>>>12),v=y+(_^w^C)+T[5]+4294588738&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^w)+T[8]+2272392833&4294967295,C=y+(v<<11&4294967295|v>>>21),v=w+(C^y^_)+T[11]+1839030562&4294967295,w=C+(v<<16&4294967295|v>>>16),v=_+(w^C^y)+T[14]+4259657740&4294967295,_=w+(v<<23&4294967295|v>>>9),v=y+(_^w^C)+T[1]+2763975236&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^w)+T[4]+1272893353&4294967295,C=y+(v<<11&4294967295|v>>>21),v=w+(C^y^_)+T[7]+4139469664&4294967295,w=C+(v<<16&4294967295|v>>>16),v=_+(w^C^y)+T[10]+3200236656&4294967295,_=w+(v<<23&4294967295|v>>>9),v=y+(_^w^C)+T[13]+681279174&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^w)+T[0]+3936430074&4294967295,C=y+(v<<11&4294967295|v>>>21),v=w+(C^y^_)+T[3]+3572445317&4294967295,w=C+(v<<16&4294967295|v>>>16),v=_+(w^C^y)+T[6]+76029189&4294967295,_=w+(v<<23&4294967295|v>>>9),v=y+(_^w^C)+T[9]+3654602809&4294967295,y=_+(v<<4&4294967295|v>>>28),v=C+(y^_^w)+T[12]+3873151461&4294967295,C=y+(v<<11&4294967295|v>>>21),v=w+(C^y^_)+T[15]+530742520&4294967295,w=C+(v<<16&4294967295|v>>>16),v=_+(w^C^y)+T[2]+3299628645&4294967295,_=w+(v<<23&4294967295|v>>>9),v=y+(w^(_|~C))+T[0]+4096336452&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~w))+T[7]+1126891415&4294967295,C=y+(v<<10&4294967295|v>>>22),v=w+(y^(C|~_))+T[14]+2878612391&4294967295,w=C+(v<<15&4294967295|v>>>17),v=_+(C^(w|~y))+T[5]+4237533241&4294967295,_=w+(v<<21&4294967295|v>>>11),v=y+(w^(_|~C))+T[12]+1700485571&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~w))+T[3]+2399980690&4294967295,C=y+(v<<10&4294967295|v>>>22),v=w+(y^(C|~_))+T[10]+4293915773&4294967295,w=C+(v<<15&4294967295|v>>>17),v=_+(C^(w|~y))+T[1]+2240044497&4294967295,_=w+(v<<21&4294967295|v>>>11),v=y+(w^(_|~C))+T[8]+1873313359&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~w))+T[15]+4264355552&4294967295,C=y+(v<<10&4294967295|v>>>22),v=w+(y^(C|~_))+T[6]+2734768916&4294967295,w=C+(v<<15&4294967295|v>>>17),v=_+(C^(w|~y))+T[13]+1309151649&4294967295,_=w+(v<<21&4294967295|v>>>11),v=y+(w^(_|~C))+T[4]+4149444226&4294967295,y=_+(v<<6&4294967295|v>>>26),v=C+(_^(y|~w))+T[11]+3174756917&4294967295,C=y+(v<<10&4294967295|v>>>22),v=w+(y^(C|~_))+T[2]+718787259&4294967295,w=C+(v<<15&4294967295|v>>>17),v=_+(C^(w|~y))+T[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(w+(v<<21&4294967295|v>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+C&4294967295}r.prototype.v=function(E,y){y===void 0&&(y=E.length);let _=y-this.blockSize,T=this.C,w=this.h,C=0;for(;C<y;){if(w==0)for(;C<=_;)i(this,E,C),C+=this.blockSize;if(typeof E=="string"){for(;C<y;)if(T[w++]=E.charCodeAt(C++),w==this.blockSize){i(this,T),w=0;break}}else for(;C<y;)if(T[w++]=E[C++],w==this.blockSize){i(this,T),w=0;break}}this.h=w,this.o+=y},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;y=this.o*8;for(var _=E.length-8;_<E.length;++_)E[_]=y&255,y/=256;for(this.v(E),E=Array(16),y=0,_=0;_<4;++_)for(let T=0;T<32;T+=8)E[y++]=this.g[_]>>>T&255;return E};function s(E,y){var _=c;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=y(E)}function o(E,y){this.h=y;let _=[],T=!0;for(let w=E.length-1;w>=0;w--){let C=E[w]|0;T&&C==y||(_[w]=C,T=!1)}this.g=_}var c={};function u(E){return-128<=E&&E<128?s(E,function(y){return new o([y|0],y<0?-1:0)}):new o([E|0],E<0?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return p;if(E<0)return R(l(-E));let y=[],_=1;for(let T=0;E>=_;T++)y[T]=E/_|0,_*=4294967296;return new o(y,0)}function h(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return R(h(E.substring(1),y));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');let _=l(Math.pow(y,8)),T=p;for(let C=0;C<E.length;C+=8){var w=Math.min(8,E.length-C);let v=parseInt(E.substring(C,C+w),y);w<8?(w=l(Math.pow(y,w)),T=T.j(w).add(l(v))):(T=T.j(_),T=T.add(l(v)))}return T}var p=u(0),m=u(1),I=u(16777216);n=o.prototype,n.m=function(){if(M(this))return-R(this).m();let E=0,y=1;for(let _=0;_<this.g.length;_++){let T=this.i(_);E+=(T>=0?T:4294967296+T)*y,y*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(S(this))return"0";if(M(this))return"-"+R(this).toString(E);let y=l(Math.pow(E,6));var _=this;let T="";for(;;){let w=K(_,y).g;_=F(_,w.j(y));let C=((_.g.length>0?_.g[0]:_.h)>>>0).toString(E);if(_=w,S(_))return C+T;for(;C.length<6;)C="0"+C;T=C+T}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function S(E){if(E.h!=0)return!1;for(let y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function M(E){return E.h==-1}n.l=function(E){return E=F(this,E),M(E)?-1:S(E)?0:1};function R(E){let y=E.g.length,_=[];for(let T=0;T<y;T++)_[T]=~E.g[T];return new o(_,~E.h).add(m)}n.abs=function(){return M(this)?R(this):this},n.add=function(E){let y=Math.max(this.g.length,E.g.length),_=[],T=0;for(let w=0;w<=y;w++){let C=T+(this.i(w)&65535)+(E.i(w)&65535),v=(C>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);T=v>>>16,C&=65535,v&=65535,_[w]=v<<16|C}return new o(_,_[_.length-1]&-2147483648?-1:0)};function F(E,y){return E.add(R(y))}n.j=function(E){if(S(this)||S(E))return p;if(M(this))return M(E)?R(this).j(R(E)):R(R(this).j(E));if(M(E))return R(this.j(R(E)));if(this.l(I)<0&&E.l(I)<0)return l(this.m()*E.m());let y=this.g.length+E.g.length,_=[];for(var T=0;T<2*y;T++)_[T]=0;for(T=0;T<this.g.length;T++)for(let w=0;w<E.g.length;w++){let C=this.i(T)>>>16,v=this.i(T)&65535,it=E.i(w)>>>16,Tn=E.i(w)&65535;_[2*T+2*w]+=v*Tn,Z(_,2*T+2*w),_[2*T+2*w+1]+=C*Tn,Z(_,2*T+2*w+1),_[2*T+2*w+1]+=v*it,Z(_,2*T+2*w+1),_[2*T+2*w+2]+=C*it,Z(_,2*T+2*w+2)}for(E=0;E<y;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=y;E<2*y;E++)_[E]=0;return new o(_,0)};function Z(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function re(E,y){this.g=E,this.h=y}function K(E,y){if(S(y))throw Error("division by zero");if(S(E))return new re(p,p);if(M(E))return y=K(R(E),y),new re(R(y.g),R(y.h));if(M(y))return y=K(E,R(y)),new re(R(y.g),y.h);if(E.g.length>30){if(M(E)||M(y))throw Error("slowDivide_ only works with positive integers.");for(var _=m,T=y;T.l(E)<=0;)_=ae(_),T=ae(T);var w=k(_,1),C=k(T,1);for(T=k(T,2),_=k(_,2);!S(T);){var v=C.add(T);v.l(E)<=0&&(w=w.add(_),C=v),T=k(T,1),_=k(_,1)}return y=F(E,w.j(y)),new re(w,y)}for(w=p;E.l(y)>=0;){for(_=Math.max(1,Math.floor(E.m()/y.m())),T=Math.ceil(Math.log(_)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),C=l(_),v=C.j(y);M(v)||v.l(E)>0;)_-=T,C=l(_),v=C.j(y);S(C)&&(C=m),w=w.add(C),E=F(E,v)}return new re(w,E)}n.B=function(E){return K(this,E).h},n.and=function(E){let y=Math.max(this.g.length,E.g.length),_=[];for(let T=0;T<y;T++)_[T]=this.i(T)&E.i(T);return new o(_,this.h&E.h)},n.or=function(E){let y=Math.max(this.g.length,E.g.length),_=[];for(let T=0;T<y;T++)_[T]=this.i(T)|E.i(T);return new o(_,this.h|E.h)},n.xor=function(E){let y=Math.max(this.g.length,E.g.length),_=[];for(let T=0;T<y;T++)_[T]=this.i(T)^E.i(T);return new o(_,this.h^E.h)};function ae(E){let y=E.g.length+1,_=[];for(let T=0;T<y;T++)_[T]=E.i(T)<<1|E.i(T-1)>>>31;return new o(_,E.h)}function k(E,y){let _=y>>5;y%=32;let T=E.g.length-_,w=[];for(let C=0;C<T;C++)w[C]=y>0?E.i(C+_)>>>y|E.i(C+_+1)<<32-y:E.i(C+_);return new o(w,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,tp=yw.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=h,dn=yw.Integer=o}).apply(typeof mw<"u"?mw:typeof self<"u"?self:typeof window<"u"?window:{});var Zc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fn={};var np,PM,xi,rp,To,Jc,ip,sp,op;(function(){var n,e=Object.defineProperty;function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zc=="object"&&Zc];for(var d=0;d<a.length;++d){var f=a[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(a,d){if(d)e:{var f=r;a=a.split(".");for(var g=0;g<a.length-1;g++){var D=a[g];if(!(D in f))break e;f=f[D]}a=a[a.length-1],g=f[a],d=d(g),d!=g&&d!=null&&e(f,a,{configurable:!0,writable:!0,value:d})}}i("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(a){return a||function(d){var f=[],g;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&f.push([g,d[g]]);return f}});var s=s||{},o=this||self;function c(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function u(a,d,f){return a.call.apply(a.bind,arguments)}function l(a,d,f){return l=u,l.apply(null,arguments)}function h(a,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),a.apply(this,g)}}function p(a,d){function f(){}f.prototype=d.prototype,a.Z=d.prototype,a.prototype=new f,a.prototype.constructor=a,a.Ob=function(g,D,b){for(var x=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)x[Q-2]=arguments[Q];return d.prototype[D].apply(g,x)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function I(a){let d=a.length;if(d>0){let f=Array(d);for(let g=0;g<d;g++)f[g]=a[g];return f}return[]}function S(a,d){for(let g=1;g<arguments.length;g++){let D=arguments[g];var f=typeof D;if(f=f!="object"?f:D?Array.isArray(D)?"array":f:"null",f=="array"||f=="object"&&typeof D.length=="number"){f=a.length||0;let b=D.length||0;a.length=f+b;for(let x=0;x<b;x++)a[f+x]=D[x]}else a.push(D)}}class M{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return this.h>0?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function R(a){o.setTimeout(()=>{throw a},0)}function F(){var a=E;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class Z{constructor(){this.h=this.g=null}add(d,f){let g=re.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var re=new M(()=>new K,a=>a.reset());class K{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,k=!1,E=new Z,y=()=>{let a=Promise.resolve(void 0);ae=()=>{a.then(_)}};function _(){for(var a;a=F();){try{a.h.call(a.g)}catch(f){R(f)}var d=re;d.j(a),d.h<100&&(d.h++,a.next=d.g,d.g=a)}k=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var C=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let f=()=>{};o.addEventListener("test",f,d),o.removeEventListener("test",f,d)}catch{}return a})();function v(a){return/^[\s\xa0]*$/.test(a)}function it(a,d){w.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,d)}p(it,w),it.prototype.init=function(a,d){let f=this.type=a.type,g=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget,d||(f=="mouseover"?d=a.fromElement:f=="mouseout"&&(d=a.toElement)),this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&it.Z.h.call(this)},it.prototype.h=function(){it.Z.h.call(this);let a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Tn="closure_listenable_"+(Math.random()*1e6|0),kC=0;function OC(a,d,f,g,D){this.listener=a,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=D,this.key=++kC,this.da=this.fa=!1}function Xo(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ea(a,d,f){for(let g in a)d.call(f,a[g],g,a)}function LC(a,d){for(let f in a)d.call(void 0,a[f],f,a)}function Zm(a){let d={};for(let f in a)d[f]=a[f];return d}let Jm="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Xm(a,d){let f,g;for(let D=1;D<arguments.length;D++){g=arguments[D];for(f in g)a[f]=g[f];for(let b=0;b<Jm.length;b++)f=Jm[b],Object.prototype.hasOwnProperty.call(g,f)&&(a[f]=g[f])}}function ta(a){this.src=a,this.g={},this.h=0}ta.prototype.add=function(a,d,f,g,D){let b=a.toString();a=this.g[b],a||(a=this.g[b]=[],this.h++);let x=vl(a,d,g,D);return x>-1?(d=a[x],f||(d.fa=!1)):(d=new OC(d,this.src,b,!!g,D),d.fa=f,a.push(d)),d};function _l(a,d){let f=d.type;if(f in a.g){var g=a.g[f],D=Array.prototype.indexOf.call(g,d,void 0),b;(b=D>=0)&&Array.prototype.splice.call(g,D,1),b&&(Xo(d),a.g[f].length==0&&(delete a.g[f],a.h--))}}function vl(a,d,f,g){for(let D=0;D<a.length;++D){let b=a[D];if(!b.da&&b.listener==d&&b.capture==!!f&&b.ha==g)return D}return-1}var El="closure_lm_"+(Math.random()*1e6|0),Il={};function ey(a,d,f,g,D){if(g&&g.once)return ny(a,d,f,g,D);if(Array.isArray(d)){for(let b=0;b<d.length;b++)ey(a,d[b],f,g,D);return null}return f=Cl(f),a&&a[Tn]?a.J(d,f,c(g)?!!g.capture:!!g,D):ty(a,d,f,!1,g,D)}function ty(a,d,f,g,D,b){if(!d)throw Error("Invalid event type");let x=c(D)?!!D.capture:!!D,Q=Tl(a);if(Q||(a[El]=Q=new ta(a)),f=Q.add(d,f,g,x,b),f.proxy)return f;if(g=FC(),f.proxy=g,g.src=a,g.listener=f,a.addEventListener)C||(D=x),D===void 0&&(D=!1),a.addEventListener(d.toString(),g,D);else if(a.attachEvent)a.attachEvent(iy(d.toString()),g);else if(a.addListener&&a.removeListener)a.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function FC(){function a(f){return d.call(a.src,a.listener,f)}let d=VC;return a}function ny(a,d,f,g,D){if(Array.isArray(d)){for(let b=0;b<d.length;b++)ny(a,d[b],f,g,D);return null}return f=Cl(f),a&&a[Tn]?a.K(d,f,c(g)?!!g.capture:!!g,D):ty(a,d,f,!0,g,D)}function ry(a,d,f,g,D){if(Array.isArray(d))for(var b=0;b<d.length;b++)ry(a,d[b],f,g,D);else g=c(g)?!!g.capture:!!g,f=Cl(f),a&&a[Tn]?(a=a.i,b=String(d).toString(),b in a.g&&(d=a.g[b],f=vl(d,f,g,D),f>-1&&(Xo(d[f]),Array.prototype.splice.call(d,f,1),d.length==0&&(delete a.g[b],a.h--)))):a&&(a=Tl(a))&&(d=a.g[d.toString()],a=-1,d&&(a=vl(d,f,g,D)),(f=a>-1?d[a]:null)&&wl(f))}function wl(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[Tn])_l(d.i,a);else{var f=a.type,g=a.proxy;d.removeEventListener?d.removeEventListener(f,g,a.capture):d.detachEvent?d.detachEvent(iy(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=Tl(d))?(_l(f,a),f.h==0&&(f.src=null,d[El]=null)):Xo(a)}}}function iy(a){return a in Il?Il[a]:Il[a]="on"+a}function VC(a,d){if(a.da)a=!0;else{d=new it(d,this);let f=a.listener,g=a.ha||a.src;a.fa&&wl(a),a=f.call(g,d)}return a}function Tl(a){return a=a[El],a instanceof ta?a:null}var Dl="__closure_events_fn_"+(Math.random()*1e9>>>0);function Cl(a){return typeof a=="function"?a:(a[Dl]||(a[Dl]=function(d){return a.handleEvent(d)}),a[Dl])}function He(){T.call(this),this.i=new ta(this),this.M=this,this.G=null}p(He,T),He.prototype[Tn]=!0,He.prototype.removeEventListener=function(a,d,f,g){ry(this,a,d,f,g)};function Xe(a,d){var f,g=a.G;if(g)for(f=[];g;g=g.G)f.push(g);if(a=a.M,g=d.type||d,typeof d=="string")d=new w(d,a);else if(d instanceof w)d.target=d.target||a;else{var D=d;d=new w(g,a),Xm(d,D)}D=!0;let b,x;if(f)for(x=f.length-1;x>=0;x--)b=d.g=f[x],D=na(b,g,!0,d)&&D;if(b=d.g=a,D=na(b,g,!0,d)&&D,D=na(b,g,!1,d)&&D,f)for(x=0;x<f.length;x++)b=d.g=f[x],D=na(b,g,!1,d)&&D}He.prototype.N=function(){if(He.Z.N.call(this),this.i){var a=this.i;for(let d in a.g){let f=a.g[d];for(let g=0;g<f.length;g++)Xo(f[g]);delete a.g[d],a.h--}}this.G=null},He.prototype.J=function(a,d,f,g){return this.i.add(String(a),d,!1,f,g)},He.prototype.K=function(a,d,f,g){return this.i.add(String(a),d,!0,f,g)};function na(a,d,f,g){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();let D=!0;for(let b=0;b<d.length;++b){let x=d[b];if(x&&!x.da&&x.capture==f){let Q=x.listener,ke=x.ha||x.src;x.fa&&_l(a.i,x),D=Q.call(ke,g)!==!1&&D}}return D&&!g.defaultPrevented}function BC(a,d){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=l(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(d)>2147483647?-1:o.setTimeout(a,d||0)}function sy(a){a.g=BC(()=>{a.g=null,a.i&&(a.i=!1,sy(a))},a.l);let d=a.h;a.h=null,a.m.apply(null,d)}class jC extends T{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:sy(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ls(a){T.call(this),this.h=a,this.g={}}p(ls,T);var oy=[];function ay(a){ea(a.g,function(d,f){this.g.hasOwnProperty(f)&&wl(d)},a),a.g={}}ls.prototype.N=function(){ls.Z.N.call(this),ay(this)},ls.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bl=o.JSON.stringify,UC=o.JSON.parse,HC=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function cy(){}function uy(){}var ds={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Sl(){w.call(this,"d")}p(Sl,w);function Al(){w.call(this,"c")}p(Al,w);var sr={},ly=null;function ra(){return ly=ly||new He}sr.Ia="serverreachability";function dy(a){w.call(this,sr.Ia,a)}p(dy,w);function fs(a){let d=ra();Xe(d,new dy(d))}sr.STAT_EVENT="statevent";function fy(a,d){w.call(this,sr.STAT_EVENT,a),this.stat=d}p(fy,w);function et(a){let d=ra();Xe(d,new fy(d,a))}sr.Ja="timingevent";function hy(a,d){w.call(this,sr.Ja,a),this.size=d}p(hy,w);function hs(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},d)}function ps(){this.g=!0}ps.prototype.ua=function(){this.g=!1};function $C(a,d,f,g,D,b){a.info(function(){if(a.g)if(b){var x="",Q=b.split("&");for(let ye=0;ye<Q.length;ye++){var ke=Q[ye].split("=");if(ke.length>1){let Le=ke[0];ke=ke[1];let Lt=Le.split("_");x=Lt.length>=2&&Lt[1]=="type"?x+(Le+"="+ke+"&"):x+(Le+"=redacted&")}}}else x=null;else x=b;return"XMLHTTP REQ ("+g+") [attempt "+D+"]: "+d+`
`+f+`
`+x})}function qC(a,d,f,g,D,b,x){a.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+D+"]: "+d+`
`+f+`
`+b+" "+x})}function Yr(a,d,f,g){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+GC(a,f)+(g?" "+g:"")})}function zC(a,d){a.info(function(){return"TIMEOUT: "+d})}ps.prototype.info=function(){};function GC(a,d){if(!a.g)return d;if(!d)return null;try{let b=JSON.parse(d);if(b){for(a=0;a<b.length;a++)if(Array.isArray(b[a])){var f=b[a];if(!(f.length<2)){var g=f[1];if(Array.isArray(g)&&!(g.length<1)){var D=g[0];if(D!="noop"&&D!="stop"&&D!="close")for(let x=1;x<g.length;x++)g[x]=""}}}}return bl(b)}catch{return d}}var ia={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},py={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},gy;function Nl(){}p(Nl,cy),Nl.prototype.g=function(){return new XMLHttpRequest},gy=new Nl;function gs(a){return encodeURIComponent(String(a))}function WC(a){var d=1;a=a.split(":");let f=[];for(;d>0&&a.length;)f.push(a.shift()),d--;return a.length&&f.push(a.join(":")),f}function Dn(a,d,f,g){this.j=a,this.i=d,this.l=f,this.S=g||1,this.V=new ls(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new my}function my(){this.i=null,this.g="",this.h=!1}var yy={},Rl={};function Ml(a,d,f){a.M=1,a.A=oa(Ot(d)),a.u=f,a.R=!0,_y(a,null)}function _y(a,d){a.F=Date.now(),sa(a),a.B=Ot(a.A);var f=a.B,g=a.S;Array.isArray(g)||(g=[String(g)]),My(f.i,"t",g),a.C=0,f=a.j.L,a.h=new my,a.g=Qy(a.j,f?d:null,!a.u),a.P>0&&(a.O=new jC(l(a.Y,a,a.g),a.P)),d=a.V,f=a.g,g=a.ba;var D="readystatechange";Array.isArray(D)||(D&&(oy[0]=D.toString()),D=oy);for(let b=0;b<D.length;b++){let x=ey(f,D[b],g||d.handleEvent,!1,d.h||d);if(!x)break;d.g[x.key]=x}d=a.J?Zm(a.J):{},a.u?(a.v||(a.v="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,d)):(a.v="GET",a.g.ea(a.B,a.v,null,d)),fs(),$C(a.i,a.v,a.B,a.l,a.S,a.u)}Dn.prototype.ba=function(a){a=a.target;let d=this.O;d&&Sn(a)==3?d.j():this.Y(a)},Dn.prototype.Y=function(a){try{if(a==this.g)e:{let Q=Sn(this.g),ke=this.g.ya(),ye=this.g.ca();if(!(Q<3)&&(Q!=3||this.g&&(this.h.h||this.g.la()||Vy(this.g)))){this.K||Q!=4||ke==7||(ke==8||ye<=0?fs(3):fs(2)),xl(this);var d=this.g.ca();this.X=d;var f=KC(this);if(this.o=d==200,qC(this.i,this.v,this.B,this.l,this.S,Q,d),this.o){if(this.U&&!this.L){t:{if(this.g){var g,D=this.g;if((g=D.g?D.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(g)){var b=g;break t}}b=null}if(a=b)Yr(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Pl(this,a);else{this.o=!1,this.m=3,et(12),or(this),ms(this);break e}}if(this.R){a=!0;let Le;for(;!this.K&&this.C<f.length;)if(Le=QC(this,f),Le==Rl){Q==4&&(this.m=4,et(14),a=!1),Yr(this.i,this.l,null,"[Incomplete Response]");break}else if(Le==yy){this.m=4,et(15),Yr(this.i,this.l,f,"[Invalid Chunk]"),a=!1;break}else Yr(this.i,this.l,Le,null),Pl(this,Le);if(vy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Q!=4||f.length!=0||this.h.h||(this.m=1,et(16),a=!1),this.o=this.o&&a,!a)Yr(this.i,this.l,f,"[Invalid Chunked Response]"),or(this),ms(this);else if(f.length>0&&!this.W){this.W=!0;var x=this.j;x.g==this&&x.aa&&!x.P&&(x.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),jl(x),x.P=!0,et(11))}}else Yr(this.i,this.l,f,null),Pl(this,f);Q==4&&or(this),this.o&&!this.K&&(Q==4?zy(this.j,this):(this.o=!1,sa(this)))}else ub(this.g),d==400&&f.indexOf("Unknown SID")>0?(this.m=3,et(12)):(this.m=0,et(13)),or(this),ms(this)}}}catch{}finally{}};function KC(a){if(!vy(a))return a.g.la();let d=Vy(a.g);if(d==="")return"";let f="",g=d.length,D=Sn(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return or(a),ms(a),"";a.h.i=new o.TextDecoder}for(let b=0;b<g;b++)a.h.h=!0,f+=a.h.i.decode(d[b],{stream:!(D&&b==g-1)});return d.length=0,a.h.g+=f,a.C=0,a.h.g}function vy(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function QC(a,d){var f=a.C,g=d.indexOf(`
`,f);return g==-1?Rl:(f=Number(d.substring(f,g)),isNaN(f)?yy:(g+=1,g+f>d.length?Rl:(d=d.slice(g,g+f),a.C=g+f,d)))}Dn.prototype.cancel=function(){this.K=!0,or(this)};function sa(a){a.T=Date.now()+a.H,Ey(a,a.H)}function Ey(a,d){if(a.D!=null)throw Error("WatchDog timer not null");a.D=hs(l(a.aa,a),d)}function xl(a){a.D&&(o.clearTimeout(a.D),a.D=null)}Dn.prototype.aa=function(){this.D=null;let a=Date.now();a-this.T>=0?(zC(this.i,this.B),this.M!=2&&(fs(),et(17)),or(this),this.m=2,ms(this)):Ey(this,this.T-a)};function ms(a){a.j.I==0||a.K||zy(a.j,a)}function or(a){xl(a);var d=a.O;d&&typeof d.dispose=="function"&&d.dispose(),a.O=null,ay(a.V),a.g&&(d=a.g,a.g=null,d.abort(),d.dispose())}function Pl(a,d){try{var f=a.j;if(f.I!=0&&(f.g==a||kl(f.h,a))){if(!a.L&&kl(f.h,a)&&f.I==3){try{var g=f.Ba.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var D=g;if(D[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<a.F)fa(f),la(f);else break e;Bl(f),et(18)}}else f.xa=D[1],0<f.xa-f.K&&D[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=hs(l(f.Va,f),6e3));Ty(f.h)<=1&&f.ta&&(f.ta=void 0)}else cr(f,11)}else if((a.L||f.g==a)&&fa(f),!v(d))for(D=f.Ba.g.parse(d),d=0;d<D.length;d++){let ye=D[d],Le=ye[0];if(!(Le<=f.K))if(f.K=Le,ye=ye[1],f.I==2)if(ye[0]=="c"){f.M=ye[1],f.ba=ye[2];let Lt=ye[3];Lt!=null&&(f.ka=Lt,f.j.info("VER="+f.ka));let ur=ye[4];ur!=null&&(f.za=ur,f.j.info("SVER="+f.za));let An=ye[5];An!=null&&typeof An=="number"&&An>0&&(g=1.5*An,f.O=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Nn=a.g;if(Nn){let pa=Nn.g?Nn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pa){var b=g.h;b.g||pa.indexOf("spdy")==-1&&pa.indexOf("quic")==-1&&pa.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Ol(b,b.h),b.h=null))}if(g.G){let Ul=Nn.g?Nn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ul&&(g.wa=Ul,ve(g.J,g.G,Ul))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-a.F,f.j.info("Handshake RTT: "+f.T+"ms")),g=f;var x=a;if(g.na=Ky(g,g.L?g.ba:null,g.W),x.L){Dy(g.h,x);var Q=x,ke=g.O;ke&&(Q.H=ke),Q.D&&(xl(Q),sa(Q)),g.g=x}else $y(g);f.i.length>0&&da(f)}else ye[0]!="stop"&&ye[0]!="close"||cr(f,7);else f.I==3&&(ye[0]=="stop"||ye[0]=="close"?ye[0]=="stop"?cr(f,7):Vl(f):ye[0]!="noop"&&f.l&&f.l.qa(ye),f.A=0)}}fs(4)}catch{}}var YC=class{constructor(a,d){this.g=a,this.map=d}};function Iy(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function wy(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Ty(a){return a.h?1:a.g?a.g.size:0}function kl(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function Ol(a,d){a.g?a.g.add(d):a.h=d}function Dy(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}Iy.prototype.cancel=function(){if(this.i=Cy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Cy(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let d=a.i;for(let f of a.g.values())d=d.concat(f.G);return d}return I(a.i)}var by=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ZC(a,d){if(a){a=a.split("&");for(let f=0;f<a.length;f++){let g=a[f].indexOf("="),D,b=null;g>=0?(D=a[f].substring(0,g),b=a[f].substring(g+1)):D=a[f],d(D,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Cn(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let d;a instanceof Cn?(this.l=a.l,ys(this,a.j),this.o=a.o,this.g=a.g,_s(this,a.u),this.h=a.h,Ll(this,xy(a.i)),this.m=a.m):a&&(d=String(a).match(by))?(this.l=!1,ys(this,d[1]||"",!0),this.o=vs(d[2]||""),this.g=vs(d[3]||"",!0),_s(this,d[4]),this.h=vs(d[5]||"",!0),Ll(this,d[6]||"",!0),this.m=vs(d[7]||"")):(this.l=!1,this.i=new Is(null,this.l))}Cn.prototype.toString=function(){let a=[];var d=this.j;d&&a.push(Es(d,Sy,!0),":");var f=this.g;return(f||d=="file")&&(a.push("//"),(d=this.o)&&a.push(Es(d,Sy,!0),"@"),a.push(gs(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&a.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(Es(f,f.charAt(0)=="/"?eb:XC,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",Es(f,nb)),a.join("")},Cn.prototype.resolve=function(a){let d=Ot(this),f=!!a.j;f?ys(d,a.j):f=!!a.o,f?d.o=a.o:f=!!a.g,f?d.g=a.g:f=a.u!=null;var g=a.h;if(f)_s(d,a.u);else if(f=!!a.h){if(g.charAt(0)!="/")if(this.g&&!this.h)g="/"+g;else{var D=d.h.lastIndexOf("/");D!=-1&&(g=d.h.slice(0,D+1)+g)}if(D=g,D==".."||D==".")g="";else if(D.indexOf("./")!=-1||D.indexOf("/.")!=-1){g=D.lastIndexOf("/",0)==0,D=D.split("/");let b=[];for(let x=0;x<D.length;){let Q=D[x++];Q=="."?g&&x==D.length&&b.push(""):Q==".."?((b.length>1||b.length==1&&b[0]!="")&&b.pop(),g&&x==D.length&&b.push("")):(b.push(Q),g=!0)}g=b.join("/")}else g=D}return f?d.h=g:f=a.i.toString()!=="",f?Ll(d,xy(a.i)):f=!!a.m,f&&(d.m=a.m),d};function Ot(a){return new Cn(a)}function ys(a,d,f){a.j=f?vs(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function _s(a,d){if(d){if(d=Number(d),isNaN(d)||d<0)throw Error("Bad port number "+d);a.u=d}else a.u=null}function Ll(a,d,f){d instanceof Is?(a.i=d,rb(a.i,a.l)):(f||(d=Es(d,tb)),a.i=new Is(d,a.l))}function ve(a,d,f){a.i.set(d,f)}function oa(a){return ve(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function vs(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Es(a,d,f){return typeof a=="string"?(a=encodeURI(a).replace(d,JC),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function JC(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Sy=/[#\/\?@]/g,XC=/[#\?:]/g,eb=/[#\?]/g,tb=/[#\?@]/g,nb=/#/g;function Is(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function ar(a){a.g||(a.g=new Map,a.h=0,a.i&&ZC(a.i,function(d,f){a.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=Is.prototype,n.add=function(a,d){ar(this),this.i=null,a=Zr(this,a);let f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(d),this.h+=1,this};function Ay(a,d){ar(a),d=Zr(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function Ny(a,d){return ar(a),d=Zr(a,d),a.g.has(d)}n.forEach=function(a,d){ar(this),this.g.forEach(function(f,g){f.forEach(function(D){a.call(d,D,g,this)},this)},this)};function Ry(a,d){ar(a);let f=[];if(typeof d=="string")Ny(a,d)&&(f=f.concat(a.g.get(Zr(a,d))));else for(a=Array.from(a.g.values()),d=0;d<a.length;d++)f=f.concat(a[d]);return f}n.set=function(a,d){return ar(this),this.i=null,a=Zr(this,a),Ny(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},n.get=function(a,d){return a?(a=Ry(this,a),a.length>0?String(a[0]):d):d};function My(a,d,f){Ay(a,d),f.length>0&&(a.i=null,a.g.set(Zr(a,d),I(f)),a.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],d=Array.from(this.g.keys());for(let g=0;g<d.length;g++){var f=d[g];let D=gs(f);f=Ry(this,f);for(let b=0;b<f.length;b++){let x=D;f[b]!==""&&(x+="="+gs(f[b])),a.push(x)}}return this.i=a.join("&")};function xy(a){let d=new Is;return d.i=a.i,a.g&&(d.g=new Map(a.g),d.h=a.h),d}function Zr(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function rb(a,d){d&&!a.j&&(ar(a),a.i=null,a.g.forEach(function(f,g){let D=g.toLowerCase();g!=D&&(Ay(this,g),My(this,D,f))},a)),a.j=d}function ib(a,d){let f=new ps;if(o.Image){let g=new Image;g.onload=h(bn,f,"TestLoadImage: loaded",!0,d,g),g.onerror=h(bn,f,"TestLoadImage: error",!1,d,g),g.onabort=h(bn,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=h(bn,f,"TestLoadImage: timeout",!1,d,g),o.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=a}else d(!1)}function sb(a,d){let f=new ps,g=new AbortController,D=setTimeout(()=>{g.abort(),bn(f,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:g.signal}).then(b=>{clearTimeout(D),b.ok?bn(f,"TestPingServer: ok",!0,d):bn(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),bn(f,"TestPingServer: error",!1,d)})}function bn(a,d,f,g,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),g(f)}catch{}}function ob(){this.g=new HC}function aa(a){this.i=a.Sb||null,this.h=a.ab||!1}p(aa,cy),aa.prototype.g=function(){return new ca(this.i,this.h)};function ca(a,d){He.call(this),this.H=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(ca,He),n=ca.prototype,n.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=d,this.readyState=1,Ts(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let d={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(d.body=a),(this.H||o).fetch(new Request(this.D,d)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ws(this)),this.readyState=0},n.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ts(this)),this.g&&(this.readyState=3,Ts(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Py(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function Py(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}n.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.B.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?ws(this):Ts(this),this.readyState==3&&Py(this)}},n.Oa=function(a){this.g&&(this.response=this.responseText=a,ws(this))},n.Na=function(a){this.g&&(this.response=a,ws(this))},n.ga=function(){this.g&&ws(this)};function ws(a){a.readyState=4,a.l=null,a.j=null,a.B=null,Ts(a)}n.setRequestHeader=function(a,d){this.A.append(a,d)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=d.next();return a.join(`\r
`)};function Ts(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function ky(a){let d="";return ea(a,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function Fl(a,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=ky(f),typeof a=="string"?f!=null&&gs(f):ve(a,d,f))}function De(a){He.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(De,He);var ab=/^https?$/i,cb=["POST","PUT"];n=De.prototype,n.Fa=function(a){this.H=a},n.ea=function(a,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():gy.g(),this.g.onreadystatechange=m(l(this.Ca,this));try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(b){Oy(this,b);return}if(a=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var D in g)f.set(D,g[D]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let b of g.keys())f.set(b,g.get(b));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(b=>b.toLowerCase()=="content-type"),D=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(cb,d,void 0)>=0)||g||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,x]of f)this.g.setRequestHeader(b,x);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(b){Oy(this,b)}};function Oy(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.o=5,Ly(a),ua(a)}function Ly(a){a.A||(a.A=!0,Xe(a,"complete"),Xe(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,Xe(this,"complete"),Xe(this,"abort"),ua(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ua(this,!0)),De.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Fy(this):this.Xa())},n.Xa=function(){Fy(this)};function Fy(a){if(a.h&&typeof s<"u"){if(a.v&&Sn(a)==4)setTimeout(a.Ca.bind(a),0);else if(Xe(a,"readystatechange"),Sn(a)==4){a.h=!1;try{let b=a.ca();e:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=b===0){let x=String(a.D).match(by)[1]||null;!x&&o.self&&o.self.location&&(x=o.self.location.protocol.slice(0,-1)),g=!ab.test(x?x.toLowerCase():"")}f=g}if(f)Xe(a,"complete"),Xe(a,"success");else{a.o=6;try{var D=Sn(a)>2?a.g.statusText:""}catch{D=""}a.l=D+" ["+a.ca()+"]",Ly(a)}}finally{ua(a)}}}}function ua(a,d){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);let f=a.g;a.g=null,d||Xe(a,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Sn(a){return a.g?a.g.readyState:0}n.ca=function(){try{return Sn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),UC(d)}};function Vy(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function ub(a){let d={};a=(a.g&&Sn(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<a.length;g++){if(v(a[g]))continue;var f=WC(a[g]);let D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let b=d[D]||[];d[D]=b,b.push(f)}LC(d,function(g){return g.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ds(a,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||d}function By(a){this.za=0,this.i=[],this.j=new ps,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ds("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ds("baseRetryDelayMs",5e3,a),this.Za=Ds("retryDelaySeedMs",1e4,a),this.Ta=Ds("forwardChannelMaxRetries",2,a),this.va=Ds("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new Iy(a&&a.concurrentRequestLimit),this.Ba=new ob,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=By.prototype,n.ka=8,n.I=1,n.connect=function(a,d,f,g){et(0),this.W=a,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.J=Ky(this,null,this.W),da(this)};function Vl(a){if(jy(a),a.I==3){var d=a.V++,f=Ot(a.J);if(ve(f,"SID",a.M),ve(f,"RID",d),ve(f,"TYPE","terminate"),Cs(a,f),d=new Dn(a,a.j,d),d.M=2,d.A=oa(Ot(f)),f=!1,o.navigator&&o.navigator.sendBeacon)try{f=o.navigator.sendBeacon(d.A.toString(),"")}catch{}!f&&o.Image&&(new Image().src=d.A,f=!0),f||(d.g=Qy(d.j,null),d.g.ea(d.A)),d.F=Date.now(),sa(d)}Wy(a)}function la(a){a.g&&(jl(a),a.g.cancel(),a.g=null)}function jy(a){la(a),a.v&&(o.clearTimeout(a.v),a.v=null),fa(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function da(a){if(!wy(a.h)&&!a.m){a.m=!0;var d=a.Ea;ae||y(),k||(ae(),k=!0),E.add(d,a),a.D=0}}function lb(a,d){return Ty(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=d.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=hs(l(a.Ea,a,d),Gy(a,a.D)),a.D++,!0)}n.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;let D=new Dn(this,this.j,a),b=this.o;if(this.U&&(b?(b=Zm(b),Xm(b,this.U)):b=this.U),this.u!==null||this.R||(D.J=b,b=null),this.S)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,d>4096){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Hy(this,D,d),f=Ot(this.J),ve(f,"RID",a),ve(f,"CVER",22),this.G&&ve(f,"X-HTTP-Session-Id",this.G),Cs(this,f),b&&(this.R?d="headers="+gs(ky(b))+"&"+d:this.u&&Fl(f,this.u,b)),Ol(this.h,D),this.Ra&&ve(f,"TYPE","init"),this.S?(ve(f,"$req",d),ve(f,"SID","null"),D.U=!0,Ml(D,f,null)):Ml(D,f,d),this.I=2}}else this.I==3&&(a?Uy(this,a):this.i.length==0||wy(this.h)||Uy(this))};function Uy(a,d){var f;d?f=d.l:f=a.V++;let g=Ot(a.J);ve(g,"SID",a.M),ve(g,"RID",f),ve(g,"AID",a.K),Cs(a,g),a.u&&a.o&&Fl(g,a.u,a.o),f=new Dn(a,a.j,f,a.D+1),a.u===null&&(f.J=a.o),d&&(a.i=d.G.concat(a.i)),d=Hy(a,f,1e3),f.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),Ol(a.h,f),Ml(f,g,d)}function Cs(a,d){a.H&&ea(a.H,function(f,g){ve(d,g,f)}),a.l&&ea({},function(f,g){ve(d,g,f)})}function Hy(a,d,f){f=Math.min(a.i.length,f);let g=a.l?l(a.l.Ka,a.l,a):null;e:{var D=a.i;let Q=-1;for(;;){let ke=["count="+f];Q==-1?f>0?(Q=D[0].g,ke.push("ofs="+Q)):Q=0:ke.push("ofs="+Q);let ye=!0;for(let Le=0;Le<f;Le++){var b=D[Le].g;let Lt=D[Le].map;if(b-=Q,b<0)Q=Math.max(0,D[Le].g-100),ye=!1;else try{b="req"+b+"_"||"";try{var x=Lt instanceof Map?Lt:Object.entries(Lt);for(let[ur,An]of x){let Nn=An;c(An)&&(Nn=bl(An)),ke.push(b+ur+"="+encodeURIComponent(Nn))}}catch(ur){throw ke.push(b+"type="+encodeURIComponent("_badmap")),ur}}catch{g&&g(Lt)}}if(ye){x=ke.join("&");break e}}x=void 0}return a=a.i.splice(0,f),d.G=a,x}function $y(a){if(!a.g&&!a.v){a.Y=1;var d=a.Da;ae||y(),k||(ae(),k=!0),E.add(d,a),a.A=0}}function Bl(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=hs(l(a.Da,a),Gy(a,a.A)),a.A++,!0)}n.Da=function(){if(this.v=null,qy(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=hs(l(this.Wa,this),a)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,et(10),la(this),qy(this))};function jl(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function qy(a){a.g=new Dn(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var d=Ot(a.na);ve(d,"RID","rpc"),ve(d,"SID",a.M),ve(d,"AID",a.K),ve(d,"CI",a.F?"0":"1"),!a.F&&a.ia&&ve(d,"TO",a.ia),ve(d,"TYPE","xmlhttp"),Cs(a,d),a.u&&a.o&&Fl(d,a.u,a.o),a.O&&(a.g.H=a.O);var f=a.g;a=a.ba,f.M=1,f.A=oa(Ot(d)),f.u=null,f.R=!0,_y(f,a)}n.Va=function(){this.C!=null&&(this.C=null,la(this),Bl(this),et(19))};function fa(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function zy(a,d){var f=null;if(a.g==d){fa(a),jl(a),a.g=null;var g=2}else if(kl(a.h,d))f=d.G,Dy(a.h,d),g=1;else return;if(a.I!=0){if(d.o)if(g==1){f=d.u?d.u.length:0,d=Date.now()-d.F;var D=a.D;g=ra(),Xe(g,new hy(g,f)),da(a)}else $y(a);else if(D=d.m,D==3||D==0&&d.X>0||!(g==1&&lb(a,d)||g==2&&Bl(a)))switch(f&&f.length>0&&(d=a.h,d.i=d.i.concat(f)),D){case 1:cr(a,5);break;case 4:cr(a,10);break;case 3:cr(a,6);break;default:cr(a,2)}}}function Gy(a,d){let f=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(f*=2),f*d}function cr(a,d){if(a.j.info("Error code "+d),d==2){var f=l(a.bb,a),g=a.Ua;let D=!g;g=new Cn(g||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ys(g,"https"),oa(g),D?ib(g.toString(),f):sb(g.toString(),f)}else et(2);a.I=0,a.l&&a.l.pa(d),Wy(a),jy(a)}n.bb=function(a){a?(this.j.info("Successfully pinged google.com"),et(2)):(this.j.info("Failed to ping google.com"),et(1))};function Wy(a){if(a.I=0,a.ja=[],a.l){let d=Cy(a.h);(d.length!=0||a.i.length!=0)&&(S(a.ja,d),S(a.ja,a.i),a.h.i.length=0,I(a.i),a.i.length=0),a.l.oa()}}function Ky(a,d,f){var g=f instanceof Cn?Ot(f):new Cn(f);if(g.g!="")d&&(g.g=d+"."+g.g),_s(g,g.u);else{var D=o.location;g=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;let b=new Cn(null);g&&ys(b,g),d&&(b.g=d),D&&_s(b,D),f&&(b.h=f),g=b}return f=a.G,d=a.wa,f&&d&&ve(g,f,d),ve(g,"VER",a.ka),Cs(a,g),g}function Qy(a,d,f){if(d&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Aa&&!a.ma?new De(new aa({ab:f})):new De(a.ma),d.Fa(a.L),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yy(){}n=Yy.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ha(){}ha.prototype.g=function(a,d){return new at(a,d)};function at(a,d){He.call(this),this.g=new By(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.sa&&(a?a["X-WebChannel-Client-Profile"]=d.sa:a={"X-WebChannel-Client-Profile":d.sa}),this.g.U=a,(a=d&&d.Qb)&&!v(a)&&(this.g.u=a),this.A=d&&d.supportsCrossDomainXhr||!1,this.v=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!v(d)&&(this.g.G=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new Jr(this)}p(at,He),at.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},at.prototype.close=function(){Vl(this.g)},at.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.v&&(f={},f.__data__=bl(a),a=f);d.i.push(new YC(d.Ya++,a)),d.I==3&&da(d)},at.prototype.N=function(){this.g.l=null,delete this.j,Vl(this.g),delete this.g,at.Z.N.call(this)};function Zy(a){Sl.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(let f in d){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}p(Zy,Sl);function Jy(){Al.call(this),this.status=1}p(Jy,Al);function Jr(a){this.g=a}p(Jr,Yy),Jr.prototype.ra=function(){Xe(this.g,"a")},Jr.prototype.qa=function(a){Xe(this.g,new Zy(a))},Jr.prototype.pa=function(a){Xe(this.g,new Jy)},Jr.prototype.oa=function(){Xe(this.g,"b")},ha.prototype.createWebChannel=ha.prototype.g,at.prototype.send=at.prototype.o,at.prototype.open=at.prototype.m,at.prototype.close=at.prototype.close,op=fn.createWebChannelTransport=function(){return new ha},sp=fn.getStatEventTarget=function(){return ra()},ip=fn.Event=sr,Jc=fn.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ia.NO_ERROR=0,ia.TIMEOUT=8,ia.HTTP_ERROR=6,To=fn.ErrorCode=ia,py.COMPLETE="complete",rp=fn.EventType=py,uy.EventType=ds,ds.OPEN="a",ds.CLOSE="b",ds.ERROR="c",ds.MESSAGE="d",He.prototype.listen=He.prototype.J,xi=fn.WebChannel=uy,PM=fn.FetchXmlHttpFactory=aa,De.prototype.listenOnce=De.prototype.K,De.prototype.getLastError=De.prototype.Ha,De.prototype.getLastErrorCode=De.prototype.ya,De.prototype.getStatus=De.prototype.ca,De.prototype.getResponseJson=De.prototype.La,De.prototype.getResponseText=De.prototype.la,De.prototype.send=De.prototype.ea,De.prototype.setWithCredentials=De.prototype.Fa,np=fn.XhrIo=De}).apply(typeof Zc<"u"?Zc:typeof self<"u"?self:typeof window<"u"?window:{});var _w="@firebase/firestore",vw="4.9.3";var je=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};je.UNAUTHENTICATED=new je(null),je.GOOGLE_CREDENTIALS=new je("google-credentials-uid"),je.FIRST_PARTY=new je("first-party-uid"),je.MOCK_USER=new je("mock-user");var es="12.7.0";var Br=new $n("@firebase/firestore");function Pi(){return Br.logLevel}function P(n,...e){if(Br.logLevel<=ne.DEBUG){let t=e.map(Gg);Br.debug(`Firestore (${es}): ${n}`,...t)}}function hn(n,...e){if(Br.logLevel<=ne.ERROR){let t=e.map(Gg);Br.error(`Firestore (${es}): ${n}`,...t)}}function Ui(n,...e){if(Br.logLevel<=ne.WARN){let t=e.map(Gg);Br.warn(`Firestore (${es}): ${n}`,...t)}}function Gg(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function V(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,sT(n,r,t)}function sT(n,e,t){let r=`FIRESTORE (${es}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw hn(r),new Error(r)}function le(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||sT(e,i,r)}function z(n,e){return n}var A={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends dt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Zt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var su=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},fp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(je.UNAUTHENTICATED))}shutdown(){}},hp=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},pp=class{constructor(e){this.t=e,this.currentUser=je.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){le(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new Zt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Zt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Zt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(le(typeof r.accessToken=="string",31837,{l:r}),new su(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return le(e===null||typeof e=="string",2055,{h:e}),new je(e)}},gp=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=je.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},mp=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new gp(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(je.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ou=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},yp=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){le(this.o===void 0,3512);let r=s=>{s.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,P("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ou(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(le(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ou(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function kM(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var No=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=kM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function ie(n,e){return n<e?-1:n>e?1:0}function _p(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return ap(i)===ap(s)?ie(i,s):ap(i)?1:-1}return ie(n.length,e.length)}var OM=55296,LM=57343;function ap(n){let e=n.charCodeAt(0);return e>=OM&&e<=LM}function Hi(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Ew="__name__",au=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&V(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&V(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return ie(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):_p(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return dn.fromString(e.substring(4,e.length-2))}},Ae=class n extends au{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(A.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},FM=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ft=class n extends au{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return FM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ew}static keyField(){return new n([Ew])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(A.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new L(A.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new L(A.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new L(A.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ae.fromString(e))}static fromName(e){return new n(Ae.fromString(e).popFirst(5))}static empty(){return new n(Ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ae(e.slice()))}};function VM(n,e,t){if(!t)throw new L(A.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function BM(n,e,t,r){if(e===!0&&r===!0)throw new L(A.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Iw(n){if(!B.isDocumentKey(n))throw new L(A.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function oT(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Wg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":V(12329,{type:typeof n})}function Wn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(A.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Wg(n);throw new L(A.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function xe(n,e){let t={typeString:n};return e&&(t.value=e),t}function Uo(n,e){if(!oT(n))throw new L(A.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new L(A.INVALID_ARGUMENT,t);return!0}var ww=-62135596800,Tw=1e6,Pe=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Tw);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ww)throw new L(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tw}_compareTo(e){return this.seconds===e.seconds?ie(this.nanoseconds,e.nanoseconds):ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Uo(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-ww;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Pe._jsonSchemaVersion="firestore/timestamp/1.0",Pe._jsonSchema={type:xe("string",Pe._jsonSchemaVersion),seconds:xe("number"),nanoseconds:xe("number")};var W=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Pe(0,0))}static max(){return new n(new Pe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ro=-1,vp=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};vp.UNKNOWN_ID=-1;function jM(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new Pe(t+1,0):new Pe(t,r));return new jr(i,B.empty(),e)}function UM(n){return new jr(n.readTime,n.key,Ro)}var jr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),B.empty(),Ro)}static max(){return new n(W.max(),B.empty(),Ro)}};function HM(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:ie(n.largestBatchId,e.largestBatchId))}var $M="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ep=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function ts(n){if(n.code!==A.FAILED_PRECONDITION||n.message!==$M)throw n;P("LocalStore","Unexpectedly lost primary lease")}var N=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&V(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&t()},u=>r(u))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),c=0;for(let u=0;u<s;u++){let l=u;t(e[l]).next(h=>{o[l]=h,++c,c===s&&r(o)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function qM(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ns(n){return n.name==="IndexedDbTransactionError"}var Kg=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Qg=-1;function ju(n){return n==null}function Mo(n){return n===0&&1/n==-1/0}function zM(n){return typeof n=="number"&&Number.isInteger(n)&&!Mo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var aT="";function GM(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Dw(e)),e=WM(n.get(t),e);return Dw(e)}function WM(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case aT:t+="";break;default:t+=s}}return t}function Dw(n){return n+aT+""}var KM="remoteDocuments",cT="owner";var uT="mutationQueues";var lT="mutations";var dT="documentMutations",QM="remoteDocumentsV14";var fT="remoteDocumentGlobal";var hT="targets";var pT="targetDocuments";var gT="targetGlobal",mT="collectionParents";var yT="clientMetadata";var _T="bundles";var vT="namedQueries";var YM="indexConfiguration";var ZM="indexState";var JM="indexEntries";var ET="documentOverlays";var XM="globals";var ex=[uT,lT,dT,KM,hT,cT,gT,pT,yT,fT,mT,_T,vT],z6=[...ex,ET],tx=[uT,lT,dT,QM,hT,cT,gT,pT,yT,fT,mT,_T,vT,ET],nx=tx,rx=[...nx,YM,ZM,JM];var G6=[...rx,XM];function Cw(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function IT(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Se=class n{constructor(e,t){this.comparator=e,this.root=t||Jt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fi(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fi(this.root,e,this.comparator,!0)}},Fi=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Jt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw V(43730,{key:this.key,value:this.value});if(this.right.isRed())throw V(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw V(27949);return e+(this.isRed()?0:1)}};Jt.EMPTY=null,Jt.RED=!0,Jt.BLACK=!1;Jt.EMPTY=new class{constructor(){this.size=0}get key(){throw V(57766)}get value(){throw V(16141)}get color(){throw V(16727)}get left(){throw V(29726)}get right(){throw V(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Jt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ue=class n{constructor(e){this.comparator=e,this.data=new Se(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cu(this.data.getIterator())}getIteratorFrom(e){return new cu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},cu=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Yt=class n{constructor(e){this.fields=e,e.sort(ft.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ue(ft.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Hi(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var uu=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Je=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new uu("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Je.EMPTY_BYTE_STRING=new Je("");var ix=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pn(n){if(le(!!n,39018),typeof n=="string"){let e=0,t=ix.exec(n);if(le(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ie(n.seconds),nanos:Ie(n.nanos)}}function Ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gn(n){return typeof n=="string"?Je.fromBase64String(n):Je.fromUint8Array(n)}var wT="server_timestamp",TT="__type__",DT="__previous_value__",CT="__local_write_time__";function Yg(n){return(n?.mapValue?.fields||{})[TT]?.stringValue===wT}function Uu(n){let e=n.mapValue.fields[DT];return Yg(e)?Uu(e):e}function xo(n){let e=pn(n.mapValue.fields[CT].timestampValue);return new Pe(e.seconds,e.nanos)}var Ip=class{constructor(e,t,r,i,s,o,c,u,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=h}},lu="(default)",du=class n{constructor(e,t){this.projectId=e,this.database=t||lu}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===lu}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Zg="__type__",bT="__max__",Xc={mapValue:{fields:{__type__:{stringValue:bT}}}},Jg="__vector__",$i="value";function Zn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Yg(n)?4:AT(n)?9007199254740991:ST(n)?10:11:V(28295,{value:n})}function tn(n,e){if(n===e)return!0;let t=Zn(n);if(t!==Zn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xo(n).isEqual(xo(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=pn(i.timestampValue),c=pn(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return gn(i.bytesValue).isEqual(gn(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return Ie(i.geoPointValue.latitude)===Ie(s.geoPointValue.latitude)&&Ie(i.geoPointValue.longitude)===Ie(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Ie(i.integerValue)===Ie(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ie(i.doubleValue),c=Ie(s.doubleValue);return o===c?Mo(o)===Mo(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return Hi(n.arrayValue.values||[],e.arrayValue.values||[],tn);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(Cw(o)!==Cw(c))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!tn(o[u],c[u])))return!1;return!0})(n,e);default:return V(52216,{left:n})}}function Po(n,e){return(n.values||[]).find(t=>tn(t,e))!==void 0}function qi(n,e){if(n===e)return 0;let t=Zn(n),r=Zn(e);if(t!==r)return ie(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ie(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let c=Ie(s.integerValue||s.doubleValue),u=Ie(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return bw(n.timestampValue,e.timestampValue);case 4:return bw(xo(n),xo(e));case 5:return _p(n.stringValue,e.stringValue);case 6:return(function(s,o){let c=gn(s),u=gn(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let c=s.split("/"),u=o.split("/");for(let l=0;l<c.length&&l<u.length;l++){let h=ie(c[l],u[l]);if(h!==0)return h}return ie(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let c=ie(Ie(s.latitude),Ie(o.latitude));return c!==0?c:ie(Ie(s.longitude),Ie(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Sw(n.arrayValue,e.arrayValue);case 10:return(function(s,o){let c=s.fields||{},u=o.fields||{},l=c[$i]?.arrayValue,h=u[$i]?.arrayValue,p=ie(l?.values?.length||0,h?.values?.length||0);return p!==0?p:Sw(l,h)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Xc.mapValue&&o===Xc.mapValue)return 0;if(s===Xc.mapValue)return 1;if(o===Xc.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),l=o.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){let m=_p(u[p],h[p]);if(m!==0)return m;let I=qi(c[u[p]],l[h[p]]);if(I!==0)return I}return ie(u.length,h.length)})(n.mapValue,e.mapValue);default:throw V(23264,{he:t})}}function bw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ie(n,e);let t=pn(n),r=pn(e),i=ie(t.seconds,r.seconds);return i!==0?i:ie(t.nanos,r.nanos)}function Sw(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=qi(t[i],r[i]);if(s)return s}return ie(t.length,r.length)}function zi(n){return wp(n)}function wp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=pn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return gn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return B.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=wp(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${wp(t.fields[o])}`;return i+"}"})(n.mapValue):V(61005,{value:n})}function nu(n){switch(Zn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Uu(n);return e?16+nu(e):16;case 5:return 2*n.stringValue.length;case 6:return gn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+nu(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Gr(r.fields,(s,o)=>{i+=s.length+nu(o)}),i})(n.mapValue);default:throw V(13486,{value:n})}}function Tp(n){return!!n&&"integerValue"in n}function Xg(n){return!!n&&"arrayValue"in n}function Aw(n){return!!n&&"nullValue"in n}function Nw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ru(n){return!!n&&"mapValue"in n}function ST(n){return(n?.mapValue?.fields||{})[Zg]?.stringValue===Jg}function Co(n){if(n.geoPointValue)return{geoPointValue:j({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:j({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Gr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Co(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Co(n.arrayValue.values[t]);return e}return j({},n)}function AT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===bT}var K6={mapValue:{fields:{[Zg]:{stringValue:Jg},[$i]:{arrayValue:{}}}}};var xt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ru(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Co(t)}setAll(e){let t=ft.emptyPath(),r={},i=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=Co(o):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return tn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ru(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Gr(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Co(this.value))}};function NT(n){let e=[];return Gr(n.fields,(t,r)=>{let i=new ft([t]);if(ru(r)){let s=NT(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Yt(e)}var Pt=class n{constructor(e,t,r,i,s,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),xt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),xt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),xt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Gi=class{constructor(e,t){this.position=e,this.inclusive=t}};function Rw(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=B.comparator(B.fromName(o.referenceValue),t.key):r=qi(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!tn(n.position[t],e.position[t]))return!1;return!0}var Wi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function sx(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var fu=class{},Oe=class n extends fu{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Cp(e,t,r):t==="array-contains"?new Ap(e,r):t==="in"?new Np(e,r):t==="not-in"?new Rp(e,r):t==="array-contains-any"?new Mp(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new bp(e,r):new Sp(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(qi(t,this.value)):t!==null&&Zn(this.value)===Zn(t)&&this.matchesComparison(qi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return V(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},nn=class n extends fu{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return RT(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function RT(n){return n.op==="and"}function MT(n){return ox(n)&&RT(n)}function ox(n){for(let e of n.filters)if(e instanceof nn)return!1;return!0}function Dp(n){if(n instanceof Oe)return n.field.canonicalString()+n.op.toString()+zi(n.value);if(MT(n))return n.filters.map(e=>Dp(e)).join(",");{let e=n.filters.map(t=>Dp(t)).join(",");return`${n.op}(${e})`}}function xT(n,e){return n instanceof Oe?(function(r,i){return i instanceof Oe&&r.op===i.op&&r.field.isEqual(i.field)&&tn(r.value,i.value)})(n,e):n instanceof nn?(function(r,i){return i instanceof nn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,c)=>s&&xT(o,i.filters[c]),!0):!1})(n,e):void V(19439)}function PT(n){return n instanceof Oe?(function(t){return`${t.field.canonicalString()} ${t.op} ${zi(t.value)}`})(n):n instanceof nn?(function(t){return t.op.toString()+" {"+t.getFilters().map(PT).join(" ,")+"}"})(n):"Filter"}var Cp=class extends Oe{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},bp=class extends Oe{constructor(e,t){super(e,"in",t),this.keys=kT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Sp=class extends Oe{constructor(e,t){super(e,"not-in",t),this.keys=kT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function kT(n,e){return(e.arrayValue?.values||[]).map(t=>B.fromName(t.referenceValue))}var Ap=class extends Oe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Xg(t)&&Po(t.arrayValue,this.value)}},Np=class extends Oe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Po(this.value.arrayValue,t)}},Rp=class extends Oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Po(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Po(this.value.arrayValue,t)}},Mp=class extends Oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Xg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Po(this.value.arrayValue,r))}};var xp=class{constructor(e,t=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Te=null}};function xw(n,e=null,t=[],r=[],i=null,s=null,o=null){return new xp(n,e,t,r,i,s,o)}function em(n){let e=z(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Dp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),ju(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>zi(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>zi(r)).join(",")),e.Te=t}return e.Te}function tm(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!sx(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!xT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Mw(n.startAt,e.startAt)&&Mw(n.endAt,e.endAt)}function Pp(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ki=class{constructor(e,t=null,r=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function ax(n,e,t,r,i,s,o,c){return new Ki(n,e,t,r,i,s,o,c)}function Hu(n){return new Ki(n)}function Pw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cx(n){return n.collectionGroup!==null}function bo(n){let e=z(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ue(ft.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(c=c.add(l.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Wi(s,r))}),t.has(ft.keyField().canonicalString())||e.Ie.push(new Wi(ft.keyField(),r))}return e.Ie}function Xt(n){let e=z(n);return e.Ee||(e.Ee=ux(e,bo(n))),e.Ee}function ux(n,e){if(n.limitType==="F")return xw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Wi(i.field,s)});let t=n.endAt?new Gi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Gi(n.startAt.position,n.startAt.inclusive):null;return xw(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function kp(n,e,t){return new Ki(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $u(n,e){return tm(Xt(n),Xt(e))&&n.limitType===e.limitType}function OT(n){return`${em(Xt(n))}|lt:${n.limitType}`}function ki(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>PT(i)).join(", ")}]`),ju(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>zi(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>zi(i)).join(",")),`Target(${r})`})(Xt(n))}; limitType=${n.limitType})`}function qu(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):B.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of bo(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){let l=Rw(o,c,u);return o.inclusive?l<=0:l<0})(r.startAt,bo(r),i)||r.endAt&&!(function(o,c,u){let l=Rw(o,c,u);return o.inclusive?l>=0:l>0})(r.endAt,bo(r),i))})(n,e)}function lx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function LT(n){return(e,t)=>{let r=!1;for(let i of bo(n)){let s=dx(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function dx(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):(function(s,o,c){let u=o.data.field(s),l=c.data.field(s);return u!==null&&l!==null?qi(u,l):V(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return V(19790,{direction:n.dir})}}var mn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gr(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return IT(this.inner)}size(){return this.innerSize}};var fx=new Se(B.comparator);function yn(){return fx}var FT=new Se(B.comparator);function Do(...n){let e=FT;for(let t of n)e=e.insert(t.key,t);return e}function VT(n){let e=FT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function kr(){return So()}function BT(){return So()}function So(){return new mn(n=>n.toString(),(n,e)=>n.isEqual(e))}var hx=new Se(B.comparator),px=new Ue(B.comparator);function se(...n){let e=px;for(let t of n)e=e.add(t);return e}var gx=new Ue(ie);function mx(){return gx}function nm(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mo(e)?"-0":e}}function jT(n){return{integerValue:""+n}}function yx(n,e){return zM(e)?jT(e):nm(n,e)}var Qi=class{constructor(){this._=void 0}};function _x(n,e,t){return n instanceof Yi?(function(i,s){let o={fields:{[TT]:{stringValue:wT},[CT]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Yg(s)&&(s=Uu(s)),s&&(o.fields[DT]=s),{mapValue:o}})(t,e):n instanceof Ur?HT(n,e):n instanceof Hr?$T(n,e):(function(i,s){let o=UT(i,s),c=kw(o)+kw(i.Ae);return Tp(o)&&Tp(i.Ae)?jT(c):nm(i.serializer,c)})(n,e)}function vx(n,e,t){return n instanceof Ur?HT(n,e):n instanceof Hr?$T(n,e):t}function UT(n,e){return n instanceof Zi?(function(r){return Tp(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Yi=class extends Qi{},Ur=class extends Qi{constructor(e){super(),this.elements=e}};function HT(n,e){let t=qT(e);for(let r of n.elements)t.some(i=>tn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Hr=class extends Qi{constructor(e){super(),this.elements=e}};function $T(n,e){let t=qT(e);for(let r of n.elements)t=t.filter(i=>!tn(i,r));return{arrayValue:{values:t}}}var Zi=class extends Qi{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function kw(n){return Ie(n.integerValue||n.doubleValue)}function qT(n){return Xg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Ex(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Ur&&i instanceof Ur||r instanceof Hr&&i instanceof Hr?Hi(r.elements,i.elements,tn):r instanceof Zi&&i instanceof Zi?tn(r.Ae,i.Ae):r instanceof Yi&&i instanceof Yi})(n.transform,e.transform)}var Op=class{constructor(e,t){this.version=e,this.transformResults=t}},Fr=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function iu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Ji=class{};function zT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new hu(n.key,Fr.none()):new $r(n.key,n.data,Fr.none());{let t=n.data,r=xt.empty(),i=new Ue(ft.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new _n(n.key,r,new Yt(i.toArray()),Fr.none())}}function Ix(n,e,t){n instanceof $r?(function(i,s,o){let c=i.value.clone(),u=Lw(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof _n?(function(i,s,o){if(!iu(i.precondition,s))return void s.convertToUnknownDocument(o.version);let c=Lw(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(GT(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Ao(n,e,t,r){return n instanceof $r?(function(s,o,c,u){if(!iu(s.precondition,o))return c;let l=s.value.clone(),h=Fw(s.fieldTransforms,u,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof _n?(function(s,o,c,u){if(!iu(s.precondition,o))return c;let l=Fw(s.fieldTransforms,u,o),h=o.data;return h.setAll(GT(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))})(n,e,t,r):(function(s,o,c){return iu(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function wx(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=UT(r.transform,i||null);s!=null&&(t===null&&(t=xt.empty()),t.set(r.field,s))}return t||null}function Ow(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Hi(r,i,(s,o)=>Ex(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var $r=class extends Ji{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},_n=class extends Ji{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function GT(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Lw(n,e,t){let r=new Map;le(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,vx(o,c,t[i]))}return r}function Fw(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,_x(s,o,e))}return r}var hu=class extends Ji{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Lp=class extends Ji{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Fp=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&Ix(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ao(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ao(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=BT();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;let u=zT(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),se())}isEqual(e){return this.batchId===e.batchId&&Hi(this.mutations,e.mutations,(t,r)=>Ow(t,r))&&Hi(this.baseMutations,e.baseMutations,(t,r)=>Ow(t,r))}},Vp=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){le(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return hx})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Bp=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var jp=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Re,oe;function Tx(n){switch(n){case A.OK:return V(64938);case A.CANCELLED:case A.UNKNOWN:case A.DEADLINE_EXCEEDED:case A.RESOURCE_EXHAUSTED:case A.INTERNAL:case A.UNAVAILABLE:case A.UNAUTHENTICATED:return!1;case A.INVALID_ARGUMENT:case A.NOT_FOUND:case A.ALREADY_EXISTS:case A.PERMISSION_DENIED:case A.FAILED_PRECONDITION:case A.ABORTED:case A.OUT_OF_RANGE:case A.UNIMPLEMENTED:case A.DATA_LOSS:return!0;default:return V(15467,{code:n})}}function WT(n){if(n===void 0)return hn("GRPC error has no .code"),A.UNKNOWN;switch(n){case Re.OK:return A.OK;case Re.CANCELLED:return A.CANCELLED;case Re.UNKNOWN:return A.UNKNOWN;case Re.DEADLINE_EXCEEDED:return A.DEADLINE_EXCEEDED;case Re.RESOURCE_EXHAUSTED:return A.RESOURCE_EXHAUSTED;case Re.INTERNAL:return A.INTERNAL;case Re.UNAVAILABLE:return A.UNAVAILABLE;case Re.UNAUTHENTICATED:return A.UNAUTHENTICATED;case Re.INVALID_ARGUMENT:return A.INVALID_ARGUMENT;case Re.NOT_FOUND:return A.NOT_FOUND;case Re.ALREADY_EXISTS:return A.ALREADY_EXISTS;case Re.PERMISSION_DENIED:return A.PERMISSION_DENIED;case Re.FAILED_PRECONDITION:return A.FAILED_PRECONDITION;case Re.ABORTED:return A.ABORTED;case Re.OUT_OF_RANGE:return A.OUT_OF_RANGE;case Re.UNIMPLEMENTED:return A.UNIMPLEMENTED;case Re.DATA_LOSS:return A.DATA_LOSS;default:return V(39323,{code:n})}}(oe=Re||(Re={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";var Dx=null;function Cx(){return new TextEncoder}var bx=new dn([4294967295,4294967295],0);function Vw(n){let e=Cx().encode(n),t=new tp;return t.update(e),new Uint8Array(t.digest())}function Bw(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new dn([t,r],0),new dn([i,s],0)]}var Up=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Or(`Invalid padding: ${t}`);if(r<0)throw new Or(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Or(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Or(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=dn.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(dn.fromNumber(r)));return i.compare(bx)===1&&(i=new dn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=Vw(e),[r,i]=Bw(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;let t=Vw(e),[r,i]=Bw(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);this.Se(o)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Or=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var pu=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,ko.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new Se(ie),yn(),se())}},ko=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,se(),se(),se())}};var Vi=class{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}},gu=class{constructor(e,t){this.targetId=e,this.Ce=t}},mu=class{constructor(e,t,r=Je.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},yu=class{constructor(){this.ve=0,this.Fe=jw(),this.Me=Je.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=se(),t=se(),r=se();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:V(38017,{changeType:s})}}),new ko(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=jw()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,le(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},Hp=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=yn(),this.Je=eu(),this.He=eu(),this.Ye=new Se(ie)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:V(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let s=i.target;if(Pp(s))if(r===0){let o=new B(s.path);this.et(t,o,Pt.newNoDocument(o,W.min()))}else le(r===1,20013,{expectedCount:r});else{let o=this._t(t);if(o!==r){let c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,l)}Dx?.lt((function(h,p,m,I,S){let M={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},R=p.unchangedNames;return R&&(M.bloomFilter={applied:S===0,hashCount:R?.hashCount??0,bitmapLength:R?.bits?.bitmap?.length??0,padding:R?.bits?.padding??0,mightContain:F=>I?.mightContain(F)??!1}),M})(o,e.Ce,this.Ge.ht(),c,u))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,c;try{o=gn(r).toUint8Array()}catch(u){if(u instanceof uu)return Ui("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Up(o,i,s)}catch(u){return Ui(u instanceof Or?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.et(t,s,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((s,o)=>{let c=this.ot(o);if(c){if(s.current&&Pp(c.target)){let u=new B(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Pt.newNoDocument(u,e))}s.Be&&(t.set(o,s.ke()),s.qe())}});let r=se();this.He.forEach((s,o)=>{let c=!0;o.forEachWhile(u=>{let l=this.ot(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));let i=new pu(e,t,this.Ye,this.je,r);return this.je=yn(),this.Je=eu(),this.He=eu(),this.Ye=new Se(ie),i}Xe(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new yu,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ue(ie),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ue(ie),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||P("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new yu),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function eu(){return new Se(B.comparator)}function jw(){return new Se(B.comparator)}var Sx={asc:"ASCENDING",desc:"DESCENDING"},Ax={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Nx={and:"AND",or:"OR"},$p=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function qp(n,e){return n.useProto3Json||ju(e)?e:{value:e}}function _u(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function KT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Rx(n,e){return _u(n,e.toTimestamp())}function en(n){return le(!!n,49232),W.fromTimestamp((function(t){let r=pn(t);return new Pe(r.seconds,r.nanos)})(n))}function rm(n,e){return zp(n,e).canonicalString()}function zp(n,e){let t=(function(i){return new Ae(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function QT(n){let e=Ae.fromString(n);return le(eD(e),10190,{key:e.toString()}),e}function Gp(n,e){return rm(n.databaseId,e.path)}function cp(n,e){let t=QT(e);if(t.get(1)!==n.databaseId.projectId)throw new L(A.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(A.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(ZT(t))}function YT(n,e){return rm(n.databaseId,e)}function Mx(n){let e=QT(n);return e.length===4?Ae.emptyPath():ZT(e)}function Wp(n){return new Ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ZT(n){return le(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Uw(n,e,t){return{name:Gp(n,e),fields:t.value.mapValue.fields}}function xx(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:V(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(l,h){return l.useProto3Json?(le(h===void 0||typeof h=="string",58123),Je.fromBase64String(h||"")):(le(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Je.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(l){let h=l.code===void 0?A.UNKNOWN:WT(l.code);return new L(h,l.message||"")})(o);t=new mu(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=cp(n,r.document.name),s=en(r.document.updateTime),o=r.document.createTime?en(r.document.createTime):W.min(),c=new xt({mapValue:{fields:r.document.fields}}),u=Pt.newFoundDocument(i,s,o,c),l=r.targetIds||[],h=r.removedTargetIds||[];t=new Vi(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=cp(n,r.document),s=r.readTime?en(r.readTime):W.min(),o=Pt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Vi([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=cp(n,r.document),s=r.removedTargetIds||[];t=new Vi([],s,i,null)}else{if(!("filter"in e))return V(11601,{Rt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new jp(i,s),c=r.targetId;t=new gu(c,o)}}return t}function Px(n,e){let t;if(e instanceof $r)t={update:Uw(n,e.key,e.value)};else if(e instanceof hu)t={delete:Gp(n,e.key)};else if(e instanceof _n)t={update:Uw(n,e.key,e.data),updateMask:Hx(e.fieldMask)};else{if(!(e instanceof Lp))return V(16599,{Vt:e.type});t={verify:Gp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let c=o.transform;if(c instanceof Yi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ur)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Hr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Zi)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw V(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:Rx(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:V(27497)})(n,e.precondition)),t}function kx(n,e){return n&&n.length>0?(le(e!==void 0,14353),n.map(t=>(function(i,s){let o=i.updateTime?en(i.updateTime):en(s);return o.isEqual(W.min())&&(o=en(s)),new Op(o,i.transformResults||[])})(t,e))):[]}function Ox(n,e){return{documents:[YT(n,e.path)]}}function Lx(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=YT(n,i);let s=(function(l){if(l.length!==0)return XT(nn.create(l,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(l){if(l.length!==0)return l.map(h=>(function(m){return{field:Oi(m.field),direction:Bx(m.dir)}})(h))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=qp(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{ft:t,parent:i}}function Fx(n){let e=Mx(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){le(r===1,65062);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(p){let m=JT(p);return m instanceof nn&&MT(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map(m=>(function(S){return new Wi(Li(S.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(m))})(t.orderBy));let c=null;t.limit&&(c=(function(p){let m;return m=typeof p=="object"?p.value:p,ju(m)?null:m})(t.limit));let u=null;t.startAt&&(u=(function(p){let m=!!p.before,I=p.values||[];return new Gi(I,m)})(t.startAt));let l=null;return t.endAt&&(l=(function(p){let m=!p.before,I=p.values||[];return new Gi(I,m)})(t.endAt)),ax(e,i,o,s,c,"F",u,l)}function Vx(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return V(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function JT(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Li(t.unaryFilter.field);return Oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Li(t.unaryFilter.field);return Oe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Li(t.unaryFilter.field);return Oe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Li(t.unaryFilter.field);return Oe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return V(61313);default:return V(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Oe.create(Li(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return V(58110);default:return V(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return nn.create(t.compositeFilter.filters.map(r=>JT(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return V(1026)}})(t.compositeFilter.op))})(n):V(30097,{filter:n})}function Bx(n){return Sx[n]}function jx(n){return Ax[n]}function Ux(n){return Nx[n]}function Oi(n){return{fieldPath:n.canonicalString()}}function Li(n){return ft.fromServerFormat(n.fieldPath)}function XT(n){return n instanceof Oe?(function(t){if(t.op==="=="){if(Nw(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NAN"}};if(Aw(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Nw(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NOT_NAN"}};if(Aw(t.value))return{unaryFilter:{field:Oi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Oi(t.field),op:jx(t.op),value:t.value}}})(n):n instanceof nn?(function(t){let r=t.getFilters().map(i=>XT(i));return r.length===1?r[0]:{compositeFilter:{op:Ux(t.op),filters:r}}})(n):V(54877,{filter:n})}function Hx(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function eD(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Oo=class n{constructor(e,t,r,i,s=W.min(),o=W.min(),c=Je.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Kp=class{constructor(e){this.yt=e}};function $x(n){let e=Fx({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?kp(e,e.limit,"L"):e}var vu=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ie(e.integerValue));else if("doubleValue"in e){let r=Ie(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Mo(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=pn(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(gn(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?AT(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ST(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):V(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=$i,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ie(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),B.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};vu.Kt=new vu;var Qp=class{constructor(){this.Cn=new Yp}addToCollectionParentIndex(e,t){return this.Cn.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(jr.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(jr.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}},Yp=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ue(Ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ue(Ae.comparator)).toArray()}};var Q6=new Uint8Array(0);var Hw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tD=41943040,It=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};It.DEFAULT_COLLECTION_PERCENTILE=10,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,It.DEFAULT=new It(tD,It.DEFAULT_COLLECTION_PERCENTILE,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),It.DISABLED=new It(-1,0,0);var Lo=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var $w="LruGarbageCollector",qx=1048576;function qw([n,e],[t,r]){let i=ie(n,t);return i===0?ie(e,r):i}var Zp=class{constructor(e){this.Ir=e,this.buffer=new Ue(qw),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();qw(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Jp=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){P($w,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ns(t)?P($w,"Ignoring IndexedDB error during garbage collection: ",t):await ts(t)}await this.Vr(3e5)})}},Xp=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return N.resolve(Kg.ce);let r=new Zp(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(P("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(Hw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(P("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hw):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,o,c,u,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(P("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,c=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Pi()<=ne.DEBUG&&P("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function zx(n,e){return new Xp(n,e)}var eg=class{constructor(){this.changes=new mn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Pt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var tg=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var ng=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ao(r.mutation,i,Yt.empty(),Pe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,se()).next(()=>r))}getLocalViewOfDocuments(e,t,r=se()){let i=kr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Do();return s.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=kr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,se()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,r,i){let s=yn(),o=So(),c=(function(){return So()})();return t.forEach((u,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof _n)?s=s.insert(l.key,l):h!==void 0?(o.set(l.key,h.mutation.getFieldMask()),Ao(h.mutation,l,h.mutation.getFieldMask(),Pe.now())):o.set(l.key,Yt.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,h)=>o.set(l,h)),t.forEach((l,h)=>c.set(l,new tg(h,o.get(l)??null))),c))}recalculateAndSaveOverlays(e,t){let r=So(),i=new Se((o,c)=>o-c),s=se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let h=r.get(u)||Yt.empty();h=c.applyToLocalView(l,h),r.set(u,h);let p=(i.get(c.batchId)||se()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{let o=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),l=u.key,h=u.value,p=BT();h.forEach(m=>{if(!s.has(m)){let I=zT(t.get(m),r.get(m));I!==null&&p.set(m,I),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return B.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):N.resolve(kr()),c=Ro,u=s;return o.next(l=>N.forEach(l,(h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),s.get(h)?N.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,se())).next(h=>({batchId:c,changes:VT(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=Do();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Do();return this.indexManager.getCollectionParents(e,s).next(c=>N.forEach(c,u=>{let l=(function(p,m){return new Ki(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((u,l)=>{let h=l.getKey();o.get(h)===null&&(o=o.insert(h,Pt.newInvalidDocument(h)))});let c=Do();return o.forEach((u,l)=>{let h=s.get(u);h!==void 0&&Ao(h.mutation,l,Yt.empty(),Pe.now()),qu(t,l)&&(c=c.insert(u,l))}),c})}};var rg=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return N.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:en(i.createTime)}})(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:$x(i.bundledQuery),readTime:en(i.readTime)}})(t)),N.resolve()}};var ig=class{constructor(){this.overlays=new Se(B.comparator),this.qr=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){let r=kr();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),N.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){let i=kr(),s=t.length+1,o=new B(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let u=c.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return N.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Se((l,h)=>l-h),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=s.get(l.largestBatchId);h===null&&(h=kr(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let c=kr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,h)=>c.set(l,h)),!(c.size()>=i)););return N.resolve(c)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Bp(t,r));let s=this.qr.get(t);s===void 0&&(s=se(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}};var sg=class{constructor(){this.sessionToken=Je.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}};var Fo=class{constructor(){this.Qr=new Ue(Me.$r),this.Ur=new Ue(Me.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new Me(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new Me(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){let t=new B(new Ae([])),r=new Me(t,e),i=new Me(t,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new B(new Ae([])),r=new Me(t,e),i=new Me(t,e+1),s=se();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Me(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Me=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return B.comparator(e.key,t.key)||ie(e.Yr,t.Yr)}static Kr(e,t){return ie(e.Yr,t.Yr)||B.comparator(e.key,t.key)}};var og=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ue(Me.$r)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Fp(s,t,r,i);this.mutationQueue.push(o);for(let c of i)this.Zr=this.Zr.add(new Me(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,t){return N.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?Qg:this.tr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Me(t,0),i=new Me(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{let c=this.Xr(o.Yr);s.push(c)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ue(ie);return t.forEach(i=>{let s=new Me(i,0),o=new Me(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],c=>{r=r.add(c.Yr)})}),N.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;B.isDocumentKey(s)||(s=s.child(""));let o=new Me(new B(s),0),c=new Ue(ie);return this.Zr.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(c=c.add(u.Yr)),!0)},o),N.resolve(this.ti(c))}ti(e){let t=[];return e.forEach(r=>{let i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){le(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return N.forEach(t.mutations,i=>{let s=new Me(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new Me(t,0),i=this.Zr.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ag=class{constructor(e){this.ri=e,this.docs=(function(){return new Se(B.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():Pt.newInvalidDocument(t))}getEntries(e,t){let r=yn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Pt.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=yn(),o=t.path,c=new B(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:l,value:{document:h}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||HM(UM(h),r)<=0||(i.has(h.key)||qu(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,t,r,i){V(9500)}ii(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new cg(this)}getSize(e){return N.resolve(this.size)}},cg=class extends eg{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var ug=class{constructor(e){this.persistence=e,this.si=new mn(t=>em(t),tm),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.oi=0,this._i=new Fo,this.targetCount=0,this.ai=Lo.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),N.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new Lo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Pr(t),N.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),N.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this._i.containsKey(t))}};var Eu=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new Kg(0),this.li=!1,this.li=!0,this.hi=new sg,this.referenceDelegate=e(this),this.Pi=new ug(this),this.indexManager=new Qp,this.remoteDocumentCache=(function(i){return new ag(i)})(r=>this.referenceDelegate.Ti(r)),this.serializer=new Kp(t),this.Ii=new rg(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ig,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new og(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){P("MemoryPersistence","Starting transaction:",e);let i=new lg(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return N.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}},lg=class extends Ep{constructor(e){super(),this.currentSequenceNumber=e}},dg=class n{constructor(e){this.persistence=e,this.Ri=new Fo,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw V(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),N.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.fi,r=>{let i=B.fromPath(r);return this.gi(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return N.or([()=>N.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},Iu=class n{constructor(e,t){this.persistence=e,this.pi=new mn(r=>GM(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=zx(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return N.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return N.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?N.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,t).next(c=>{c||(r++,s.removeEntry(o,W.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),N.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),N.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),N.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),N.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=nu(e.data.value)),t}br(e,t,r){return N.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return N.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var fg=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=se(),i=se();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var hg=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var pg=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return JI()?8:qM(Be())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ys(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new hg;return this.Ss(e,t,o).next(c=>{if(s.result=c,this.Vs)return this.bs(e,t,o,c.size)})}).next(()=>s.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(Pi()<=ne.DEBUG&&P("QueryEngine","SDK will not create cache indexes for query:",ki(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),N.resolve()):(Pi()<=ne.DEBUG&&P("QueryEngine","Query:",ki(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Pi()<=ne.DEBUG&&P("QueryEngine","The SDK decides to create cache indexes for query:",ki(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xt(t))):N.resolve())}ys(e,t){if(Pw(t))return N.resolve(null);let r=Xt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=kp(t,null,"F"),r=Xt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=se(...s);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.Ds(t,c);return this.Cs(t,l,o,u.readTime)?this.ys(e,kp(t,null,"F")):this.vs(e,l,t,u)}))})))}ws(e,t,r,i){return Pw(t)||i.isEqual(W.min())?N.resolve(null):this.ps.getDocuments(e,r).next(s=>{let o=this.Ds(t,s);return this.Cs(t,o,r,i)?N.resolve(null):(Pi()<=ne.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ki(t)),this.vs(e,o,t,jM(i,Ro)).next(c=>c))})}Ds(e,t){let r=new Ue(LT(e));return t.forEach((i,s)=>{qu(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Pi()<=ne.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",ki(t)),this.ps.getDocumentsMatchingQuery(e,t,jr.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var im="LocalStore",Gx=3e8,gg=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Se(ie),this.xs=new mn(s=>em(s),tm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ng(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function Wx(n,e,t,r){return new gg(n,e,t,r)}async function nD(n,e){let t=z(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],c=[],u=se();for(let l of i){o.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}for(let l of s){c.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next(l=>({Ls:l,removedBatchIds:o,addedBatchIds:c}))})})}function Kx(n,e){let t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,l,h){let p=l.batch,m=p.keys(),I=N.resolve();return m.forEach(S=>{I=I.next(()=>h.getEntry(u,S)).next(M=>{let R=l.docVersions.get(S);le(R!==null,48541),M.version.compareTo(R)<0&&(p.applyToRemoteDocument(M,l),M.isValidDocument()&&(M.setReadTime(l.commitVersion),h.addEntry(M)))})}),I.next(()=>c.mutationQueue.removeMutationBatch(u,p))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=se();for(let l=0;l<c.mutationResults.length;++l)c.mutationResults[l].transformResults.length>0&&(u=u.add(c.batch.mutations[l].key));return u})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function rD(n){let e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function Qx(n,e){let t=z(n),r=e.snapshotVersion,i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;let c=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;c.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,p).next(()=>t.Pi.addMatchingKeys(s,h.addedDocuments,p)));let I=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?I=I.withResumeToken(Je.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):h.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(h.resumeToken,r)),i=i.insert(p,I),(function(M,R,F){return M.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=Gx?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(m,I,h)&&c.push(t.Pi.updateTargetData(s,I))});let u=yn(),l=se();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),c.push(Yx(s,o,e.documentUpdates).next(h=>{u=h.ks,l=h.qs})),!r.isEqual(W.min())){let h=t.Pi.getLastRemoteSnapshotVersion(s).next(p=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(h)}return N.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(t.Ms=i,s))}function Yx(n,e,t){let r=se(),i=se();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=yn();return t.forEach((c,u)=>{let l=s.get(c);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(W.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):P(im,"Ignoring outdated watch update for ",c,". Current version:",l.version," Watch version:",u.version)}),{ks:o,qs:i}})}function Zx(n,e){let t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Qg),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Jx(n,e){let t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):t.Pi.allocateTargetId(r).next(o=>(i=new Oo(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function mg(n,e,t){let r=z(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ns(o))throw o;P(im,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function zw(n,e,t){let r=z(n),i=W.min(),s=se();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(u,l,h){let p=z(u),m=p.xs.get(h);return m!==void 0?N.resolve(p.Ms.get(m)):p.Pi.getTargetData(l,h)})(r,o,Xt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{s=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:W.min(),t?s:se())).next(c=>(Xx(r,lx(e),c),{documents:c,Qs:s})))}function Xx(n,e,t){let r=n.Os.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Os.set(e,r)}var wu=class{constructor(){this.activeTargetIds=mx()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var yg=class{constructor(){this.Mo=new wu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new wu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var _g=class{Oo(e){}shutdown(){}};var Gw="ConnectivityMonitor",Tu=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){P(Gw,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){P(Gw,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var tu=null;function vg(){return tu===null?tu=(function(){return 268435456+Math.round(2147483648*Math.random())})():tu++,"0x"+tu.toString(16)}var up="RestConnection",eP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Eg=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===lu?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){let o=vg(),c=this.zo(e,t.toUriEncodedString());P(up,`Sending RPC '${e}' ${o}:`,c,r);let u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,s);let{host:l}=new URL(c),h=Hn(l);return this.Jo(e,c,u,r,h).then(p=>(P(up,`Received RPC '${e}' ${o}: `,p),p),p=>{throw Ui(up,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p})}Ho(e,t,r,i,s,o){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+es})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,t){let r=eP[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var Ig=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var Ye="WebChannelConnection",wg=class extends Eg{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){let o=vg();return new Promise((c,u)=>{let l=new np;l.setWithCredentials(!0),l.listenOnce(rp.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case To.NO_ERROR:let p=l.getResponseJson();P(Ye,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case To.TIMEOUT:P(Ye,`RPC '${e}' ${o} timed out`),u(new L(A.DEADLINE_EXCEEDED,"Request time out"));break;case To.HTTP_ERROR:let m=l.getStatus();if(P(Ye,`RPC '${e}' ${o} failed with status:`,m,"response text:",l.getResponseText()),m>0){let I=l.getResponseJson();Array.isArray(I)&&(I=I[0]);let S=I?.error;if(S&&S.status&&S.message){let M=(function(F){let Z=F.toLowerCase().replace(/_/g,"-");return Object.values(A).indexOf(Z)>=0?Z:A.UNKNOWN})(S.status);u(new L(M,S.message))}else u(new L(A.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new L(A.UNAVAILABLE,"Connection failed."));break;default:V(9055,{l_:e,streamId:o,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{P(Ye,`RPC '${e}' ${o} completed.`)}});let h=JSON.stringify(i);P(Ye,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",h,r,15)})}T_(e,t,r){let i=vg(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=op(),c=sp(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let h=s.join("");P(Ye,`Creating RPC '${e}' stream ${i}: ${h}`,u);let p=o.createWebChannel(h,u);this.I_(p);let m=!1,I=!1,S=new Ig({Yo:R=>{I?P(Ye,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(m||(P(Ye,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),P(Ye,`RPC '${e}' stream ${i} sending:`,R),p.send(R))},Zo:()=>p.close()}),M=(R,F,Z)=>{R.listen(F,re=>{try{Z(re)}catch(K){setTimeout(()=>{throw K},0)}})};return M(p,xi.EventType.OPEN,()=>{I||(P(Ye,`RPC '${e}' stream ${i} transport opened.`),S.o_())}),M(p,xi.EventType.CLOSE,()=>{I||(I=!0,P(Ye,`RPC '${e}' stream ${i} transport closed`),S.a_(),this.E_(p))}),M(p,xi.EventType.ERROR,R=>{I||(I=!0,Ui(Ye,`RPC '${e}' stream ${i} transport errored. Name:`,R.name,"Message:",R.message),S.a_(new L(A.UNAVAILABLE,"The operation could not be completed")))}),M(p,xi.EventType.MESSAGE,R=>{if(!I){let F=R.data[0];le(!!F,16349);let Z=F,re=Z?.error||Z[0]?.error;if(re){P(Ye,`RPC '${e}' stream ${i} received error:`,re);let K=re.status,ae=(function(y){let _=Re[y];if(_!==void 0)return WT(_)})(K),k=re.message;ae===void 0&&(ae=A.INTERNAL,k="Unknown error status: "+K+" with message "+re.message),I=!0,S.a_(new L(ae,k)),p.close()}else P(Ye,`RPC '${e}' stream ${i} received:`,F),S.u_(F)}}),M(c,ip.STAT_EVENT,R=>{R.stat===Jc.PROXY?P(Ye,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Jc.NOPROXY&&P(Ye,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.__()},0),S}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function lp(){return typeof document<"u"?document:null}function zu(n){return new $p(n,!0)}var Du=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&P("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var Ww="PersistentStream",Cu=class{constructor(e,t,r,i,s,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Du(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===A.RESOURCE_EXHAUSTED?(hn(t.toString()),hn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===A.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new L(A.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return P(Ww,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(P(Ww,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Tg=class extends Cu{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=xx(this.serializer,e),r=(function(s){if(!("targetChange"in s))return W.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?en(o.readTime):W.min()})(e);return this.listener.H_(t,r)}Y_(e){let t={};t.database=Wp(this.serializer),t.addTarget=(function(s,o){let c,u=o.target;if(c=Pp(u)?{documents:Ox(s,u)}:{query:Lx(s,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=KT(s,o.resumeToken);let l=qp(s,o.expectedCount);l!==null&&(c.expectedCount=l)}else if(o.snapshotVersion.compareTo(W.min())>0){c.readTime=_u(s,o.snapshotVersion.toTimestamp());let l=qp(s,o.expectedCount);l!==null&&(c.expectedCount=l)}return c})(this.serializer,e);let r=Vx(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){let t={};t.database=Wp(this.serializer),t.removeTarget=e,this.q_(t)}},Dg=class extends Cu{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return le(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,le(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){le(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=kx(e.writeResults,e.commitTime),r=en(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=Wp(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Px(this.serializer,r))};this.q_(t)}};var Cg=class{},bg=class extends Cg{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new L(A.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,zp(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(A.UNKNOWN,s.toString())})}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,zp(t,r),i,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===A.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(A.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},Sg=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(hn(t),this.aa=!1):P("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var qr="RemoteStore",Ag=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Wr(this)&&(P(qr,"Restarting streams for network reachability change."),await(async function(u){let l=z(u);l.Ea.add(4),await Ho(l),l.Ra.set("Unknown"),l.Ea.delete(4),await Gu(l)})(this))})}),this.Ra=new Sg(r,i)}};async function Gu(n){if(Wr(n))for(let e of n.da)await e(!0)}async function Ho(n){for(let e of n.da)await e(!1)}function iD(n,e){let t=z(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),cm(t)?am(t):rs(t).O_()&&om(t,e))}function sm(n,e){let t=z(n),r=rs(t);t.Ia.delete(e),r.O_()&&sD(t,e),t.Ia.size===0&&(r.O_()?r.L_():Wr(t)&&t.Ra.set("Unknown"))}function om(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rs(n).Y_(e)}function sD(n,e){n.Va.Ue(e),rs(n).Z_(e)}function am(n){n.Va=new Hp({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),rs(n).start(),n.Ra.ua()}function cm(n){return Wr(n)&&!rs(n).x_()&&n.Ia.size>0}function Wr(n){return z(n).Ea.size===0}function oD(n){n.Va=void 0}async function tP(n){n.Ra.set("Online")}async function nP(n){n.Ia.forEach((e,t)=>{om(n,e)})}async function rP(n,e){oD(n),cm(n)?(n.Ra.ha(e),am(n)):n.Ra.set("Unknown")}async function iP(n,e,t){if(n.Ra.set("Online"),e instanceof mu&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let c of s.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){P(qr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await bu(n,r)}else if(e instanceof Vi?n.Va.Ze(e):e instanceof gu?n.Va.st(e):n.Va.tt(e),!t.isEqual(W.min()))try{let r=await rD(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let c=s.Va.Tt(o);return c.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let h=s.Ia.get(l);h&&s.Ia.set(l,h.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,l)=>{let h=s.Ia.get(u);if(!h)return;s.Ia.set(u,h.withResumeToken(Je.EMPTY_BYTE_STRING,h.snapshotVersion)),sD(s,u);let p=new Oo(h.target,u,l,h.sequenceNumber);om(s,p)}),s.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){P(qr,"Failed to raise snapshot:",r),await bu(n,r)}}async function bu(n,e,t){if(!ns(e))throw e;n.Ea.add(1),await Ho(n),n.Ra.set("Offline"),t||(t=()=>rD(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{P(qr,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Gu(n)})}function aD(n,e){return e().catch(t=>bu(n,t,e))}async function Wu(n){let e=z(n),t=Jn(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qg;for(;sP(e);)try{let i=await Zx(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,oP(e,i)}catch(i){await bu(e,i)}cD(e)&&uD(e)}function sP(n){return Wr(n)&&n.Ta.length<10}function oP(n,e){n.Ta.push(e);let t=Jn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function cD(n){return Wr(n)&&!Jn(n).x_()&&n.Ta.length>0}function uD(n){Jn(n).start()}async function aP(n){Jn(n).ra()}async function cP(n){let e=Jn(n);for(let t of n.Ta)e.ea(t.mutations)}async function uP(n,e,t){let r=n.Ta.shift(),i=Vp.from(r,e,t);await aD(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Wu(n)}async function lP(n,e){e&&Jn(n).X_&&await(async function(r,i){if((function(o){return Tx(o)&&o!==A.ABORTED})(i.code)){let s=r.Ta.shift();Jn(r).B_(),await aD(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Wu(r)}})(n,e),cD(n)&&uD(n)}async function Kw(n,e){let t=z(n);t.asyncQueue.verifyOperationInProgress(),P(qr,"RemoteStore received new credentials");let r=Wr(t);t.Ea.add(3),await Ho(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Gu(t)}async function dP(n,e){let t=z(n);e?(t.Ea.delete(2),await Gu(t)):e||(t.Ea.add(2),await Ho(t),t.Ra.set("Unknown"))}function rs(n){return n.ma||(n.ma=(function(t,r,i){let s=z(t);return s.sa(),new Tg(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:tP.bind(null,n),t_:nP.bind(null,n),r_:rP.bind(null,n),H_:iP.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),cm(n)?am(n):n.Ra.set("Unknown")):(await n.ma.stop(),oD(n))})),n.ma}function Jn(n){return n.fa||(n.fa=(function(t,r,i){let s=z(t);return s.sa(),new Dg(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:aP.bind(null,n),r_:lP.bind(null,n),ta:cP.bind(null,n),na:uP.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Wu(n)):(await n.fa.stop(),n.Ta.length>0&&(P(qr,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var Ng=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Zt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,c=new n(e,t,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(A.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function um(n,e){if(hn("AsyncQueue",`${e}: ${n}`),ns(n))return new L(A.UNAVAILABLE,`${e}: ${n}`);throw n}var Su=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=Do(),this.sortedSet=new Se(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Au=class{constructor(){this.ga=new Se(B.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):V(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},Xi=class n{constructor(e,t,r,i,s,o,c,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,Su.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$u(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Rg=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}},Mg=class{constructor(){this.queries=Qw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=z(t),s=i.queries;i.queries=Qw(),s.forEach((o,c)=>{for(let u of c.Sa)u.onError(r)})})(this,new L(A.ABORTED,"Firestore shutting down"))}};function Qw(){return new mn(n=>OT(n),$u)}async function lD(n,e){let t=z(n),r=3,i=e.query,s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new Rg,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let c=um(o,`Initialization of query '${ki(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&lm(t)}async function dD(n,e){let t=z(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function fP(n,e){let t=z(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&lm(t)}function hP(n,e,t){let r=z(n),i=r.queries.get(e);if(i)for(let s of i.Sa)s.onError(t);r.queries.delete(e)}function lm(n){n.Ca.forEach(e=>{e.next()})}var xg,Yw;(Yw=xg||(xg={})).Ma="default",Yw.Cache="cache";var Nu=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Xi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Xi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xg.Cache}};var Ru=class{constructor(e){this.key=e}},Mu=class{constructor(e){this.key=e}},Pg=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=se(),this.mutatedKeys=se(),this.eu=LT(e),this.tu=new Su(this.eu)}get nu(){return this.Ya}ru(e,t){let r=t?t.iu:new Au,i=t?t.tu:this.tu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),I=qu(this.query,p)?p:null,S=!!m&&this.mutatedKeys.has(m.key),M=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations),R=!1;m&&I?m.data.isEqual(I.data)?S!==M&&(r.track({type:3,doc:I}),R=!0):this.su(m,I)||(r.track({type:2,doc:I}),R=!0,(u&&this.eu(I,u)>0||l&&this.eu(I,l)<0)&&(c=!0)):!m&&I?(r.track({type:0,doc:I}),R=!0):m&&!I&&(r.track({type:1,doc:m}),R=!0,(u||l)&&(c=!0)),R&&(I?(o=o.add(I),s=M?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let o=e.iu.ya();o.sort((h,p)=>(function(I,S){let M=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return V(20277,{Rt:R})}};return M(I)-M(S)})(h.type,p.type)||this.eu(h.doc,p.doc)),this.ou(r),i=i??!1;let c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,l=u!==this.Za;return this.Za=u,o.length!==0||l?{snapshot:new Xi(this.query,e.tu,s,o,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Au,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=se(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});let t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new Mu(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new Ru(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=se();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Xi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},dm="SyncEngine",kg=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Og=class{constructor(e){this.key=e,this.hu=!1}},Lg=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new mn(c=>OT(c),$u),this.Iu=new Map,this.Eu=new Set,this.du=new Se(B.comparator),this.Au=new Map,this.Ru=new Fo,this.Vu={},this.mu=new Map,this.fu=Lo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function pP(n,e,t=!0){let r=yD(n),i,s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await fD(r,e,t,!0),i}async function gP(n,e){let t=yD(n);await fD(t,e,!0,!1)}async function fD(n,e,t,r){let i=await Jx(n.localStore,Xt(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=await mP(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&iD(n.remoteStore,i),c}async function mP(n,e,t,r,i){n.pu=(p,m,I)=>(async function(M,R,F,Z){let re=R.view.ru(F);re.Cs&&(re=await zw(M.localStore,R.query,!1).then(({documents:E})=>R.view.ru(E,re)));let K=Z&&Z.targetChanges.get(R.targetId),ae=Z&&Z.targetMismatches.get(R.targetId)!=null,k=R.view.applyChanges(re,M.isPrimaryClient,K,ae);return Jw(M,R.targetId,k.au),k.snapshot})(n,p,m,I);let s=await zw(n.localStore,e,!0),o=new Pg(e,s.Qs),c=o.ru(s.documents),u=ko.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(c,n.isPrimaryClient,u);Jw(n,t,l.au);let h=new kg(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),l.snapshot}async function yP(n,e,t){let r=z(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!$u(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await mg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&sm(r.remoteStore,i.targetId),Fg(r,i.targetId)}).catch(ts)):(Fg(r,i.targetId),await mg(r.localStore,i.targetId,!0))}async function _P(n,e){let t=z(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),sm(t.remoteStore,r.targetId))}async function vP(n,e,t){let r=bP(n);try{let i=await(function(o,c){let u=z(o),l=Pe.now(),h=c.reduce((I,S)=>I.add(S.key),se()),p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let S=yn(),M=se();return u.Ns.getEntries(I,h).next(R=>{S=R,S.forEach((F,Z)=>{Z.isValidDocument()||(M=M.add(F))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,S)).next(R=>{p=R;let F=[];for(let Z of c){let re=wx(Z,p.get(Z.key).overlayedDocument);re!=null&&F.push(new _n(Z.key,re,NT(re.value.mapValue),Fr.exists(!0)))}return u.mutationQueue.addMutationBatch(I,l,F,c)}).next(R=>{m=R;let F=R.applyToLocalDocumentSet(p,M);return u.documentOverlayCache.saveOverlays(I,R.batchId,F)})}).then(()=>({batchId:m.batchId,changes:VT(p)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let l=o.Vu[o.currentUser.toKey()];l||(l=new Se(ie)),l=l.insert(c,u),o.Vu[o.currentUser.toKey()]=l})(r,i.batchId,t),await $o(r,i.changes),await Wu(r.remoteStore)}catch(i){let s=um(i,"Failed to persist write");t.reject(s)}}async function hD(n,e){let t=z(n);try{let r=await Qx(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Au.get(s);o&&(le(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?le(o.hu,14607):i.removedDocuments.size>0&&(le(o.hu,42227),o.hu=!1))}),await $o(t,r,e)}catch(r){await ts(r)}}function Zw(n,e,t){let r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((s,o)=>{let c=o.view.va(e);c.snapshot&&i.push(c.snapshot)}),(function(o,c){let u=z(o);u.onlineState=c;let l=!1;u.queries.forEach((h,p)=>{for(let m of p.Sa)m.va(c)&&(l=!0)}),l&&lm(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function EP(n,e,t){let r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),s=i&&i.key;if(s){let o=new Se(B.comparator);o=o.insert(s,Pt.newNoDocument(s,W.min()));let c=se().add(s),u=new pu(W.min(),new Map,new Se(ie),o,c);await hD(r,u),r.du=r.du.remove(s),r.Au.delete(e),fm(r)}else await mg(r.localStore,e,!1).then(()=>Fg(r,e,t)).catch(ts)}async function IP(n,e){let t=z(n),r=e.batch.batchId;try{let i=await Kx(t.localStore,e);gD(t,r,null),pD(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await $o(t,i)}catch(i){await ts(i)}}async function wP(n,e,t){let r=z(n);try{let i=await(function(o,c){let u=z(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return u.mutationQueue.lookupMutationBatch(l,c).next(p=>(le(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,h,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>u.localDocuments.getDocuments(l,h))})})(r.localStore,e);gD(r,e,t),pD(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await $o(r,i)}catch(i){await ts(i)}}function pD(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function gD(n,e,t){let r=z(n),i=r.Vu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Fg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||mD(n,r)})}function mD(n,e){n.Eu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(sm(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),fm(n))}function Jw(n,e,t){for(let r of t)r instanceof Ru?(n.Ru.addReference(r.key,e),TP(n,r)):r instanceof Mu?(P(dm,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||mD(n,r.key)):V(19791,{wu:r})}function TP(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(P(dm,"New document in limbo: "+t),n.Eu.add(r),fm(n))}function fm(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new B(Ae.fromString(e)),r=n.fu.next();n.Au.set(r,new Og(t)),n.du=n.du.insert(t,r),iD(n.remoteStore,new Oo(Xt(Hu(t.path)),r,"TargetPurposeLimboResolution",Kg.ce))}}async function $o(n,e,t){let r=z(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{o.push(r.pu(u,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let h=l?!l.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(l){i.push(l);let h=fg.As(u.targetId,l);s.push(h)}}))}),await Promise.all(o),r.Pu.H_(i),await(async function(u,l){let h=z(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>N.forEach(l,m=>N.forEach(m.Es,I=>h.persistence.referenceDelegate.addReference(p,m.targetId,I)).next(()=>N.forEach(m.ds,I=>h.persistence.referenceDelegate.removeReference(p,m.targetId,I)))))}catch(p){if(!ns(p))throw p;P(im,"Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let I=h.Ms.get(m),S=I.snapshotVersion,M=I.withLastLimboFreeSnapshotVersion(S);h.Ms=h.Ms.insert(m,M)}}})(r.localStore,s))}async function DP(n,e){let t=z(n);if(!t.currentUser.isEqual(e)){P(dm,"User change. New user:",e.toKey());let r=await nD(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach(c=>{c.forEach(u=>{u.reject(new L(A.CANCELLED,o))})}),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $o(t,r.Ls)}}function CP(n,e){let t=z(n),r=t.Au.get(e);if(r&&r.hu)return se().add(r.key);{let i=se(),s=t.Iu.get(e);if(!s)return i;for(let o of s){let c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function yD(n){let e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EP.bind(null,e),e.Pu.H_=fP.bind(null,e.eventManager),e.Pu.yu=hP.bind(null,e.eventManager),e}function bP(n){let e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wP.bind(null,e),e}var _D=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=zu(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return Wx(this.persistence,new pg,t.initialUser,this.serializer)}Cu(t){return new Eu(dg.mi,this.serializer)}Du(t){return new yg}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Vg=class extends _D{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){le(this.persistence.referenceDelegate instanceof Iu,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Jp(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?It.withCacheSize(this.cacheSizeBytes):It.DEFAULT;return new Eu(r=>Iu.mi(r,t),this.serializer)}};var SP=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Zw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=DP.bind(null,this.syncEngine),await dP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Mg})()}createDatastore(t){let r=zu(t.databaseInfo.databaseId),i=(function(o){return new wg(o)})(t.databaseInfo);return(function(o,c,u,l){return new bg(o,c,u,l)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,c,u){return new Ag(i,s,o,c,u)})(this.localStore,this.datastore,t.asyncQueue,r=>Zw(this.syncEngine,r,0),(function(){return Tu.v()?new Tu:new _g})())}createSyncEngine(t,r){return(function(s,o,c,u,l,h,p){let m=new Lg(s,o,c,u,l,h);return p&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=z(r);P(qr,"RemoteStore shutting down."),i.Ea.add(5),await Ho(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var xu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):hn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Xn="FirestoreClient",Bg=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=je.UNAUTHENTICATED,this.clientId=No.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{P(Xn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(P(Xn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Zt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=um(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function dp(n,e){n.asyncQueue.verifyOperationInProgress(),P(Xn,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await nD(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Xw(n,e){n.asyncQueue.verifyOperationInProgress();let t=await AP(n);P(Xn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Kw(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Kw(e.remoteStore,i)),n._onlineComponents=e}async function AP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){P(Xn,"Using user provided OfflineComponentProvider");try{await dp(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===A.FAILED_PRECONDITION||i.code===A.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Ui("Error using user provided cache. Falling back to memory cache: "+t),await dp(n,new _D)}}else P(Xn,"Using default OfflineComponentProvider"),await dp(n,new Vg(void 0));return n._offlineComponents}async function vD(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(P(Xn,"Using user provided OnlineComponentProvider"),await Xw(n,n._uninitializedComponentsProvider._online)):(P(Xn,"Using default OnlineComponentProvider"),await Xw(n,new SP))),n._onlineComponents}function NP(n){return vD(n).then(e=>e.syncEngine)}async function jg(n){let e=await vD(n),t=e.eventManager;return t.onListen=pP.bind(null,e.syncEngine),t.onUnlisten=yP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=gP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_P.bind(null,e.syncEngine),t}function RP(n,e,t={}){let r=new Zt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,c,u,l){let h=new xu({next:m=>{h.Nu(),o.enqueueAndForget(()=>dD(s,p));let I=m.docs.has(c);!I&&m.fromCache?l.reject(new L(A.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&m.fromCache&&u&&u.source==="server"?l.reject(new L(A.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Nu(Hu(c.path),h,{includeMetadataChanges:!0,qa:!0});return lD(s,p)})(await jg(n),n.asyncQueue,e,t,r)),r.promise}function ED(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var eT=new Map;var ID="firestore.googleapis.com",tT=!0,Pu=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new L(A.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ID,this.ssl=tT}else this.host=e.host,this.ssl=e.ssl??tT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qx)throw new L(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ED(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new L(A.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new L(A.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new L(A.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Vo=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Pu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(A.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(A.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Pu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new fp;switch(r.type){case"firstParty":return new mp(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(A.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=eT.get(t);r&&(P("ComponentProvider","Removing Datastore"),eT.delete(t),r.terminate())})(this),Promise.resolve()}};function MP(n,e,t,r={}){n=Wn(n,Vo);let i=Hn(e),s=n._getSettings(),o=_e(j({},s),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;i&&(zc(`https://${c}`),Gc("Firestore",!0)),s.host!==ID&&s.host!==c&&Ui("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u=_e(j({},s),{host:c,ssl:i,emulatorOptions:r});if(!Kt(u,o)&&(n._setSettings(u),r.mockUserToken)){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=je.MOCK_USER;else{l=GI(r.mockUserToken,n._app?.options.projectId);let p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new L(A.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new je(p)}n._authCredentials=new hp(new su(l,h))}}var ku=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ze=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Uo(t,n._jsonSchema))return new n(e,r||null,new B(Ae.fromString(t.referencePath)))}};Ze._jsonSchemaVersion="firestore/documentReference/1.0",Ze._jsonSchema={type:xe("string",Ze._jsonSchemaVersion),referencePath:xe("string")};var Bo=class n extends ku{constructor(e,t,r){super(e,t,Hu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function is(n,e,...t){if(n=Qe(n),arguments.length===1&&(e=No.newId()),VM("doc","path",e),n instanceof Vo){let r=Ae.fromString(e,...t);return Iw(r),new Ze(n,null,new B(r))}{if(!(n instanceof Ze||n instanceof Bo))throw new L(A.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ae.fromString(e,...t));return Iw(r),new Ze(n.firestore,n instanceof Bo?n.converter:null,new B(r))}}var nT="AsyncQueue",Ou=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Du(this,"async_queue_retry"),this._c=()=>{let r=lp();r&&P(nT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=lp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=lp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Zt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ns(e))throw e;P(nT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,hn("INTERNAL UNHANDLED ERROR: ",rT(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=Ng.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&V(47125,{Pc:rT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function rT(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function iT(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var zr=class extends Vo{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Ou,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ou(e),this._firestoreClient=void 0,await e}}};function wD(n,e){let t=typeof n=="object"?n:Yc(),r=typeof n=="string"?n:e||lu,i=wo(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=zI("firestore");s&&MP(i,...s)}return i}function hm(n){if(n._terminated)throw new L(A.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||xP(n),n._firestoreClient}function xP(n){let e=n._freezeSettings(),t=(function(i,s,o,c){return new Ip(i,s,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,ED(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Bg(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}var Kn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Je.fromBase64String(e))}catch(t){throw new L(A.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Uo(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Kn._jsonSchemaVersion="firestore/bytes/1.0",Kn._jsonSchema={type:xe("string",Kn._jsonSchemaVersion),bytes:xe("string")};var jo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(A.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ft(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Lu=class{constructor(e){this._methodName=e}};var Qn=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(A.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(A.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ie(this._lat,e._lat)||ie(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Uo(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Qn._jsonSchemaVersion="firestore/geoPoint/1.0",Qn._jsonSchema={type:xe("string",Qn._jsonSchemaVersion),latitude:xe("number"),longitude:xe("number")};var Yn=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Uo(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new L(A.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Yn._jsonSchemaVersion="firestore/vectorValue/1.0",Yn._jsonSchema={type:xe("string",Yn._jsonSchemaVersion),vectorValues:xe("object")};var PP=/^__.*__$/,Ug=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new _n(e,this.data,this.fieldMask,t,this.fieldTransforms):new $r(e,this.data,t,this.fieldTransforms)}};function TD(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw V(40011,{Ac:n})}}var Hg=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n(j(j({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(TD(this.Ac)&&PP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},$g=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||zu(e)}Cc(e,t,r,i=!1){return new Hg({Ac:e,methodName:t,Dc:r,path:ft.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function kP(n){let e=n._freezeSettings(),t=zu(n._databaseId);return new $g(n._databaseId,!!e.ignoreUndefinedProperties,t)}function OP(n,e,t,r,i,s={}){let o=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);SD("Data must be an object, but it was:",o,r);let c=CD(r,o),u,l;if(s.merge)u=new Yt(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let h=[];for(let p of s.mergeFields){let m=LP(e,p,t);if(!o.contains(m))throw new L(A.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);VP(h,m)||h.push(m)}u=new Yt(h),l=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=o.fieldTransforms;return new Ug(new xt(c),u,l)}function DD(n,e){if(bD(n=Qe(n)))return SD("Unsupported field value:",e,n),CD(n,e);if(n instanceof Lu)return(function(r,i){if(!TD(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let c of r){let u=DD(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return yx(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Pe.fromDate(r);return{timestampValue:_u(i.serializer,s)}}if(r instanceof Pe){let s=new Pe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:_u(i.serializer,s)}}if(r instanceof Qn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Kn)return{bytesValue:KT(i.serializer,r._byteString)};if(r instanceof Ze){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:rm(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Yn)return(function(o,c){return{mapValue:{fields:{[Zg]:{stringValue:Jg},[$i]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw c.Sc("VectorValues must only contain numeric values.");return nm(c.serializer,l)})}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${Wg(r)}`)})(n,e)}function CD(n,e){let t={};return IT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gr(n,(r,i)=>{let s=DD(i,e.mc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function bD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pe||n instanceof Qn||n instanceof Kn||n instanceof Ze||n instanceof Lu||n instanceof Yn)}function SD(n,e,t){if(!bD(t)||!oT(t)){let r=Wg(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function LP(n,e,t){if((e=Qe(e))instanceof jo)return e._internalPath;if(typeof e=="string")return AD(n,e);throw Fu("Field path arguments must be of type string or ",n,!1,void 0,t)}var FP=new RegExp("[~\\*/\\[\\]]");function AD(n,e,t){if(e.search(FP)>=0)throw Fu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new jo(...e.split("."))._internalPath}catch{throw Fu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fu(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new L(A.INVALID_ARGUMENT,c+n+u)}function VP(n,e){return n.some(t=>t.isEqual(e))}var Vu=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new qg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ND("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},qg=class extends Vu{data(){return super.data()}};function ND(n,e){return typeof e=="string"?AD(n,e):e instanceof jo?e._internalPath:e._delegate._internalPath}function BP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(A.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var zg=class{convertValue(e,t="none"){switch(Zn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw V(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Gr(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){let t=e.fields?.[$i].arrayValue?.values?.map(r=>Ie(r.doubleValue));return new Yn(t)}convertGeoPoint(e){return new Qn(Ie(e.latitude),Ie(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Uu(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(xo(e));default:return null}}convertTimestamp(e){let t=pn(e);return new Pe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ae.fromString(e);le(eD(r),9688,{name:e});let i=new du(r.get(1),r.get(3)),s=new B(r.popFirst(5));return i.isEqual(t)||hn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function jP(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Lr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Vr=class n extends Vu{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Bi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(ND("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(A.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Vr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vr._jsonSchema={type:xe("string",Vr._jsonSchemaVersion),bundleSource:xe("string","DocumentSnapshot"),bundleName:xe("string"),bundle:xe("string")};var Bi=class extends Vr{data(e={}){return super.data(e)}},ji=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Lr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Bi(this._firestore,this._userDataWriter,r.key,r,new Lr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(A.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{let u=new Bi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Lr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let u=new Bi(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Lr(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return c.type!==0&&(l=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:UP(c.type),doc:u,oldIndex:l,newIndex:h}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(A.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=No.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function UP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return V(61501,{type:n})}}function pm(n){n=Wn(n,Ze);let e=Wn(n.firestore,zr);return RP(hm(e),n._key).then(t=>MD(e,n,t))}ji._jsonSchemaVersion="firestore/querySnapshot/1.0",ji._jsonSchema={type:xe("string",ji._jsonSchemaVersion),bundleSource:xe("string","QuerySnapshot"),bundleName:xe("string"),bundle:xe("string")};var Bu=class extends zg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Kn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,t)}};function gm(n,e,t){n=Wn(n,Ze);let r=Wn(n.firestore,zr),i=jP(n.converter,e,t);return HP(r,[OP(kP(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Fr.none())])}function RD(n,...e){n=Qe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||iT(e[r])||(t=e[r++]);let i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(iT(e[r])){let u=e[r];e[r]=u.next?.bind(u),e[r+1]=u.error?.bind(u),e[r+2]=u.complete?.bind(u)}let s,o,c;if(n instanceof Ze)o=Wn(n.firestore,zr),c=Hu(n._key.path),s={next:u=>{e[r]&&e[r](MD(o,n,u))},error:e[r+1],complete:e[r+2]};else{let u=Wn(n,ku);o=Wn(u.firestore,zr),c=u._query;let l=new Bu(o);s={next:h=>{e[r]&&e[r](new ji(o,l,u,h))},error:e[r+1],complete:e[r+2]},BP(n._query)}return(function(l,h,p,m){let I=new xu(m),S=new Nu(h,I,p);return l.asyncQueue.enqueueAndForget(async()=>lD(await jg(l),S)),()=>{I.Nu(),l.asyncQueue.enqueueAndForget(async()=>dD(await jg(l),S))}})(hm(o),c,i,s)}function HP(n,e){return(function(r,i){let s=new Zt;return r.asyncQueue.enqueueAndForget(async()=>vP(await NP(r),i,s)),s.promise})(hm(n),e)}function MD(n,e,t){let r=t.docs.get(e._key),i=new Bu(n);return new Vr(n,i,e._key,r,new Lr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){es=i})(Gn),zn(new Et("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),c=new zr(new pp(r.getProvider("auth-internal")),new yp(o,r.getProvider("app-check-internal")),(function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new L(A.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new du(l.options.projectId,h)})(o,i),o);return s=j({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),Mt(_w,vw,e),Mt(_w,vw,"esm2020")})();function WD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var KD=WD,QD=new un("auth","Firebase",WD());var Xu=new $n("@firebase/auth");function $P(n,...e){Xu.logLevel<=ne.WARN&&Xu.warn(`Auth (${Gn}): ${n}`,...e)}function Qu(n,...e){Xu.logLevel<=ne.ERROR&&Xu.error(`Auth (${Gn}): ${n}`,...e)}function wt(n,...e){throw Vm(n,...e)}function kt(n,...e){return Vm(n,...e)}function Fm(n,e,t){let r=_e(j({},KD()),{[e]:t});return new un("auth","Firebase",r).create(e,{appName:n.name})}function In(n){return Fm(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qP(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&wt(n,"argument-error"),Fm(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Vm(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return QD.create(n,...e)}function H(n,e,...t){if(!n)throw Vm(e,...t)}function vn(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Qu(e),new Error(e)}function wn(n,e){n||vn(e)}function _m(){return typeof self<"u"&&self.location?.href||""}function zP(){return xD()==="http:"||xD()==="https:"}function xD(){return typeof self<"u"&&self.location?.protocol||null}function GP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zP()||QI()||"connection"in navigator)?navigator.onLine:!0}function WP(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Kr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,wn(t>e,"Short delay should be less than long delay!"),this.isMobile=WI()||YI()}get(){return GP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Bm(n,e){wn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var el=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var KP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var QP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],YP=new Kr(3e4,6e4);function nr(n,e){return n.tenantId&&!e.tenantId?_e(j({},e),{tenantId:n.tenantId}):e}async function rr(n,e,t,r,i={}){return YD(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let c=Ni(j({key:n.config.apiKey},o)).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let l=j({method:e,headers:u},s);return KI()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&Hn(n.emulatorConfig.host)&&(l.credentials="include"),el.fetch()(await ZD(n,n.config.apiHost,t,c),l)})}async function YD(n,e,t){n._canInitEmulator=!1;let r=j(j({},KP),e);try{let i=new vm(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw Ku(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,l]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ku(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ku(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ku(n,"user-disabled",o);let h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Fm(n,h,l);wt(n,h)}}catch(i){if(i instanceof dt)throw i;wt(n,"network-request-failed",{message:String(i)})}}async function Jo(n,e,t,r,i={}){let s=await rr(n,e,t,r,i);return"mfaPendingCredential"in s&&wt(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function ZD(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?Bm(n.config,i):`${n.config.apiScheme}://${i}`;return QP.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function ZP(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var vm=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(kt(this.auth,"network-request-failed")),YP.get())})}};function Ku(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=kt(n,e,r);return i.customData._tokenResponse=t,i}function PD(n){return n!==void 0&&n.enterprise!==void 0}var Em=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ZP(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function JP(n,e){return rr(n,"GET","/v2/recaptchaConfig",nr(n,e))}async function XP(n,e){return rr(n,"POST","/v1/accounts:delete",e)}async function tl(n,e){return rr(n,"POST","/v1/accounts:lookup",e)}function zo(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JD(n,e=!1){let t=Qe(n),r=await t.getIdToken(e),i=jm(r);H(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:zo(mm(i.auth_time)),issuedAtTime:zo(mm(i.iat)),expirationTime:zo(mm(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function mm(n){return Number(n)*1e3}function jm(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Qu("JWT malformed, contained fewer than 3 sections"),null;try{let i=$c(t);return i?JSON.parse(i):(Qu("Failed to decode base64 JWT payload"),null)}catch(i){return Qu("Caught error parsing JWT payload as JSON",i?.toString()),null}}function kD(n){let e=jm(n);return H(e,"internal-error"),H(typeof e.exp<"u","internal-error"),H(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Wo(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof dt&&ek(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function ek({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Im=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Ko=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=zo(this.lastLoginAt),this.creationTime=zo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function nl(n){let e=n.auth,t=await n.getIdToken(),r=await Wo(n,tl(e,{idToken:t}));H(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let s=i.providerUserInfo?.length?eC(i.providerUserInfo):[],o=tk(n.providerData,s),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,l=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ko(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(n,h)}async function XD(n){let e=Qe(n);await nl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tk(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function eC(n){return n.map(r=>{var i=r,{providerId:e}=i,t=ma(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function nk(n,e){let t=await YD(n,{},async()=>{let r=Ni({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await ZD(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Hn(n.emulatorConfig.host)&&(u.credentials="include"),el.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function rk(n,e){return rr(n,"POST","/v2/accounts:revokeToken",nr(n,e))}var Go=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){H(e.idToken,"internal-error"),H(typeof e.idToken<"u","internal-error"),H(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):kD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){H(e.length!==0,"internal-error");let t=kD(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(H(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await nk(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(H(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(H(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(H(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return vn("not implemented")}};function er(n,e){H(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var tr=class n{constructor(s){var o=s,{uid:e,auth:t,stsTokenManager:r}=o,i=ma(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Im(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ko(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Wo(this,this.stsTokenManager.getToken(this.auth,e));return H(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return JD(this,e)}reload(){return XD(this)}_assign(e){this!==e&&(H(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>j({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(_e(j({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){H(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await nl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rt(this.auth.app))return Promise.reject(In(this.auth));let e=await this.getIdToken();return await Wo(this,XP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return _e(j({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>j({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,l=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:I,providerData:S,stsTokenManager:M}=t;H(p&&M,e,"internal-error");let R=Go.fromJSON(this.name,M);H(typeof p=="string",e,"internal-error"),er(r,e.name),er(i,e.name),H(typeof m=="boolean",e,"internal-error"),H(typeof I=="boolean",e,"internal-error"),er(s,e.name),er(o,e.name),er(c,e.name),er(u,e.name),er(l,e.name),er(h,e.name);let F=new n({uid:p,auth:e,email:i,emailVerified:m,displayName:r,isAnonymous:I,photoURL:o,phoneNumber:s,tenantId:c,stsTokenManager:R,createdAt:l,lastLoginAt:h});return S&&Array.isArray(S)&&(F.providerData=S.map(Z=>j({},Z))),u&&(F._redirectEventId=u),F}static async _fromIdTokenResponse(e,t,r=!1){let i=new Go;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await nl(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];H(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?eC(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new Go;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ko(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,l),u}};var OD=new Map;function En(n){wn(n instanceof Function,"Expected a class definition");let e=OD.get(n);return e?(wn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,OD.set(n,e),e)}var ik=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),wm=ik;function Yu(n,e,t){return`firebase:${n}:${e}:${t}`}var rl=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Yu(this.userKey,i.apiKey,s),this.fullPersistenceKey=Yu("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await tl(this.auth,{idToken:e}).catch(()=>{});return t?tr._fromGetAccountInfoResponse(this.auth,t,e):null}return tr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(En(wm),e,r);let i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l),s=i[0]||En(wm),o=Yu(r,e.config.apiKey,e.name),c=null;for(let l of t)try{let h=await l._get(o);if(h){let p;if(typeof h=="string"){let m=await tl(e,{idToken:h}).catch(()=>{});if(!m)break;p=await tr._fromGetAccountInfoResponse(e,m,h)}else p=tr._fromJSON(e,h);l!==s&&(c=p),s=l;break}}catch{}let u=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(t.map(async l=>{if(l!==s)try{await l._remove(o)}catch{}})),new n(s,e,r))}};function LD(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oC(e))return"Blackberry";if(aC(e))return"Webos";if(nC(e))return"Safari";if((e.includes("chrome/")||rC(e))&&!e.includes("edge/"))return"Chrome";if(sC(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function tC(n=Be()){return/firefox\//i.test(n)}function nC(n=Be()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rC(n=Be()){return/crios\//i.test(n)}function iC(n=Be()){return/iemobile/i.test(n)}function sC(n=Be()){return/android/i.test(n)}function oC(n=Be()){return/blackberry/i.test(n)}function aC(n=Be()){return/webos/i.test(n)}function Um(n=Be()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function sk(n=Be()){return Um(n)&&!!window.navigator?.standalone}function ok(){return ZI()&&document.documentMode===10}function cC(n=Be()){return Um(n)||sC(n)||aC(n)||oC(n)||/windows phone/i.test(n)||iC(n)}function uC(n,e=[]){let t;switch(n){case"Browser":t=LD(Be());break;case"Worker":t=`${LD(Be())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Gn}/${r}`}var Tm=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function ak(n,e={}){return rr(n,"GET","/v2/passwordPolicy",nr(n,e))}var ck=6,Dm=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??ck,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Cm=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new il(this),this.idTokenSubscription=new il(this),this.beforeStateQueue=new Tm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=QD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=En(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await rl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await tl(this,{idToken:e}),r=await tr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(rt(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!s||s===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return H(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await nl(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rt(this.app))return Promise.reject(In(this));let t=e?Qe(e):null;return t&&H(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&H(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rt(this.app)?Promise.reject(In(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rt(this.app)?Promise.reject(In(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(En(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await ak(this),t=new Dm(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new un("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await rk(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&En(e)||this._popupRedirectResolver;H(t,this,"argument-error"),this.redirectPersistenceManager=await rl.create(this,[En(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(H(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return H(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(rt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&$P(`Error while retrieving App Check token: ${e.error}`),e?.token}};function ir(n){return Qe(n)}var il=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=tw(t=>this.observer=t)}get next(){return H(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var hl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uk(n){hl=n}function lC(n){return hl.loadJS(n)}function lk(){return hl.recaptchaEnterpriseScript}function dk(){return hl.gapiScript}function dC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var bm=class{constructor(){this.enterprise=new Sm}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Sm=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var fk="recaptcha-enterprise",fC="NO_RECAPTCHA",Am=class{constructor(e){this.type=fk,this.auth=ir(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,c)=>{JP(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let l=new Em(u);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(u=>{c(u)})})}function i(s,o,c){let u=window.grecaptcha;PD(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(fC)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new bm().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(c=>{if(!t&&PD(window.grecaptcha))i(c,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=lk();u.length!==0&&(u+=c),lC(u).then(()=>{i(c,s,o)}).catch(l=>{o(l)})}}).catch(c=>{o(c)})})}};async function qo(n,e,t,r=!1,i=!1){let s=new Am(n),o;if(i)o=fC;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}let c=j({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let u=c.phoneEnrollmentInfo.phoneNumber,l=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Nm(n,e,t,r,i){if(i==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=await qo(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=await qo(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)});else if(i==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let s=await qo(n,e,t);return r(n,s).catch(async o=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(o.code==="auth/missing-recaptcha-token"||o.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let c=await qo(n,e,t,!1,!0);return r(n,c)}return Promise.reject(o)})}else{let s=await qo(n,e,t,!1,!0);return r(n,s)}else return Promise.reject(i+" provider is not supported.")}function hC(n,e){let t=wo(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(Kt(s,e??{}))return i;wt(i,"already-initialized")}return t.initialize({options:e})}function hk(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(En);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function pC(n,e,t){let r=ir(n);H(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=gC(e),{host:o,port:c}=pk(e),u=c===null?"":`:${c}`,l={url:`${s}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){H(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),H(Kt(l,r.config.emulator)&&Kt(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Hn(o)?(zc(`${s}//${o}${u}`),Gc("Auth",!0)):i||gk()}function gC(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function pk(n){let e=gC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:FD(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:FD(o)}}}function FD(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function gk(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var os=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return vn("not implemented")}_getIdTokenResponse(e){return vn("not implemented")}_linkToIdToken(e,t){return vn("not implemented")}_getReauthenticationResolver(e){return vn("not implemented")}};async function mk(n,e){return rr(n,"POST","/v1/accounts:signUp",e)}async function yk(n,e){return Jo(n,"POST","/v1/accounts:signInWithPassword",nr(n,e))}async function _k(n,e){return Jo(n,"POST","/v1/accounts:signInWithEmailLink",nr(n,e))}async function vk(n,e){return Jo(n,"POST","/v1/accounts:signInWithEmailLink",nr(n,e))}var Qo=class n extends os{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nm(e,t,"signInWithPassword",yk,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return _k(e,{email:this._email,oobCode:this._password});default:wt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nm(e,r,"signUpPassword",mk,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return vk(e,{idToken:t,email:this._email,oobCode:this._password});default:wt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function ss(n,e){return Jo(n,"POST","/v1/accounts:signInWithIdp",nr(n,e))}var Ek="http://localhost",sl=class n extends os{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let c=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=c,s=ma(c,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return ss(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,ss(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ss(e,t)}buildRequest(){let e={requestUri:Ek,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ni(t)}return e}};function Ik(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function wk(n){let e=Ri(Mi(n)).link,t=e?Ri(Mi(e)).deep_link_id:null,r=Ri(Mi(n)).deep_link_id;return(r?Ri(Mi(r)).link:null)||r||t||e||n}var ol=class n{constructor(e){let t=Ri(Mi(e)),r=t.apiKey??null,i=t.oobCode??null,s=Ik(t.mode??null);H(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t=wk(e);try{return new n(t)}catch{return null}}};var mC=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Qo._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=ol.parseLink(r);return H(i,"argument-error"),Qo._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Yo=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var al=class extends Yo{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Hm=(()=>{class n extends al{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return sl._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();async function Tk(n,e){return Jo(n,"POST","/v1/accounts:signUp",nr(n,e))}var as=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await tr._fromIdTokenResponse(e,r,i),o=VD(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=VD(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function VD(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Rm=class n extends dt{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function yC(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Rm._fromErrorAndOperation(n,s,e,r):s})}async function Dk(n,e,t=!1){let r=await Wo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return as._forOperation(n,"link",r)}async function Ck(n,e,t=!1){let{auth:r}=n;if(rt(r.app))return Promise.reject(In(r));let i="reauthenticate";try{let s=await Wo(n,yC(r,i,e,n),t);H(s.idToken,r,"internal-error");let o=jm(s.idToken);H(o,r,"internal-error");let{sub:c}=o;return H(n.uid===c,r,"user-mismatch"),as._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&wt(r,"user-mismatch"),s}}async function _C(n,e,t=!1){if(rt(n.app))return Promise.reject(In(n));let r="signIn",i=await yC(n,r,e),s=await as._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function vC(n,e){return _C(ir(n),e)}async function EC(n){let e=ir(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function $m(n,e,t){if(rt(n.app))return Promise.reject(In(n));let r=ir(n),o=await Nm(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Tk,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&EC(n),u}),c=await as._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function qm(n,e,t){return rt(n.app)?Promise.reject(In(n)):vC(Qe(n),mC.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&EC(n),r})}function IC(n,e,t,r){return Qe(n).onIdTokenChanged(e,t,r)}function wC(n,e,t){return Qe(n).beforeAuthStateChanged(e,t)}function zm(n,e,t,r){return Qe(n).onAuthStateChanged(e,t,r)}function Gm(n){return Qe(n).signOut()}var cl="__sak";var ul=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cl,"1"),this.storage.removeItem(cl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var bk=1e3,Sk=10,Ak=(()=>{class n extends ul{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cC(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,u,l)=>{this.notifyListeners(c,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);ok()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,Sk):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},bk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),TC=Ak;var Nk=(()=>{class n extends ul{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Wm=Nk;function Rk(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var Mk=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:s,data:o}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let u=Array.from(c).map(async h=>h(r.origin,o)),l=await Rk(u);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Km(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Mm=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,u)=>{let l=Km("",20);i.port1.start();let h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let m=p;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(m.data.response);break;default:clearTimeout(h),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function rn(){return window}function xk(n){rn().location.href=n}function DC(){return typeof rn().WorkerGlobalScope<"u"&&typeof rn().importScripts=="function"}async function Pk(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kk(){return navigator?.serviceWorker?.controller||null}function Ok(){return DC()?self:null}var CC="firebaseLocalStorageDb",Lk=1,ll="firebaseLocalStorage",bC="fbase_key",Qr=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function pl(n,e){return n.transaction([ll],e?"readwrite":"readonly").objectStore(ll)}function Fk(){let n=indexedDB.deleteDatabase(CC);return new Qr(n).toPromise()}function xm(){let n=indexedDB.open(CC,Lk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(ll,{keyPath:bC})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(ll)?e(r):(r.close(),await Fk(),e(await xm()))})})}async function BD(n,e,t){let r=pl(n,!0).put({[bC]:e,value:t});return new Qr(r).toPromise()}async function Vk(n,e){let t=pl(n,!1).get(e),r=await new Qr(t).toPromise();return r===void 0?null:r.value}function jD(n,e){let t=pl(n,!0).delete(e);return new Qr(t).toPromise()}var Bk=800,jk=3,Uk=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xm(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>jk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mk._getInstance(Ok()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Pk(),!this.activeServiceWorker)return;this.sender=new Mm(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||kk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await xm();return await BD(t,cl,"1"),await jD(t,cl),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>BD(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>Vk(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>jD(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(s=>{let o=pl(s,!1).getAll();return new Qr(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Bk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),SC=Uk;var i5=dC("rcb"),s5=new Kr(3e4,6e4);function AC(n,e){return e?En(e):(H(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Zo=class extends os{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ss(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ss(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ss(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Hk(n){return _C(n.auth,new Zo(n),n.bypassAuthState)}function $k(n){let{auth:e,user:t}=n;return H(t,e,"internal-error"),Ck(t,new Zo(n),n.bypassAuthState)}async function qk(n){let{auth:e,user:t}=n;return H(t,e,"internal-error"),Dk(t,new Zo(n),n.bypassAuthState)}var dl=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Hk;case"linkViaPopup":case"linkViaRedirect":return qk;case"reauthViaPopup":case"reauthViaRedirect":return $k;default:wt(this.auth,"internal-error")}}resolve(e){wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var zk=new Kr(2e3,1e4);async function Qm(n,e,t){if(rt(n.app))return Promise.reject(kt(n,"operation-not-supported-in-this-environment"));let r=ir(n);qP(n,e,Yo);let i=AC(r,t);return new Gk(r,"signInViaPopup",e,i).executeNotNull()}var Gk=(()=>{class n extends dl{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return H(t,this.auth,"internal-error"),t}async onExecution(){wn(this.filter.length===1,"Popup operations only handle one event");let t=Km();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,zk.get())};t()}}n.currentPopupAction=null;return n})(),Wk="pendingRedirect",Zu=new Map,Pm=class extends dl{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Zu.get(this.auth._key());if(!e){try{let r=await Kk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Zu.set(this.auth._key(),e)}return this.bypassAuthState||Zu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function Kk(n,e){let t=Zk(e),r=Yk(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function Qk(n,e){Zu.set(n._key(),e)}function Yk(n){return En(n._redirectPersistence)}function Zk(n){return Yu(Wk,n.config.apiKey,n.name)}async function Jk(n,e,t=!1){if(rt(n.app))return Promise.reject(In(n));let r=ir(n),i=AC(r,e),o=await new Pm(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}var Xk=600*1e3,km=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!e1(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!NC(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(kt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Xk&&this.cachedEventUids.clear(),this.cachedEventUids.has(UD(e))}saveEventToCache(e){this.cachedEventUids.add(UD(e)),this.lastProcessedEventTime=Date.now()}};function UD(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function NC({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function e1(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return NC(n);default:return!1}}async function t1(n,e={}){return rr(n,"GET","/v1/projects",e)}var n1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r1=/^https?/;async function i1(n){if(n.config.emulator)return;let{authorizedDomains:e}=await t1(n);for(let t of e)try{if(s1(t))return}catch{}wt(n,"unauthorized-domain")}function s1(n){let e=_m(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!r1.test(t))return!1;if(n1.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var o1=new Kr(3e4,6e4);function HD(){let n=rn().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function a1(n){return new Promise((e,t)=>{function r(){HD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{HD(),t(kt(n,"network-request-failed"))},timeout:o1.get()})}if(rn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rn().gapi?.load)r();else{let i=dC("iframefcb");return rn()[i]=()=>{gapi.load?r():t(kt(n,"network-request-failed"))},lC(`${dk()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw Ju=null,e})}var Ju=null;function c1(n){return Ju=Ju||a1(n),Ju}var u1=new Kr(5e3,15e3),l1="__/auth/iframe",d1="emulator/auth/iframe",f1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},h1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function p1(n){let e=n.config;H(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Bm(e,d1):`https://${n.config.authDomain}/${l1}`,r={apiKey:e.apiKey,appName:n.name,v:Gn},i=h1.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Ni(r).slice(1)}`}async function g1(n){let e=await c1(n),t=rn().gapi;return H(t,n,"internal-error"),e.open({where:document.body,url:p1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:f1,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=kt(n,"network-request-failed"),c=rn().setTimeout(()=>{s(o)},u1.get());function u(){rn().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(o)})}))}var m1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},y1=500,_1=600,v1="_blank",E1="http://localhost",fl=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function I1(n,e,t,r=y1,i=_1){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",u=_e(j({},m1),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Be().toLowerCase();t&&(c=rC(l)?v1:t),tC(l)&&(e=e||E1,u.scrollbars="yes");let h=Object.entries(u).reduce((m,[I,S])=>`${m}${I}=${S},`,"");if(sk(l)&&c!=="_self")return w1(e||"",c),new fl(null);let p=window.open(e||"",c,h);H(p,n,"popup-blocked");try{p.focus()}catch{}return new fl(p)}function w1(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var T1="__/auth/handler",D1="emulator/auth/handler",C1=encodeURIComponent("fac");async function $D(n,e,t,r,i,s){H(n.config.authDomain,n,"auth-domain-config-required"),H(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Gn,eventId:i};if(e instanceof Yo){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",ew(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[h,p]of Object.entries(s||{}))o[h]=p}if(e instanceof al){let h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let h of Object.keys(c))c[h]===void 0&&delete c[h];let u=await n._getAppCheckToken(),l=u?`#${C1}=${encodeURIComponent(u)}`:"";return`${b1(n)}?${Ni(c).slice(1)}${l}`}function b1({config:n}){return n.emulator?Bm(n,D1):`https://${n.authDomain}/${T1}`}var ym="webStorageSupport",Om=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Wm,this._completeRedirectFn=Jk,this._overrideRedirectResult=Qk}async _openPopup(e,t,r,i){wn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let s=await $D(e,t,r,_m(),i);return I1(e,s,Km())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await $D(e,t,r,_m(),i);return xk(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(wn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await g1(e),r=new km(e);return t.register("authEvent",i=>(H(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ym,{type:ym},i=>{let s=i?.[0]?.[ym];s!==void 0&&t(!!s),wt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=i1(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cC()||nC()||Um()}},RC=Om;var qD="@firebase/auth",zD="1.12.0";var Lm=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){H(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function S1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function A1(n){zn(new Et("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;H(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uC(n)},l=new Cm(r,i,s,u);return hk(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),zn(new Et("auth-internal",e=>{let t=ir(e.getProvider("auth").getImmediate());return(r=>new Lm(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mt(qD,zD,S1(n)),Mt(qD,zD,"esm2020")}var N1=300,R1=Vh("authIdTokenMaxAge")||N1,GD=null,M1=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>R1)return;let i=t?.token;GD!==i&&(GD=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Ym(n=Yc()){let e=wo(n,"auth");if(e.isInitialized())return e.getImmediate();let t=hC(n,{popupRedirectResolver:RC,persistence:[SC,TC,Wm]}),r=Vh("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=M1(s.toString());wC(t,o,()=>o(t.currentUser)),IC(t,c=>o(c))}}let i=Lh("auth");return i&&pC(t,`http://${i}`),t}function x1(){return document.getElementsByTagName("head")?.[0]??document}uk({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=kt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",x1().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});A1("Browser");var MC={production:!0,firebaseConfig:{apiKey:"AIzaSyB_WSNJbHhEGi6EPYbBKJvlP-MH1nQ846Y",authDomain:"cross-plane-2f5de.firebaseapp.com",projectId:"cross-plane-2f5de",storageBucket:"cross-plane-2f5de.firebasestorage.app",messagingSenderId:"183248187868",appId:"1:183248187868:web:348f43d2a2c5e3e6f0df19"}};var P1=MC.firebaseConfig,cs=class n{constructor(){this.app=ep(P1);this.db=wD(this.app);this.auth=Ym(this.app);this.unsubscribe=null;this.sessionId="shared-grid";this.isSynced=we(!1);this.isLoading=we(!0);this.currentUser=we(null);zm(this.auth,e=>{this.currentUser.set(e)})}async saveCells(e){let t=Array.from(e.values()).filter(i=>i.confirmed),r=is(this.db,"grids",this.sessionId);await gm(r,{cells:t,updatedAt:new Date().toISOString()}),this.isSynced.set(!0)}async loadCells(){let e=is(this.db,"grids",this.sessionId),t=await pm(e);return t.exists()?t.data().cells||[]:[]}subscribeToChanges(e){let t=is(this.db,"grids",this.sessionId);this.unsubscribe=RD(t,r=>{if(r.exists()){let i=r.data();e(i?.cells||[])}})}destroy(){this.unsubscribe&&this.unsubscribe()}async signInWithGoogle(){let e=new Hm;try{await Qm(this.auth,e)}catch(t){throw console.error("Error signing in with Google",t),t}}async loginEmail(e,t){await qm(this.auth,e,t)}async registerEmail(e,t){await $m(this.auth,e,t)}async signOut(){try{await Gm(this.auth)}catch(e){throw console.error("Error signing out",e),e}}async saveUserData(e,t){let r=is(this.db,"users",e);await gm(r,t,{merge:!0})}async getUserData(e){let t=is(this.db,"users",e),r=await pm(t);return r.exists()?r.data():null}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}};var us=class n{constructor(){this.cellsMap=new Map;this.firebase=te(cs);this.saveTimeout=null;this.isInitialized=!1;this.skipNextSync=!1;this.cells=we(new Map);this.viewportOffset=we({x:0,y:0});this.selectedCell=we(null);this.inputDirection=we("across");this.isLoading=we(!0);this.lastPlacedTime=we(0);this.wordsPlacedCount=we(0);let e=this.getCookie("cross_plane_last_placed");e&&this.lastPlacedTime.set(parseInt(e,10));let t=this.getCookie("cross_plane_words_placed");t&&this.wordsPlacedCount.set(parseInt(t,10)),this.loadFromFirebase(),this.firebase.subscribeToChanges(r=>{this.handleRemoteUpdate(r)}),zt(()=>{let r=this.cells();if(this.isInitialized){if(this.skipNextSync){this.skipNextSync=!1;return}this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.saveToFirebase()},1e3)}}),zt(()=>{let r=this.lastPlacedTime();r>0&&this.setCookie("cross_plane_last_placed",r.toString(),365)}),zt(()=>{let r=this.wordsPlacedCount();this.setCookie("cross_plane_words_placed",r.toString(),365);let i=Ks(()=>this.firebase.currentUser());i&&this.firebase.saveUserData(i.uid,{wordsPlacedCount:r})}),zt(()=>{let r=this.firebase.currentUser();r&&this.syncUserStats(r.uid)})}async syncUserStats(e){if(!this.skipNextSync)try{let t=await this.firebase.getUserData(e),r=this.wordsPlacedCount();if(t&&typeof t.wordsPlacedCount=="number"){let i=t.wordsPlacedCount;i>r?this.wordsPlacedCount.set(i):r>i&&this.firebase.saveUserData(e,{wordsPlacedCount:r})}else r>0&&this.firebase.saveUserData(e,{wordsPlacedCount:r})}catch(t){console.error("Error syncing user stats",t)}}resetUserStats(){this.wordsPlacedCount.set(0),this.setCookie("cross_plane_words_placed","0",365)}setCookie(e,t,r){let i="";if(r){let s=new Date;s.setTime(s.getTime()+r*24*60*60*1e3),i="; expires="+s.toUTCString()}document.cookie=e+"="+(t||"")+i+"; path=/"}getCookie(e){let t=e+"=",r=document.cookie.split(";");for(let i=0;i<r.length;i++){let s=r[i];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(t)===0)return s.substring(t.length,s.length)}return null}handleRemoteUpdate(e){let t=new Map;e.forEach(r=>{let i=`${r.x},${r.y} `;t.set(i,r)}),(this.cellsMap.size!==t.size||!this.mapsEqual(this.cellsMap,t))&&(this.skipNextSync=!0,this.cellsMap=t,this.cells.set(new Map(this.cellsMap)),console.log("Grid updated from Firebase (real-time sync)"))}mapsEqual(e,t){if(e.size!==t.size)return!1;for(let[r,i]of e){let s=t.get(r);if(!s||i.char!==s.char||i.confirmed!==s.confirmed)return!1}return!0}async loadFromFirebase(){try{let e=await this.firebase.loadCells();e.length>0?(e.forEach(t=>{let r=`${t.x},${t.y} `;this.cellsMap.set(r,t)}),this.cells.set(new Map(this.cellsMap))):this.initializeDefault()}catch(e){console.error("Failed to load from Firebase - Check Firestore Rules in Console!",e),this.initializeDefault()}finally{this.isLoading.set(!1),this.isInitialized=!0}}initializeDefault(){this.setCell(-5,0,"C",!0),this.setCell(-4,0,"R",!0),this.setCell(-3,0,"O",!0),this.setCell(-2,0,"S",!0),this.setCell(-1,0,"S",!0),this.setCell(0,0,".",!0),this.setCell(1,0,"P",!0),this.setCell(2,0,"L",!0),this.setCell(3,0,"A",!0),this.setCell(4,0,"N",!0),this.setCell(5,0,"E",!0)}async saveToFirebase(){try{await this.firebase.saveCells(this.cellsMap),console.log("Grid saved to Firebase")}catch(e){console.error("Failed to save to Firebase - Check Firestore Rules in Console!",e)}}getCell(e,t){return this.cellsMap.get(`${e},${t} `)}setCell(e,t,r,i){let s=`${e},${t} `;this.cellsMap.set(s,{x:e,y:t,char:r.toUpperCase(),confirmed:i}),this.cells.set(new Map(this.cellsMap))}removeCell(e,t){let r=`${e},${t} `;this.cellsMap.has(r)&&(this.cellsMap.delete(r),this.cells.set(new Map(this.cellsMap)))}isBlackSquare(e,t){if(Math.abs(e)<6&&Math.abs(t)<6)return!1;let r=Math.sin(e*12.9898+t*78.233)*43758.5453123%1;return Math.abs(r)>.88}isValidSlot(e,t){return!this.isBlackSquare(e,t)}incrementWordsPlaced(){this.wordsPlacedCount.update(e=>e+1)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}};var O1=["progressPath"];function L1(n,e){n&1&&(O(0,"div",36),Ce(1,"div",37),U())}function F1(n,e){n&1&&(O(0,"div",38),We(),O(1,"svg",39),Ce(2,"circle",40)(3,"path",41),U(),qt(),O(4,"span",42),Ne(5,"Validating..."),U()())}function V1(n,e){if(n&1&&(O(0,"div",43),Ne(1),U()),n&2){let t=be();Si("text-red-500",t.isError)("text-green-600",!t.isError),fe(),co(" ",t.validationMessage," ")}}function B1(n,e){if(n&1){let t=vt();O(0,"button",44),Te("click",function(){J(t);let i=be();return X(i.toggleAuthMenu())}),We(),O(1,"svg",25),Ce(2,"path",45),U()()}}function j1(n,e){if(n&1&&(O(0,"div",62),Ne(1),U()),n&2){let t=be(2);fe(),jn(t.authError)}}function U1(n,e){if(n&1&&(O(0,"span"),Ne(1),U()),n&2){let t=be(2);fe(),jn(t.isRegisterMode?"Sign Up":"Log In")}}function H1(n,e){n&1&&(We(),O(0,"svg",63),Ce(1,"circle",40)(2,"path",41),U())}function $1(n,e){if(n&1){let t=vt();O(0,"span"),Ne(1,"Need an account? "),O(2,"button",64),Te("click",function(){J(t);let i=be(2);return i.isRegisterMode=!0,X(i.authError="")}),Ne(3,"Sign up"),U()()}}function q1(n,e){if(n&1){let t=vt();O(0,"span"),Ne(1,"Values account? "),O(2,"button",64),Te("click",function(){J(t);let i=be(2);return i.isRegisterMode=!1,X(i.authError="")}),Ne(3,"Log in"),U()()}}function z1(n,e){if(n&1){let t=vt();O(0,"div",46)(1,"h3",47),Ne(2),U(),O(3,"div",48)(4,"input",49,1),Te("keydown",function(i){return J(t),X(i.stopPropagation())})("keyup.enter",function(){J(t);let i=xr(7);return X(i.focus())}),U(),O(6,"input",50,2),Te("keydown",function(i){return J(t),X(i.stopPropagation())})("keyup.enter",function(){J(t);let i=xr(5),s=xr(7),o=be();return X(o.handleAuth(i.value,s.value))}),U(),Ke(8,j1,2,1,"div",51),O(9,"button",52),Te("click",function(){J(t);let i=xr(5),s=xr(7),o=be();return X(o.handleAuth(i.value,s.value))}),Ke(10,U1,2,1,"span",53)(11,H1,3,0,"svg",54),U()(),O(12,"div",55),Ce(13,"div",56),O(14,"span",57),Ne(15,"OR"),U(),Ce(16,"div",56),U(),O(17,"button",58),Te("click",function(){J(t);let i=be();return X(i.signInGoogle())}),We(),O(18,"svg",59),Ce(19,"path",60),U(),Ne(20," Google "),U(),qt(),O(21,"div",61),Ke(22,$1,4,0,"span",53)(23,q1,4,0,"span",53),U()()}if(n&2){let t=be();fe(2),jn(t.isRegisterMode?"Create Account":"Welcome Back"),fe(6),me("ngIf",t.authError),fe(2),me("ngIf",!t.isAuthLoading),fe(),me("ngIf",t.isAuthLoading),fe(11),me("ngIf",!t.isRegisterMode),fe(),me("ngIf",t.isRegisterMode)}}function G1(n,e){if(n&1&&Ce(0,"img",71),n&2){let t,r=be(2);me("src",(t=r.currentUser())==null?null:t.photoURL,zf)}}function W1(n,e){if(n&1&&(O(0,"span",72),Ne(1),U()),n&2){let t,r=be(2);fe(),jn(((t=r.currentUser())==null||t.displayName==null?null:t.displayName.charAt(0))||"U")}}function K1(n,e){if(n&1){let t=vt();O(0,"button",65),Te("click",function(){J(t);let i=be();return X(i.signOut())}),Ke(1,G1,1,1,"img",66)(2,W1,2,1,"span",67),O(3,"div",68),We(),O(4,"svg",69),Ce(5,"path",70),U()()()}if(n&2){let t,r,i,s=be();me("title",((t=s.currentUser())==null?null:t.displayName)||"Sign Out"),fe(),me("ngIf",(r=s.currentUser())==null?null:r.photoURL),fe(),me("ngIf",!((i=s.currentUser())!=null&&i.photoURL))}}function Q1(n,e){n&1&&(We(),O(0,"svg",80),Ce(1,"path",81),U())}function Y1(n,e){if(n&1){let t=vt();O(0,"button",78),Te("click",function(){let i=J(t).$implicit,s=be(2);return X(s.selectTheme(i))}),Ke(1,Q1,2,0,"svg",79),U()}if(n&2){let t=e.$implicit,r=be(2);ao("background-color",t.buttonColor)("border-color",t.colors.confirmedBorder),Si("ring-2",r.activeTheme.id===t.id)("ring-offset-1",r.activeTheme.id===t.id)("ring-blue-500",r.activeTheme.id===t.id)("opacity-50",r.wordsPlacedCount<t.unlockCount),me("title",r.wordsPlacedCount<t.unlockCount?"Unlock at "+t.unlockCount+" words":t.name),fe(),me("ngIf",r.wordsPlacedCount<t.unlockCount)}}function Z1(n,e){if(n&1&&(O(0,"span",84),Ne(1,"Ag"),U()),n&2){let t=be().$implicit;ao("font-family",t.fontFamily)}}function J1(n,e){n&1&&(We(),O(0,"svg",80),Ce(1,"path",81),U())}function X1(n,e){if(n&1){let t=vt();O(0,"button",82),Te("click",function(){let i=J(t).$implicit,s=be(2);return X(s.selectFont(i))}),Ke(1,Z1,2,2,"span",83)(2,J1,2,0,"svg",79),U()}if(n&2){let t=e.$implicit,r=be(2);Si("ring-2",r.activeFont.id===t.id)("ring-offset-1",r.activeFont.id===t.id)("ring-blue-500",r.activeFont.id===t.id)("opacity-50",r.wordsPlacedCount<t.unlockCount),me("title",r.wordsPlacedCount<t.unlockCount?"Unlock at "+t.unlockCount+" words":t.name),fe(),me("ngIf",r.wordsPlacedCount>=t.unlockCount),fe(),me("ngIf",r.wordsPlacedCount<t.unlockCount)}}function eO(n,e){if(n&1&&(O(0,"div",73)(1,"div",74),Ke(2,Y1,2,14,"button",75),U(),Ce(3,"div",76),O(4,"div",74),Ke(5,X1,3,11,"button",77),U()()),n&2){let t=be();fe(2),me("ngForOf",t.themes),fe(3),me("ngForOf",t.fonts)}}var gl=class n{constructor(){this.lastPlacedTime=0;this.cooldownMs=15e3;this.wordsPlacedCount=0;this.isValidating=!1;this.validationMessage="";this.isError=!1;this.themes=[];this.fonts=[];this.themeSelected=new qe;this.fontSelected=new qe;this.zoomIn=new qe;this.zoomOut=new qe;this.resetView=new qe;this.sharePosition=new qe;this.ngZone=te(ze);this.firebaseService=te(cs);this.gridStore=te(us);this.currentUser=this.firebaseService.currentUser;this.animationFrameId=null;this.cooldownProgress=1;this.isThemeMenuOpen=!1;this.isAuthMenuOpen=!1;this.isRegisterMode=!1;this.isAuthLoading=!1;this.authError=""}toggleAuthMenu(){this.isAuthMenuOpen=!this.isAuthMenuOpen,this.isThemeMenuOpen=!1,this.authError=""}async signInGoogle(){this.isAuthLoading=!0;try{await this.firebaseService.signInWithGoogle(),this.isAuthMenuOpen=!1}catch(e){this.authError=e.message}finally{this.isAuthLoading=!1}}async handleAuth(e,t){if(!e||!t){this.authError="Please enter email and password";return}this.isAuthLoading=!0,this.authError="";try{this.isRegisterMode?await this.firebaseService.registerEmail(e,t):await this.firebaseService.loginEmail(e,t),this.isAuthMenuOpen=!1}catch(r){console.error(r),r.code==="auth/invalid-credential"?this.authError="Invalid email or password.":r.code==="auth/email-already-in-use"?this.authError="Email already in use.":r.code==="auth/weak-password"?this.authError="Password should be at least 6 characters.":this.authError="Error: "+(r.message||"Unknown")}finally{this.isAuthLoading=!1}}async signOut(){await this.firebaseService.signOut(),this.gridStore.resetUserStats()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{let e=()=>{let r=Date.now()-this.lastPlacedTime,i=1;if(r<this.cooldownMs&&(i=r/this.cooldownMs),this.progressPath?.nativeElement){let s=(i*100).toFixed(1);this.progressPath.nativeElement.setAttribute("stroke-dasharray",`${s}, 100`)}i>=1&&this.cooldownProgress<1?this.ngZone.run(()=>this.cooldownProgress=1):i<1&&this.cooldownProgress>=1&&this.ngZone.run(()=>this.cooldownProgress=i),this.animationFrameId=requestAnimationFrame(e)};e()})}ngOnDestroy(){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}toggleThemeMenu(){this.isThemeMenuOpen=!this.isThemeMenuOpen,this.isAuthMenuOpen=!1}selectTheme(e){this.wordsPlacedCount>=e.unlockCount&&this.themeSelected.emit(e)}selectFont(e){this.wordsPlacedCount>=e.unlockCount&&this.fontSelected.emit(e)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=so({type:n,selectors:[["app-top-bar"]],viewQuery:function(t,r){if(t&1&&Di(O1,5),t&2){let i;Ci(i=bi())&&(r.progressPath=i.first)}},inputs:{lastPlacedTime:"lastPlacedTime",cooldownMs:"cooldownMs",wordsPlacedCount:"wordsPlacedCount",isValidating:"isValidating",validationMessage:"validationMessage",isError:"isError",activeTheme:"activeTheme",themes:"themes",activeFont:"activeFont",fonts:"fonts"},outputs:{themeSelected:"themeSelected",fontSelected:"fontSelected",zoomIn:"zoomIn",zoomOut:"zoomOut",resetView:"resetView",sharePosition:"sharePosition"},decls:45,vars:8,consts:[["progressPath",""],["emailInput",""],["passwordInput",""],[1,"absolute","top-0","left-0","right-0","p-4","pointer-events-none","z-50","flex","justify-center","md:justify-start"],[1,"bg-white/95","backdrop-blur","shadow-lg","border","border-gray-200","px-4","py-3","rounded-xl","pointer-events-auto","max-w-sm","w-full","md:w-auto","text-center","md:text-left"],[1,"flex","items-center","gap-3","mb-1"],[1,"relative","w-6","h-6","flex-shrink-0"],["viewBox","0 0 36 36",1,"transform","-rotate-90","w-full","h-full"],["d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831","fill","none","stroke","currentColor","stroke-width","4",1,"text-gray-200"],["stroke-dasharray","100, 100","d","M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831","fill","none","stroke","currentColor","stroke-width","4",1,"text-blue-500","transition-[stroke-dasharray]","duration-100","ease-linear"],["class","absolute inset-0 flex items-center justify-center",4,"ngIf"],[1,"text-xl","font-black","tracking-tighter"],[1,"hidden","md:block","text-xs","text-gray-500","mb-2","leading-relaxed"],[1,"flex","items-center","justify-between","mb-3","pt-2","border-t","border-gray-100"],[1,"text-xs","font-bold","text-gray-500","uppercase","tracking-wide"],[1,"text-black","text-sm"],[1,"min-h-[24px]","flex","flex-col","justify-center","items-center","md:items-start"],["class","flex items-center space-x-2 text-blue-600 animate-pulse",4,"ngIf"],["class","text-sm font-medium whitespace-pre-wrap",3,"text-red-500","text-green-600",4,"ngIf"],[1,"absolute","top-4","right-4","flex","flex-col","gap-2","z-50","pointer-events-auto"],[1,"relative"],["class","bg-white shadow-lg border border-gray-200 p-2 rounded-full hover:bg-gray-50 text-gray-700","title","Sign In",3,"click",4,"ngIf"],["class","absolute right-0 top-12 w-72 bg-white/95 backdrop-blur shadow-xl border border-gray-200 p-4 rounded-xl z-50 animate-in fade-in slide-in-from-top-2",4,"ngIf"],["class","bg-white shadow-lg border border-gray-200 p-1 rounded-full hover:bg-gray-50 overflow-hidden w-10 h-10 flex items-center justify-center relative group",3,"title","click",4,"ngIf"],["title","Center View",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["title","Share Position",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"],["title","Themes",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"],["class","absolute right-full top-0 mr-2 bg-white/95 backdrop-blur shadow-lg border border-gray-200 p-3 rounded-xl flex flex-col gap-3 min-w-max animate-in fade-in slide-in-from-right-2",4,"ngIf"],["title","Zoom In",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["title","Zoom Out",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 12H4"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"w-2","h-2","bg-blue-500","rounded-full"],[1,"flex","items-center","space-x-2","text-blue-600","animate-pulse"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"text-sm","font-semibold"],[1,"text-sm","font-medium","whitespace-pre-wrap"],["title","Sign In",1,"bg-white","shadow-lg","border","border-gray-200","p-2","rounded-full","hover:bg-gray-50","text-gray-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"],[1,"absolute","right-0","top-12","w-72","bg-white/95","backdrop-blur","shadow-xl","border","border-gray-200","p-4","rounded-xl","z-50","animate-in","fade-in","slide-in-from-top-2"],[1,"font-bold","text-lg","mb-3"],[1,"space-y-2","mb-4"],["type","email","placeholder","Email",1,"w-full","px-3","py-2","border","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","bg-white/50",3,"keydown","keyup.enter"],["type","password","placeholder","Password",1,"w-full","px-3","py-2","border","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","bg-white/50",3,"keydown","keyup.enter"],["class","text-xs text-red-500 font-medium",4,"ngIf"],[1,"w-full","bg-blue-600","hover:bg-blue-700","text-white","font-bold","py-2","rounded-lg","transition-colors","flex","justify-center","items-center",3,"click"],[4,"ngIf"],["class","animate-spin h-5 w-5 text-white","fill","none","viewBox","0 0 24 24",4,"ngIf"],[1,"relative","flex","py-2","items-center"],[1,"flex-grow","border-t","border-gray-300"],[1,"flex-shrink-0","mx-2","text-gray-400","text-xs"],[1,"w-full","bg-white","border","border-gray-300","hover:bg-gray-50","text-gray-700","font-bold","py-2","rounded-lg","transition-colors","flex","items-center","justify-center","gap-2","mb-3",3,"click"],["viewBox","0 0 24 24","fill","currentColor",1,"w-4","h-4"],["d","M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"],[1,"text-center","text-xs","text-gray-500"],[1,"text-xs","text-red-500","font-medium"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],[1,"text-blue-600","hover:underline",3,"click"],[1,"bg-white","shadow-lg","border","border-gray-200","p-1","rounded-full","hover:bg-gray-50","overflow-hidden","w-10","h-10","flex","items-center","justify-center","relative","group",3,"click","title"],["class","w-full h-full object-cover rounded-full",3,"src",4,"ngIf"],["class","text-xs font-bold",4,"ngIf"],[1,"absolute","inset-0","bg-black/50","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"],[1,"w-full","h-full","object-cover","rounded-full",3,"src"],[1,"text-xs","font-bold"],[1,"absolute","right-full","top-0","mr-2","bg-white/95","backdrop-blur","shadow-lg","border","border-gray-200","p-3","rounded-xl","flex","flex-col","gap-3","min-w-max","animate-in","fade-in","slide-in-from-right-2"],[1,"flex","gap-2"],["class","w-10 h-10 rounded-full border transition-all relative flex items-center justify-center group shadow-sm",3,"ring-2","ring-offset-1","ring-blue-500","opacity-50","background-color","border-color","title","click",4,"ngFor","ngForOf"],[1,"h-px","bg-gray-200","w-full"],["class","w-10 h-10 rounded-lg border transition-all relative flex items-center justify-center group shadow-sm bg-white hover:bg-gray-50",3,"ring-2","ring-offset-1","ring-blue-500","opacity-50","title","click",4,"ngFor","ngForOf"],[1,"w-10","h-10","rounded-full","border","transition-all","relative","flex","items-center","justify-center","group","shadow-sm",3,"click","title"],["class","w-4 h-4 text-gray-400","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],[1,"w-10","h-10","rounded-lg","border","transition-all","relative","flex","items-center","justify-center","group","shadow-sm","bg-white","hover:bg-gray-50",3,"click","title"],["class","text-lg",3,"font-family",4,"ngIf"],[1,"text-lg"]],template:function(t,r){if(t&1){let i=vt();O(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6),We(),O(4,"svg",7),Ce(5,"path",8)(6,"path",9,0),U(),Ke(8,L1,2,0,"div",10),U(),qt(),O(9,"h1",11),Ne(10,"Cross.plane"),U()(),O(11,"p",12),Ne(12," Infinite, procedural, collaborative crossword. "),Ce(13,"br"),Ne(14," Click to select. Space to rotate. Type to type. "),U(),O(15,"div",13)(16,"div",14),Ne(17," Words placed: "),O(18,"span",15),Ne(19),U()()(),O(20,"div",16),Ke(21,F1,6,0,"div",17)(22,V1,2,5,"div",18),U()()(),O(23,"div",19)(24,"div",20),Ke(25,B1,3,0,"button",21)(26,z1,24,6,"div",22),U(),Ke(27,K1,6,3,"button",23),O(28,"button",24),Te("click",function(){return J(i),X(r.resetView.emit())}),We(),O(29,"svg",25),Ce(30,"path",26),U()(),qt(),O(31,"button",27),Te("click",function(){return J(i),X(r.sharePosition.emit())}),We(),O(32,"svg",25),Ce(33,"path",28),U()(),qt(),O(34,"div",20)(35,"button",29),Te("click",function(){return J(i),X(r.toggleThemeMenu())}),We(),O(36,"svg",25),Ce(37,"path",30),U()(),Ke(38,eO,6,2,"div",31),U(),qt(),O(39,"button",32),Te("click",function(){return J(i),X(r.zoomIn.emit())}),We(),O(40,"svg",25),Ce(41,"path",33),U()(),qt(),O(42,"button",34),Te("click",function(){return J(i),X(r.zoomOut.emit())}),We(),O(43,"svg",25),Ce(44,"path",35),U()()()}t&2&&(fe(8),me("ngIf",r.cooldownProgress>=1),fe(11),jn(r.wordsPlacedCount),fe(2),me("ngIf",r.isValidating),fe(),me("ngIf",!r.isValidating&&r.validationMessage),fe(3),me("ngIf",!r.currentUser()),fe(),me("ngIf",r.isAuthMenuOpen&&!r.currentUser()),fe(),me("ngIf",r.currentUser()),fe(11),me("ngIf",r.isThemeMenuOpen))},dependencies:[Ai,Lc,Th],encapsulation:2})}};var ml=class n{constructor(){}async validateWord(e){try{if(await this.checkProfanity(e))return{valid:!1,definition:"",reason:`"${e.toUpperCase()}" not found in dictionary`};let r=await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${e.toLowerCase()}`);if(r.status===404)return{valid:!1,definition:"",reason:`"${e.toUpperCase()}" not found in dictionary`};if(!r.ok)throw new Error("Dictionary API error");let i=await r.json(),s="No definition found.";if(Array.isArray(i)&&i.length>0){let o=i[0];if(o.meanings&&o.meanings.length>0){let c=o.meanings[0];c.definitions&&c.definitions.length>0&&(s=c.definitions[0].definition)}}return{valid:!0,definition:s}}catch(t){return console.error("Dictionary validation error:",t),{valid:!1,definition:"",reason:"Validation service unavailable"}}}async checkProfanity(e){try{let t=await fetch(`https://www.purgomalum.com/service/containsprofanity?text=${encodeURIComponent(e.toLowerCase())}`);return t.ok?await t.text()==="true":(console.warn("Profanity check failed, allowing word through"),!1)}catch(t){return console.warn("Profanity API unavailable:",t),!1}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=pe({token:n,factory:n.\u0275fac,providedIn:"root"})}};var nO=["hiddenInput"],rO=["gridCanvas"],xC=[{id:"default",name:"Classic",unlockCount:0,buttonColor:"#ffffff",colors:{bg:"#ffffff",gridLines:"rgba(0,0,0,0.05)",blackSquare:"#000000",text:"#000000",confirmedBg:"#ffffff",confirmedText:"#000000",confirmedBorder:"#d1d5db",startWordBg:"#fef9c3",startWordBorder:"#fde047",pendingBg:"#93c5fd",pendingText:"#2563eb",pendingBorder:"#d1d5db",selectionBg:"#dbeafe",selectionBorder:"#3b82f6",selectionShadow:"rgba(59, 130, 246, 0.5)"}},{id:"dark",name:"Midnight",unlockCount:10,buttonColor:"#1f2937",colors:{bg:"#1f2937",gridLines:"rgba(255,255,255,0.1)",blackSquare:"#111827",text:"#f3f4f6",confirmedBg:"#1f2937",confirmedText:"#f3f4f6",confirmedBorder:"#374151",startWordBg:"#3f2c06",startWordBorder:"#ca8a04",pendingBg:"#1e3a8a",pendingText:"#60a5fa",pendingBorder:"#374151",selectionBg:"#1e40af",selectionBorder:"#3b82f6",selectionShadow:"rgba(59, 130, 246, 0.5)"}},{id:"blueprint",name:"Blueprint",unlockCount:20,buttonColor:"#3555a1",colors:{bg:"#3555a1",gridLines:"rgba(255,255,255,0.2)",blackSquare:"#25397bff",text:"#ffffff",confirmedBg:"#3555a1",confirmedText:"#ffffff",confirmedBorder:"#93c5fd",startWordBg:"rgba(147, 197, 253,0.2)",startWordBorder:"rgba(147, 197, 253,0.2)",pendingBg:"#2563eb",pendingText:"#ffffff",pendingBorder:"#ffffff",selectionBg:"rgba(255,255,255,0.1)",selectionBorder:"#ffffff",selectionShadow:"rgba(255, 255, 255, 0.5)"}},{id:"retro",name:"Terminal",unlockCount:60,buttonColor:"#00ff41",colors:{bg:"#0c0c0c",gridLines:"rgba(0, 255, 65, 0.1)",blackSquare:"#00ff41",text:"#00ff41",confirmedBg:"#0c0c0c",confirmedText:"#00ff41",confirmedBorder:"#003b00",startWordBg:"#001a00",startWordBorder:"#008f11",pendingBg:"#002200",pendingText:"#ccffcc",pendingBorder:"#00ff41",selectionBg:"rgba(0, 255, 65, 0.1)",selectionBorder:"#00ff41",selectionShadow:"rgba(0, 255, 65, 0.5)"}},{id:"coffee",name:"Latte",unlockCount:100,buttonColor:"#f5ebe0",colors:{bg:"#f5ebe0",gridLines:"rgba(214, 204, 194, 0.5)",blackSquare:"#4a3b32",text:"#3e2723",confirmedBg:"#f5ebe0",confirmedText:"#3e2723",confirmedBorder:"#d6ccc2",startWordBg:"#e6ccb2",startWordBorder:"#d5bdaf",pendingBg:"#e3d5ca",pendingText:"#3e2723",pendingBorder:"#b08968",selectionBg:"rgba(213, 189, 175, 0.4)",selectionBorder:"#7f5539",selectionShadow:"rgba(127, 85, 57, 0.3)"}}],PC=[{id:"classic",name:"Classic",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",unlockCount:0},{id:"hand",name:"Hand",fontFamily:'"Patrick Hand", cursive',unlockCount:20},{id:"robot",name:"Roboto",fontFamily:'"Roboto Mono", monospace',unlockCount:25},{id:"pixel",name:"Pixel",fontFamily:'"Pixelify Sans", monospace',unlockCount:40},{id:"gothic",name:"Gothic",fontFamily:'"UnifrakturMaguntia", cursive',unlockCount:100}],yl=class n{constructor(e,t){this.grid=e;this.dictionary=t;this.ngZone=te(ze);this.animationFrameId=null;this.needsRender=!0;this.isPanning=!1;this.startX=0;this.startY=0;this.startOffsetX=0;this.startOffsetY=0;this.zoomLevel=we(1);this.MIN_ZOOM=.03;this.MAX_ZOOM=2;this.isPinching=!1;this.initialPinchDist=0;this.startZoom=1;this.CELL_SIZE=40;this.COOLDOWN_MS=5e3;this.pendingWordCoords=we([]);this.isValidating=we(!1);this.validationMessage=we("");this.isError=we(!1);this.activeTheme=we(xC[0]);this.themes=xC;this.activeFont=we(PC[0]);this.fonts=PC;this.entryStart=we(null);this.offsetX=uo(()=>this.grid.viewportOffset().x);this.offsetY=uo(()=>this.grid.viewportOffset().y);this.showText=uo(()=>this.zoomLevel()>.35);zt(()=>{this.zoomLevel(),this.grid.viewportOffset(),this.grid.cells(),this.grid.selectedCell(),this.grid.inputDirection(),this.pendingWordCoords(),this.grid.inputDirection(),this.pendingWordCoords(),this.activeTheme(),this.activeFont(),this.requestRender()});let r=this.grid.getCookie("cross_plane_theme");if(r){let s=this.themes.find(o=>o.id===r);s&&this.activeTheme.set(s)}let i=this.grid.getCookie("cross_plane_font");if(i){let s=this.fonts.find(o=>o.id===i);s&&this.activeFont.set(s)}zt(()=>{let s=this.activeTheme();document.body.style.backgroundColor=s.colors.bg,this.grid.setCookie("cross_plane_theme",s.id,365)}),zt(()=>{let s=this.activeFont();this.grid.setCookie("cross_plane_font",s.id,365)})}ngOnInit(){let e=new URLSearchParams(window.location.search),t=e.get("x"),r=e.get("y");if(t&&r){let i=parseInt(t,10),s=parseInt(r,10);if(!isNaN(i)&&!isNaN(s)){let o=this.CELL_SIZE*this.zoomLevel();this.grid.viewportOffset.set({x:-i*o,y:-s*o})}}}ngAfterViewInit(){this.setupCanvas(),this.startRenderLoop(),window.addEventListener("resize",()=>this.resizeCanvas())}setupCanvas(){let e=this.gridCanvas.nativeElement;this.ctx=e.getContext("2d"),this.resizeCanvas()}resizeCanvas(){let e=this.gridCanvas.nativeElement,t=window.devicePixelRatio||1;e.width=window.innerWidth*t,e.height=window.innerHeight*t,e.style.width=window.innerWidth+"px",e.style.height=window.innerHeight+"px",this.ctx.scale(t,t),this.requestRender()}requestRender(){this.needsRender=!0}startRenderLoop(){this.ngZone.runOutsideAngular(()=>{let e=()=>{this.needsRender&&(this.renderCanvas(),this.needsRender=!1),this.animationFrameId=requestAnimationFrame(e)};e()})}renderCanvas(){let e=this.ctx,t=window.innerWidth,r=window.innerHeight,i=this.activeTheme().colors;e.clearRect(0,0,t,r),e.fillStyle=i.bg,e.fillRect(0,0,t,r);let s=this.zoomLevel(),o=this.grid.viewportOffset(),c=this.CELL_SIZE*s,u=t/2+o.x,l=r/2+o.y,h=Math.floor(-u/c)-1,p=Math.ceil((t-u)/c)+1,m=Math.floor(-l/c)-1,I=Math.ceil((r-l)/c)+1;e.strokeStyle=i.gridLines,e.lineWidth=1;for(let k=h;k<=p;k++){let E=u+k*c;e.beginPath(),e.moveTo(E,0),e.lineTo(E,r),e.stroke()}for(let k=m;k<=I;k++){let E=l+k*c;e.beginPath(),e.moveTo(0,E),e.lineTo(t,E),e.stroke()}e.fillStyle=i.blackSquare;for(let k=h;k<=p;k++)for(let E=m;E<=I;E++)if(this.grid.isBlackSquare(k,E)){let y=u+k*c,_=l+E*c;e.fillRect(y+.5,_+.5,c-1,c-1)}let S=this.showText(),M=this.grid.selectedCell(),R=Math.max(8,Math.floor(c*.55));e.font=`bold ${R}px ${this.activeFont().fontFamily}`,e.textAlign="center",e.textBaseline="middle";let F=p-h,Z=I-m,re=F*Z,K=this.grid.cells().size;if(re<K*2)for(let k=h;k<=p;k++)for(let E=m;E<=I;E++){let y=this.grid.getCell(k,E);y&&this.drawCell(e,y,u,l,c,i,S,M)}else this.grid.cells().forEach(k=>{k.x<h||k.x>p||k.y<m||k.y>I||this.drawCell(e,k,u,l,c,i,S,M)});if(this.pendingWordCoords().forEach(k=>{let E=u+k.x*c,y=l+k.y*c;if(!(E+c<0||E>t||y+c<0||y>r))if(S){let _=M&&M.x===k.x&&M.y===k.y;e.fillStyle=_?i.selectionBg:i.confirmedBg,e.fillRect(E+1,y+1,c-2,c-2),e.strokeStyle=i.pendingBorder,e.lineWidth=1,e.strokeRect(E+1,y+1,c-2,c-2),e.fillStyle=i.pendingText,e.fillText(k.char,E+c/2,y+c/2+1)}else e.fillStyle=i.pendingBg,e.fillRect(E+1,y+1,c-2,c-2)}),M&&S){let k=u+M.x*c-1,E=l+M.y*c-1;e.strokeStyle=i.selectionBorder,e.lineWidth=3,e.strokeRect(k,E,c+2,c+2),e.shadowColor=i.selectionShadow,e.shadowBlur=10,e.strokeRect(k,E,c+2,c+2),e.shadowBlur=0;let y=this.grid.inputDirection()==="across",_=Math.max(12,c*.35);if(e.fillStyle=i.selectionBorder,e.beginPath(),y){let T=k+c+8,w=E+c/2;e.moveTo(T,w-_/2),e.lineTo(T+_,w),e.lineTo(T,w+_/2)}else{let T=k+c/2,w=E+c+8;e.moveTo(T-_/2,w),e.lineTo(T,w+_),e.lineTo(T+_/2,w)}e.fill()}}onCanvasClick(e){if(this.isPanning)return;let t=this.screenToGrid(e.clientX,e.clientY);this.grid.isBlackSquare(t.x,t.y)||this.selectCell(t.x,t.y)}onCanvasTouch(e){if(e.touches.length>1)return;let t=e.touches[0],r=this.screenToGrid(t.clientX,t.clientY);this.grid.isBlackSquare(r.x,r.y)||setTimeout(()=>{!this.isPanning&&!this.isPinching&&this.selectCell(r.x,r.y)},100)}screenToGrid(e,t){let r=this.zoomLevel(),i=this.grid.viewportOffset(),s=this.CELL_SIZE*r,o=window.innerWidth/2+i.x,c=window.innerHeight/2+i.y,u=Math.floor((e-o)/s),l=Math.floor((t-c)/s);return{x:u,y:l}}setZoom(e,t,r){let i=this.zoomLevel(),s=this.grid.viewportOffset(),o=Math.min(Math.max(e,this.MIN_ZOOM),this.MAX_ZOOM);if(o===i)return;let c=window.innerWidth,u=window.innerHeight,l=t-c/2,h=r-u/2,p=o/i,m=l-(l-s.x)*p,I=h-(h-s.y)*p;this.grid.viewportOffset.set({x:m,y:I}),this.zoomLevel.set(o)}zoomIn(){this.setZoom(this.zoomLevel()*1.2,window.innerWidth/2,window.innerHeight/2)}zoomOut(){this.setZoom(this.zoomLevel()/1.2,window.innerWidth/2,window.innerHeight/2)}onWheel(e){e.preventDefault();let i=1+-e.deltaY*.001;i>1.15&&(i=1.15),i<.85&&(i=.85);let s=this.zoomLevel()*i;this.setZoom(s,e.clientX,e.clientY)}selectCell(e,t){let r=this.grid.selectedCell();if(r&&r.x===e&&r.y===t){this.grid.inputDirection.update(s=>s==="across"?"down":"across");return}this.pendingWordCoords().some(s=>s.x===e&&s.y===t)||this.clearPending(),this.grid.selectedCell.set({x:e,y:t}),this.entryStart.set({x:e,y:t}),this.validationMessage.set(""),this.focusInput()}focusInput(){this.hiddenInput?.nativeElement?.focus()}onInput(e){let t=e.target,i=t.value.slice(-1).toUpperCase();t.value="",i.match(/[A-Z]/)&&this.processCharInput(i)}onGlobalKeyDown(e){if(this.grid.selectedCell()){if(e.key==="ArrowLeft"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x-1,y:r.y}:null);return}if(e.key==="ArrowRight"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x+1,y:r.y}:null);return}if(e.key==="ArrowUp"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x,y:r.y-1}:null);return}if(e.key==="ArrowDown"){e.preventDefault(),this.grid.selectedCell.update(r=>r?{x:r.x,y:r.y+1}:null);return}if(e.key==="Enter"){e.preventDefault(),this.submitWord();return}if(e.key===" "){e.preventDefault(),this.grid.inputDirection.update(r=>r==="across"?"down":"across");return}if(e.key==="Backspace"){this.handleBackspace();return}if(e.key==="Escape"){this.clearPending();return}if(e.key.length===1&&e.key.match(/[a-zA-Z]/)){if(document.activeElement===this.hiddenInput?.nativeElement)return;e.preventDefault(),this.processCharInput(e.key.toUpperCase())}}}processCharInput(e){let t=this.grid.selectedCell();if(!t||this.grid.isBlackSquare(t.x,t.y))return;let r=this.grid.getCell(t.x,t.y);if(r&&r.confirmed){if(r.char===e)this.moveCursor(1);else{let i=t.x,s=t.y;this.moveCursor(1);let o=this.grid.selectedCell();if(o&&o.x===i&&o.y===s){this.showError("Cannot change existing letters!");return}this.processCharInput(e)}return}this.addPendingChar(t.x,t.y,e),this.moveCursor(1),this.focusInput()}handleBackspace(){let e=this.grid.selectedCell(),t=this.entryStart();if(!e||!t)return;if(this.pendingWordCoords().some(h=>h.x===e.x&&h.y===e.y)){this.removePendingAt(e.x,e.y);return}let i=this.grid.inputDirection()==="across",s=i?-1:0,o=i?0:-1,c=e.x+s,u=e.y+o;if(e.x===t.x&&e.y===t.y||this.grid.isBlackSquare(c,u))return;this.grid.selectedCell.set({x:c,y:u}),this.pendingWordCoords().some(h=>h.x===c&&h.y===u)&&this.removePendingAt(c,u)}moveCursor(e){let t=this.grid.selectedCell();if(!t)return;let r=this.grid.inputDirection()==="across"?e:0,i=this.grid.inputDirection()==="down"?e:0,s=t.x+r,o=t.y+i;this.grid.isBlackSquare(s,o)||this.grid.selectedCell.set({x:s,y:o})}addPendingChar(e,t,r){this.pendingWordCoords.update(i=>[...i.filter(o=>!(o.x===e&&o.y===t)),{x:e,y:t,char:r}]),this.validationMessage.set("")}removePendingAt(e,t){this.pendingWordCoords.update(r=>r.filter(i=>!(i.x===e&&i.y===t)))}async submitWord(){if(this.pendingWordCoords().length===0)return;this.isValidating.set(!0),this.validationMessage.set(""),this.isError.set(!1);let t=this.grid.inputDirection()==="across",r=[...this.pendingWordCoords()].sort((K,ae)=>t?K.x-ae.x:K.y-ae.y),i=r[0],s=r[r.length-1],o=i.x,c=i.y;for(;!this.grid.isBlackSquare(t?o-1:o,t?c:c-1);){let K=t?o-1:o,ae=t?c:c-1,k=this.grid.getCell(K,ae),E=this.pendingWordCoords().find(y=>y.x===K&&y.y===ae);if(k||E)o=K,c=ae;else break}let u=o,l=c;for(o=s.x,c=s.y;!this.grid.isBlackSquare(t?o+1:o,t?c:c+1);){let K=t?o+1:o,ae=t?c:c+1,k=this.grid.getCell(K,ae),E=this.pendingWordCoords().find(y=>y.x===K&&y.y===ae);if(k||E)o=K,c=ae;else break}let h=o,p=c,m="",I=!1,S=!1,M=t?h-u+1:p-l+1;for(let K=0;K<M;K++){let ae=t?u+K:u,k=t?l:l+K,E=this.grid.getCell(ae,k),y=this.pendingWordCoords().find(_=>_.x===ae&&_.y===k);if(E&&E.confirmed)m+=E.char,I=!0;else if(y)m+=y.char,S=!0;else{this.showError("Word has gaps!"),this.isValidating.set(!1);return}}if(!S){this.showError("No new letters added."),this.isValidating.set(!1);return}if(!I&&this.grid.cells().size>0){this.showError("Must connect to existing words!"),this.isValidating.set(!1);return}if(m.length<2){this.showError("Word too short."),this.isValidating.set(!1);return}let R=Date.now(),F=this.grid.lastPlacedTime(),Z=R-F;if(Z<this.COOLDOWN_MS){let K=Math.ceil((this.COOLDOWN_MS-Z)/1e3);this.showError(`Wait ${K}s to place next word.`),this.isValidating.set(!1);return}let re=await this.dictionary.validateWord(m);if(re.valid){for(let K=0;K<M;K++){let ae=t?u+K:u,k=t?l:l+K,E=m[K];this.grid.getCell(ae,k)||this.grid.setCell(ae,k,E,!0)}this.grid.lastPlacedTime.set(Date.now()),this.grid.incrementWordsPlaced(),this.pendingWordCoords.set([]),this.validationMessage.set(`Placed: "${m}"
${re.definition}`),this.isError.set(!1)}else this.showError(re.reason||`"${m}" not found.`);this.isValidating.set(!1)}clearPending(){this.pendingWordCoords.set([]),this.validationMessage.set(""),this.hiddenInput?.nativeElement&&(this.hiddenInput.nativeElement.value="");let e=this.grid.selectedCell();e&&this.entryStart.set(e)}showError(e){this.validationMessage.set(e),this.isError.set(!0)}startPan(e){e.button===0&&(this.isPanning=!0,this.startX=e.clientX,this.startY=e.clientY,this.startOffsetX=this.grid.viewportOffset().x,this.startOffsetY=this.grid.viewportOffset().y)}startPanTouch(e){if(e.touches.length===2){this.isPinching=!0,this.isPanning=!1,this.initialPinchDist=this.getDist(e.touches),this.startZoom=this.zoomLevel();return}e.touches.length===1&&(this.isPanning=!0,this.isPinching=!1,this.startX=e.touches[0].clientX,this.startY=e.touches[0].clientY,this.startOffsetX=this.grid.viewportOffset().x,this.startOffsetY=this.grid.viewportOffset().y)}pan(e){if(!this.isPanning)return;let t=e.clientX-this.startX,r=e.clientY-this.startY;this.grid.viewportOffset.set({x:this.startOffsetX+t,y:this.startOffsetY+r})}panTouch(e){if(this.isPinching&&e.touches.length===2){let r=this.getDist(e.touches)/this.initialPinchDist,i=(e.touches[0].clientX+e.touches[1].clientX)/2,s=(e.touches[0].clientY+e.touches[1].clientY)/2,o=this.startZoom*r;this.setZoom(o,i,s),e.preventDefault();return}if(this.isPanning&&e.touches.length===1){let t=e.touches[0].clientX-this.startX,r=e.touches[0].clientY-this.startY;this.grid.viewportOffset.set({x:this.startOffsetX+t,y:this.startOffsetY+r}),e.cancelable&&e.preventDefault()}}endPan(){this.isPanning=!1,this.isPinching=!1}getDist(e){let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)}resetView(){this.grid.viewportOffset.set({x:0,y:0}),this.zoomLevel.set(1)}sharePosition(){let e=this.screenToGrid(window.innerWidth/2,window.innerHeight/2),t=new URL(window.location.href);t.searchParams.set("x",e.x.toString()),t.searchParams.set("y",e.y.toString()),navigator.clipboard.writeText(t.toString()).then(()=>{this.validationMessage.set("Link copied to clipboard!"),this.isError.set(!1),setTimeout(()=>{this.validationMessage()==="Link copied to clipboard!"&&this.validationMessage.set("")},3e3)})}isCellSelected(e,t){let r=this.grid.selectedCell();return!!r&&r.x===e&&r.y===t}drawCell(e,t,r,i,s,o,c,u){let l=r+t.x*s,h=i+t.y*s,p=e.canvas.width/window.devicePixelRatio,m=e.canvas.height/window.devicePixelRatio;if(!(l+s<0||l>p||h+s<0||h>m))if(c){let I=u&&u.x===t.x&&u.y===t.y,S=t.y===0&&Math.abs(t.x)<=5&&t.x!==0;I?e.fillStyle=o.selectionBg:S?e.fillStyle=o.startWordBg:e.fillStyle=o.confirmedBg,e.fillRect(l+1,h+1,s-2,s-2),S&&!I?e.strokeStyle=o.startWordBorder:e.strokeStyle=o.confirmedBorder,e.lineWidth=1,e.strokeRect(l+1,h+1,s-2,s-2),e.fillStyle=o.confirmedText,e.fillText(t.char,l+s/2,h+s/2+1)}else e.fillStyle=o.confirmedBorder,e.fillRect(l+1,h+1,s-2,s-2)}static{this.\u0275fac=function(t){return new(t||n)(Rt(us),Rt(ml))}}static{this.\u0275cmp=so({type:n,selectors:[["app-root"]],viewQuery:function(t,r){if(t&1&&Di(nO,5)(rO,5),t&2){let i;Ci(i=bi())&&(r.hiddenInput=i.first),Ci(i=bi())&&(r.gridCanvas=i.first)}},decls:6,vars:10,consts:[["gridCanvas",""],["hiddenInput",""],[1,"relative","w-full","h-full","overflow-hidden","bg-white","select-none","cursor-grab","active:cursor-grabbing","font-mono",3,"mousedown","touchstart","mousemove","touchmove","mouseup","touchend","keydown","wheel"],[1,"absolute","inset-0","w-full","h-full",3,"click","touchstart"],[3,"themeSelected","fontSelected","zoomIn","zoomOut","resetView","sharePosition","lastPlacedTime","cooldownMs","wordsPlacedCount","isValidating","validationMessage","isError","activeTheme","themes","activeFont","fonts"],["type","text","inputmode","text","autocomplete","off","autocorrect","off","autocapitalize","characters",1,"absolute","opacity-0","top-0","left-0","w-px","h-px","overflow-hidden","-z-10",3,"input"]],template:function(t,r){if(t&1){let i=vt();O(0,"div",2),Te("mousedown",function(o){return J(i),X(r.startPan(o))})("touchstart",function(o){return J(i),X(r.startPanTouch(o))})("mousemove",function(o){return J(i),X(r.pan(o))},Rr)("touchmove",function(o){return J(i),X(r.panTouch(o))},Rr)("mouseup",function(){return J(i),X(r.endPan())},Rr)("touchend",function(){return J(i),X(r.endPan())},Rr)("keydown",function(o){return J(i),X(r.onGlobalKeyDown(o))},Rr)("wheel",function(o){return J(i),X(r.onWheel(o))}),O(1,"canvas",3,0),Te("click",function(o){return J(i),X(r.onCanvasClick(o))})("touchstart",function(o){return J(i),X(r.onCanvasTouch(o))}),U(),O(3,"app-top-bar",4),Te("themeSelected",function(o){return J(i),X(r.activeTheme.set(o))})("fontSelected",function(o){return J(i),X(r.activeFont.set(o))})("zoomIn",function(){return J(i),X(r.zoomIn())})("zoomOut",function(){return J(i),X(r.zoomOut())})("resetView",function(){return J(i),X(r.resetView())})("sharePosition",function(){return J(i),X(r.sharePosition())}),U(),O(4,"input",5,1),Te("input",function(o){return J(i),X(r.onInput(o))}),U()()}t&2&&(fe(3),me("lastPlacedTime",r.grid.lastPlacedTime())("cooldownMs",r.COOLDOWN_MS)("wordsPlacedCount",r.grid.wordsPlacedCount())("isValidating",r.isValidating())("validationMessage",r.validationMessage())("isError",r.isError())("activeTheme",r.activeTheme())("themes",r.themes)("activeFont",r.activeFont())("fonts",r.fonts))},dependencies:[Ai,gl],encapsulation:2})}};xh(yl,{providers:[ph()]}).catch(n=>console.error(n));
